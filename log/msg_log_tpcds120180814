2018-08-14 11:49:02: Connected to database [gabsam] with user [tpcds1]
2018-08-14 11:49:02: Connection pool instantiated with [1] connections
2018-08-14 11:49:06: ('spark.cores.max', '20')
2018-08-14 11:49:06: ('spark.executor.memory', '2g')
2018-08-14 11:49:06: ('spark.app.id', 'app-20180814114905-0041')
2018-08-14 11:49:06: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 11:49:06: ('spark.executor.id', 'driver')
2018-08-14 11:49:06: ('spark.python.worker.reuse', 'True')
2018-08-14 11:49:06: ('spark.driver.maxResultSize', '1g')
2018-08-14 11:49:06: ('spark.default.parallelism', '80')
2018-08-14 11:49:06: ('spark.sql.shuffle.partitions', '80')
2018-08-14 11:49:06: ('spark.executor.instances', '20')
2018-08-14 11:49:06: ('spark.logConf', 'False')
2018-08-14 11:49:06: ('spark.rdd.compress', 'True')
2018-08-14 11:49:06: ('spark.driver.memory', '2g')
2018-08-14 11:49:06: ('spark.serializer.objectStreamReset', '100')
2018-08-14 11:49:06: ('spark.executor.cores', '1')
2018-08-14 11:49:06: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 11:49:06: ('spark.submit.deployMode', 'client')
2018-08-14 11:49:06: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 11:49:06: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 11:49:06: ('spark.driver.port', '24846')
2018-08-14 11:49:06: ('spark.app.name', 'ICS5200')
2018-08-14 11:49:06: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 11:49:06: Starting optimizer stats dropping..
2018-08-14 11:52:22: Schema [tpcds1] stripped of optimizer stats..
2018-08-14 11:52:22: Generating execution metrics for [query_1.sql]..
2018-08-14 11:52:24: Generating execution metrics for [query_2.sql]..
2018-08-14 11:52:24: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 11:52:24: Generating execution metrics for [query_3.sql]..
2018-08-14 11:52:26: Generating execution metrics for [query_4.sql]..
2018-08-14 11:52:34: Generating execution metrics for [query_5.sql]..
2018-08-14 11:52:34: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk ,'yyyy-mm-dd'_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, to_date(0 as decimal(7,2)) as return_amt, to_date(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk ,'yyyy-mm-dd'_sk, to_date(0 as decimal(7,2)) as sales_price, to_date(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_date('2000-08-19' ,'yyyy-mm-dd') and (to_date('2000-08-19' ,'yyyy-mm-dd') + 14) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk ,'yyyy-mm-dd'_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, to_date(0 as decimal(7,2)) as return_amt, to_date(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk ,'yyyy-mm-dd'_sk, to_date(0 as decimal(7,2)) as sales_price, to_date(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_date('2000-08-19' ,'yyyy-mm-dd') and (to_date('2000-08-19' ,'yyyy-mm-dd') + 14) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk ,'yyyy-mm-dd'_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, to_date(0 as decimal(7,2)) as return_amt, to_date(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk ,'yyyy-mm-dd'_sk, to_date(0 as decimal(7,2)) as sales_price, to_date(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_date('2000-08-19' ,'yyyy-mm-dd') and (to_date('2000-08-19' ,'yyyy-mm-dd') + 14) and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 11:52:34: Generating execution metrics for [query_6.sql]..
2018-08-14 11:52:34: Generating execution metrics for [query_7.sql]..
2018-08-14 11:52:35: Generating execution metrics for [query_8.sql]..
2018-08-14 11:52:36: Generating execution metrics for [query_9.sql]..
2018-08-14 11:52:38: Generating execution metrics for [query_10.sql]..
2018-08-14 11:52:41: Generating execution metrics for [query_11.sql]..
2018-08-14 11:52:43: Generating execution metrics for [query_12.sql]..
2018-08-14 11:52:43: Generating execution metrics for [query_13.sql]..
2018-08-14 11:52:47: Generating execution metrics for [query_14.sql]..
2018-08-14 11:52:50: Generating execution metrics for [query_15.sql]..
2018-08-14 11:52:50: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 11:52:50: Generating execution metrics for [query_16.sql]..
2018-08-14 11:52:51: Generating execution metrics for [query_17.sql]..
2018-08-14 11:52:51: Generating execution metrics for [query_18.sql]..
2018-08-14 11:52:59: Generating execution metrics for [query_19.sql]..
2018-08-14 11:53:00: Generating execution metrics for [query_20.sql]..
2018-08-14 11:53:00: Generating execution metrics for [query_21.sql]..
2018-08-14 11:53:00: Skipped DML instruction due to following exception: [ORA-01861: literal does not match format string] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between to_date('2002-06-18' ,'yyyy-mm-dd') and (to_date('2002-06-18' ,'yyyy-mm-dd') + 30) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 11:53:01: Generating execution metrics for [query_22.sql]..
2018-08-14 11:53:01: Skipped DML instruction due to following exception: [ORA-01861: literal does not match format string] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_date(d_date ,'yyyy-mm-dd') < to_date ('1999-06-22' ,'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_date(d_date ,'yyyy-mm-dd') >= to_date ('1999-06-22' ,'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_date ('1999-06-22' ,'yyyy-mm-dd') - 30) and (to_date ('1999-06-22' ,'yyyy-mm-dd') + 30) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 11:53:01: Generating execution metrics for [query_23.sql]..
2018-08-14 11:53:07: Generating execution metrics for [query_24.sql]..
2018-08-14 11:53:13: Generating execution metrics for [query_25.sql]..
2018-08-14 11:53:20: Generating execution metrics for [query_26.sql]..
2018-08-14 11:53:20: Generating execution metrics for [query_27.sql]..
2018-08-14 11:53:20: Generating execution metrics for [query_28.sql]..
2018-08-14 11:53:21: Generating execution metrics for [query_29.sql]..
2018-08-14 11:53:21: Generating execution metrics for [query_30.sql]..
2018-08-14 11:53:21: Generating execution metrics for [query_31.sql]..
2018-08-14 11:53:23: Generating execution metrics for [query_32.sql]..
2018-08-14 11:53:24: Generating execution metrics for [query_33.sql]..
2018-08-14 11:53:24: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 11:53:24: Generating execution metrics for [query_34.sql]..
2018-08-14 11:53:25: Generating execution metrics for [query_35.sql]..
2018-08-14 11:53:25: Skipped DML instruction due to following exception: [ORA-01861: literal does not match format string] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (to_date('2001-03-09' ,'yyyy-mm-dd') + 90) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (to_date('2001-03-09' ,'yyyy-mm-dd') + 90) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 11:53:25: Generating execution metrics for [query_36.sql]..
2018-08-14 11:53:25: Generating execution metrics for [query_37.sql]..
2018-08-14 11:53:26: Generating execution metrics for [query_38.sql]..
2018-08-14 11:54:10: Generating execution metrics for [query_39.sql]..
2018-08-14 11:54:11: Generating execution metrics for [query_40.sql]..
2018-08-14 11:54:11: Generating execution metrics for [query_41.sql]..
2018-08-14 11:54:12: Generating execution metrics for [query_42.sql]..
2018-08-14 11:54:15: Generating execution metrics for [query_43.sql]..
2018-08-14 11:54:18: Generating execution metrics for [query_44.sql]..
2018-08-14 11:54:18: Skipped DML instruction due to following exception: [ORA-01861: literal does not match format string] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (to_date(d_date ,'yyyy-mm-dd') < to_date ('2001-05-02' ,'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (to_date(d_date ,'yyyy-mm-dd') >= to_date ('2001-05-02' ,'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (to_date ('2001-05-02' ,'yyyy-mm-dd') - 30) and (to_date ('2001-05-02' ,'yyyy-mm-dd') + 30) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 11:54:18: Generating execution metrics for [query_45.sql]..
2018-08-14 11:54:19: Generating execution metrics for [query_46.sql]..
2018-08-14 11:54:19: Generating execution metrics for [query_47.sql]..
2018-08-14 11:54:19: Generating execution metrics for [query_48.sql]..
2018-08-14 11:54:20: Generating execution metrics for [query_49.sql]..
2018-08-14 11:54:21: Generating execution metrics for [query_50.sql]..
2018-08-14 11:54:22: Generating execution metrics for [query_51.sql]..
2018-08-14 11:54:24: Generating execution metrics for [query_52.sql]..
2018-08-14 12:07:40: Connected to database [gabsam] with user [tpcds1]
2018-08-14 12:07:40: Connection pool instantiated with [1] connections
2018-08-14 12:08:00: Connected to database [gabsam] with user [tpcds1]
2018-08-14 12:08:00: Connection pool instantiated with [1] connections
2018-08-14 12:08:03: ('spark.cores.max', '20')
2018-08-14 12:08:03: ('spark.executor.memory', '2g')
2018-08-14 12:08:03: ('spark.executor.id', 'driver')
2018-08-14 12:08:03: ('spark.python.worker.reuse', 'True')
2018-08-14 12:08:03: ('spark.driver.maxResultSize', '1g')
2018-08-14 12:08:03: ('spark.default.parallelism', '80')
2018-08-14 12:08:03: ('spark.sql.shuffle.partitions', '80')
2018-08-14 12:08:03: ('spark.executor.instances', '20')
2018-08-14 12:08:03: ('spark.logConf', 'False')
2018-08-14 12:08:03: ('spark.driver.port', '26908')
2018-08-14 12:08:03: ('spark.rdd.compress', 'True')
2018-08-14 12:08:03: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 12:08:03: ('spark.driver.memory', '2g')
2018-08-14 12:08:03: ('spark.serializer.objectStreamReset', '100')
2018-08-14 12:08:03: ('spark.app.id', 'app-20180814120803-0042')
2018-08-14 12:08:03: ('spark.executor.cores', '1')
2018-08-14 12:08:03: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 12:08:03: ('spark.submit.deployMode', 'client')
2018-08-14 12:08:03: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 12:08:03: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 12:08:03: ('spark.app.name', 'ICS5200')
2018-08-14 12:08:03: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 12:08:03: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 12:08:03: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 12:08:03: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 12:08:03: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 12:08:04: Successfully finished migrating DML scripts!
2018-08-14 12:08:04: Starting TPC-DS sql splitting
2018-08-14 12:08:04: Generated query_1.sql
2018-08-14 12:08:04: Generated query_2.sql
2018-08-14 12:08:04: Generated query_3.sql
2018-08-14 12:08:04: Generated query_4.sql
2018-08-14 12:08:04: Generated query_5.sql
2018-08-14 12:08:04: Generated query_6.sql
2018-08-14 12:08:04: Generated query_7.sql
2018-08-14 12:08:04: Generated query_8.sql
2018-08-14 12:08:04: Generated query_9.sql
2018-08-14 12:08:04: Generated query_10.sql
2018-08-14 12:08:04: Generated query_11.sql
2018-08-14 12:08:04: Generated query_12.sql
2018-08-14 12:08:04: Generated query_13.sql
2018-08-14 12:08:04: Generated query_14.sql
2018-08-14 12:08:04: Generated query_15.sql
2018-08-14 12:08:04: Generated query_16.sql
2018-08-14 12:08:04: Generated query_17.sql
2018-08-14 12:08:04: Generated query_18.sql
2018-08-14 12:08:04: Generated query_19.sql
2018-08-14 12:08:04: Generated query_20.sql
2018-08-14 12:08:04: Generated query_21.sql
2018-08-14 12:08:04: Generated query_22.sql
2018-08-14 12:08:04: Generated query_23.sql
2018-08-14 12:08:04: Generated query_24.sql
2018-08-14 12:08:04: Generated query_25.sql
2018-08-14 12:08:04: Generated query_26.sql
2018-08-14 12:08:04: Generated query_27.sql
2018-08-14 12:08:04: Generated query_28.sql
2018-08-14 12:08:04: Generated query_29.sql
2018-08-14 12:08:04: Generated query_30.sql
2018-08-14 12:08:04: Generated query_31.sql
2018-08-14 12:08:04: Generated query_32.sql
2018-08-14 12:08:04: Generated query_33.sql
2018-08-14 12:08:04: Generated query_34.sql
2018-08-14 12:08:04: Generated query_35.sql
2018-08-14 12:08:04: Generated query_36.sql
2018-08-14 12:08:04: Generated query_37.sql
2018-08-14 12:08:04: Generated query_38.sql
2018-08-14 12:08:04: Generated query_39.sql
2018-08-14 12:08:04: Generated query_40.sql
2018-08-14 12:08:04: Generated query_41.sql
2018-08-14 12:08:04: Generated query_42.sql
2018-08-14 12:08:04: Generated query_43.sql
2018-08-14 12:08:04: Generated query_44.sql
2018-08-14 12:08:04: Generated query_45.sql
2018-08-14 12:08:04: Generated query_46.sql
2018-08-14 12:08:04: Generated query_47.sql
2018-08-14 12:08:04: Generated query_48.sql
2018-08-14 12:08:04: Generated query_49.sql
2018-08-14 12:08:04: Generated query_50.sql
2018-08-14 12:08:04: Generated query_51.sql
2018-08-14 12:08:04: Generated query_52.sql
2018-08-14 12:08:04: Generated query_53.sql
2018-08-14 12:08:04: Generated query_54.sql
2018-08-14 12:08:04: Generated query_55.sql
2018-08-14 12:08:04: Generated query_56.sql
2018-08-14 12:08:04: Generated query_57.sql
2018-08-14 12:08:04: Generated query_58.sql
2018-08-14 12:08:04: Generated query_59.sql
2018-08-14 12:08:04: Generated query_60.sql
2018-08-14 12:08:04: Generated query_61.sql
2018-08-14 12:08:04: Generated query_62.sql
2018-08-14 12:08:04: Generated query_63.sql
2018-08-14 12:08:04: Generated query_64.sql
2018-08-14 12:08:04: Generated query_65.sql
2018-08-14 12:08:04: Generated query_66.sql
2018-08-14 12:08:04: Generated query_67.sql
2018-08-14 12:08:04: Generated query_68.sql
2018-08-14 12:08:04: Generated query_69.sql
2018-08-14 12:08:04: Generated query_70.sql
2018-08-14 12:08:04: Generated query_71.sql
2018-08-14 12:08:04: Generated query_72.sql
2018-08-14 12:08:04: Generated query_73.sql
2018-08-14 12:08:04: Generated query_74.sql
2018-08-14 12:08:04: Generated query_75.sql
2018-08-14 12:08:04: Generated query_76.sql
2018-08-14 12:08:04: Generated query_77.sql
2018-08-14 12:08:04: Generated query_78.sql
2018-08-14 12:08:04: Generated query_79.sql
2018-08-14 12:08:04: Generated query_80.sql
2018-08-14 12:08:04: Generated query_81.sql
2018-08-14 12:08:04: Generated query_82.sql
2018-08-14 12:08:04: Generated query_83.sql
2018-08-14 12:08:04: Generated query_84.sql
2018-08-14 12:08:04: Generated query_85.sql
2018-08-14 12:08:04: Generated query_86.sql
2018-08-14 12:08:04: Generated query_87.sql
2018-08-14 12:08:04: Generated query_88.sql
2018-08-14 12:08:04: Generated query_89.sql
2018-08-14 12:08:04: Generated query_90.sql
2018-08-14 12:08:04: Generated query_91.sql
2018-08-14 12:08:04: Generated query_92.sql
2018-08-14 12:08:04: Generated query_93.sql
2018-08-14 12:08:04: Generated query_94.sql
2018-08-14 12:08:04: Generated query_95.sql
2018-08-14 12:08:04: Generated query_96.sql
2018-08-14 12:08:04: Generated query_97.sql
2018-08-14 12:08:04: Generated query_98.sql
2018-08-14 12:08:04: Generated query_99.sql
2018-08-14 12:08:04: Generated query_100.sql
2018-08-14 12:08:04: Generated query_101.sql
2018-08-14 12:08:04: Generated query_102.sql
2018-08-14 12:08:04: Generated query_103.sql
2018-08-14 12:08:04: Generated query_104.sql
2018-08-14 12:08:04: Script Complete!
-------------------------------------
2018-08-14 12:10:07: Connected to database [gabsam] with user [tpcds1]
2018-08-14 12:10:07: Connection pool instantiated with [1] connections
2018-08-14 12:10:10: ('spark.cores.max', '20')
2018-08-14 12:10:10: ('spark.executor.memory', '2g')
2018-08-14 12:10:10: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 12:10:10: ('spark.app.id', 'app-20180814121009-0045')
2018-08-14 12:10:10: ('spark.executor.id', 'driver')
2018-08-14 12:10:10: ('spark.driver.port', '27043')
2018-08-14 12:10:10: ('spark.python.worker.reuse', 'True')
2018-08-14 12:10:10: ('spark.driver.maxResultSize', '1g')
2018-08-14 12:10:10: ('spark.default.parallelism', '80')
2018-08-14 12:10:10: ('spark.sql.shuffle.partitions', '80')
2018-08-14 12:10:10: ('spark.executor.instances', '20')
2018-08-14 12:10:10: ('spark.logConf', 'False')
2018-08-14 12:10:10: ('spark.rdd.compress', 'True')
2018-08-14 12:10:10: ('spark.driver.memory', '2g')
2018-08-14 12:10:10: ('spark.serializer.objectStreamReset', '100')
2018-08-14 12:10:10: ('spark.executor.cores', '1')
2018-08-14 12:10:10: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 12:10:10: ('spark.submit.deployMode', 'client')
2018-08-14 12:10:10: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 12:10:10: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 12:10:10: ('spark.app.name', 'ICS5200')
2018-08-14 12:10:10: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 12:10:10: Starting optimizer stats dropping..
2018-08-14 12:14:24: Schema [tpcds1] stripped of optimizer stats..
2018-08-14 12:14:24: Generating execution metrics for [query_1.sql]..
2018-08-14 12:14:25: Generating execution metrics for [query_2.sql]..
2018-08-14 12:14:25: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 12:14:25: Generating execution metrics for [query_3.sql]..
2018-08-14 12:14:25: Generating execution metrics for [query_4.sql]..
2018-08-14 12:14:33: Generating execution metrics for [query_5.sql]..
2018-08-14 12:14:33: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_date2000-08-19' ,'yyyy-mm-dd') and (to_date2000-08-19' ,'yyyy-mm-dd') + 14) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_date2000-08-19' ,'yyyy-mm-dd') and (to_date2000-08-19' ,'yyyy-mm-dd') + 14) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_date2000-08-19' ,'yyyy-mm-dd') and (to_date2000-08-19' ,'yyyy-mm-dd') + 14) and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 12:14:33: Generating execution metrics for [query_6.sql]..
2018-08-14 12:14:33: Generating execution metrics for [query_7.sql]..
2018-08-14 12:14:33: Generating execution metrics for [query_8.sql]..
2018-08-14 12:14:34: Generating execution metrics for [query_9.sql]..
2018-08-14 12:14:38: Generating execution metrics for [query_10.sql]..
2018-08-14 12:14:41: Generating execution metrics for [query_11.sql]..
2018-08-14 12:14:44: Generating execution metrics for [query_12.sql]..
2018-08-14 12:14:44: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between to_date2001-06-15' ,'yyyy-mm-dd') and (to_date2001-06-15' ,'yyyy-mm-dd') + 30) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 12:14:44: Generating execution metrics for [query_13.sql]..
2018-08-14 12:14:49: Generating execution metrics for [query_14.sql]..
2018-08-14 12:14:54: Generating execution metrics for [query_15.sql]..
2018-08-14 12:14:54: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 12:14:55: Generating execution metrics for [query_16.sql]..
2018-08-14 12:14:55: Generating execution metrics for [query_17.sql]..
2018-08-14 12:14:55: Skipped DML instruction due to following exception: [ORA-01756: quoted string not properly terminated] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (to_date2002-4-01' ,'yyyy-mm-dd') + 60) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 12:14:55: Generating execution metrics for [query_18.sql]..
2018-08-14 12:14:56: Generating execution metrics for [query_19.sql]..
2018-08-14 12:14:56: Generating execution metrics for [query_20.sql]..
2018-08-14 12:14:57: Generating execution metrics for [query_21.sql]..
2018-08-14 12:14:57: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between to_date2002-06-18' ,'yyyy-mm-dd') and (to_date2002-06-18' ,'yyyy-mm-dd') + 30) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 12:14:57: Generating execution metrics for [query_22.sql]..
2018-08-14 12:14:57: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 12:14:57: Generating execution metrics for [query_23.sql]..
2018-08-14 12:15:05: Generating execution metrics for [query_24.sql]..
2018-08-14 12:15:13: Generating execution metrics for [query_25.sql]..
2018-08-14 12:15:19: Generating execution metrics for [query_26.sql]..
2018-08-14 12:15:20: Generating execution metrics for [query_27.sql]..
2018-08-14 12:15:20: Generating execution metrics for [query_28.sql]..
2018-08-14 12:15:21: Generating execution metrics for [query_29.sql]..
2018-08-14 12:15:21: Generating execution metrics for [query_30.sql]..
2018-08-14 12:15:22: Generating execution metrics for [query_31.sql]..
2018-08-14 12:15:24: Generating execution metrics for [query_32.sql]..
2018-08-14 12:15:24: Generating execution metrics for [query_33.sql]..
2018-08-14 12:15:24: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 12:15:24: Generating execution metrics for [query_34.sql]..
2018-08-14 12:15:26: Generating execution metrics for [query_35.sql]..
2018-08-14 12:15:26: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (to_date2001-03-09' ,'yyyy-mm-dd') + 90) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (to_date2001-03-09' ,'yyyy-mm-dd') + 90) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 12:15:27: Generating execution metrics for [query_36.sql]..
2018-08-14 12:15:27: Generating execution metrics for [query_37.sql]..
2018-08-14 12:15:27: Generating execution metrics for [query_38.sql]..
2018-08-14 12:16:27: Generating execution metrics for [query_39.sql]..
2018-08-14 12:16:28: Generating execution metrics for [query_40.sql]..
2018-08-14 12:16:28: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between to_date2002-03-29' ,'yyyy-mm-dd') and (to_date2002-03-29' ,'yyyy-mm-dd') + 60) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 12:16:28: Generating execution metrics for [query_41.sql]..
2018-08-14 12:16:29: Generating execution metrics for [query_42.sql]..
2018-08-14 12:16:34: Generating execution metrics for [query_43.sql]..
2018-08-14 12:16:39: Generating execution metrics for [query_44.sql]..
2018-08-14 12:16:39: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 12:16:39: Generating execution metrics for [query_45.sql]..
2018-08-14 12:16:39: Generating execution metrics for [query_46.sql]..
2018-08-14 12:16:40: Generating execution metrics for [query_47.sql]..
2018-08-14 12:16:41: Generating execution metrics for [query_48.sql]..
2018-08-14 12:16:42: Generating execution metrics for [query_49.sql]..
2018-08-14 12:16:42: Generating execution metrics for [query_50.sql]..
2018-08-14 12:16:45: Generating execution metrics for [query_51.sql]..
2018-08-14 12:16:48: Generating execution metrics for [query_52.sql]..
2018-08-14 12:20:45: Connected to database [gabsam] with user [tpcds1]
2018-08-14 12:20:45: Connection pool instantiated with [1] connections
2018-08-14 12:20:48: ('spark.cores.max', '20')
2018-08-14 12:20:48: ('spark.driver.port', '17978')
2018-08-14 12:20:48: ('spark.executor.memory', '2g')
2018-08-14 12:20:48: ('spark.app.id', 'app-20180814122047-0046')
2018-08-14 12:20:48: ('spark.executor.id', 'driver')
2018-08-14 12:20:48: ('spark.python.worker.reuse', 'True')
2018-08-14 12:20:48: ('spark.driver.maxResultSize', '1g')
2018-08-14 12:20:48: ('spark.default.parallelism', '80')
2018-08-14 12:20:48: ('spark.sql.shuffle.partitions', '80')
2018-08-14 12:20:48: ('spark.executor.instances', '20')
2018-08-14 12:20:48: ('spark.logConf', 'False')
2018-08-14 12:20:48: ('spark.rdd.compress', 'True')
2018-08-14 12:20:48: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 12:20:48: ('spark.driver.memory', '2g')
2018-08-14 12:20:48: ('spark.serializer.objectStreamReset', '100')
2018-08-14 12:20:48: ('spark.executor.cores', '1')
2018-08-14 12:20:48: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 12:20:48: ('spark.submit.deployMode', 'client')
2018-08-14 12:20:48: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 12:20:48: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 12:20:48: ('spark.app.name', 'ICS5200')
2018-08-14 12:20:48: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 12:20:48: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 12:20:48: Successfully finished migrating DML scripts!
2018-08-14 12:20:48: Starting TPC-DS sql splitting
2018-08-14 12:20:48: Generated query_1.sql
2018-08-14 12:20:48: Generated query_2.sql
2018-08-14 12:20:48: Generated query_3.sql
2018-08-14 12:20:48: Generated query_4.sql
2018-08-14 12:20:48: Generated query_5.sql
2018-08-14 12:20:48: Generated query_6.sql
2018-08-14 12:20:48: Generated query_7.sql
2018-08-14 12:20:48: Generated query_8.sql
2018-08-14 12:20:48: Generated query_9.sql
2018-08-14 12:20:48: Generated query_10.sql
2018-08-14 12:20:48: Generated query_11.sql
2018-08-14 12:20:48: Generated query_12.sql
2018-08-14 12:20:48: Generated query_13.sql
2018-08-14 12:20:48: Generated query_14.sql
2018-08-14 12:20:48: Generated query_15.sql
2018-08-14 12:20:48: Generated query_16.sql
2018-08-14 12:20:48: Generated query_17.sql
2018-08-14 12:20:48: Generated query_18.sql
2018-08-14 12:20:48: Generated query_19.sql
2018-08-14 12:20:48: Generated query_20.sql
2018-08-14 12:20:48: Generated query_21.sql
2018-08-14 12:20:48: Generated query_22.sql
2018-08-14 12:20:48: Generated query_23.sql
2018-08-14 12:20:48: Generated query_24.sql
2018-08-14 12:20:48: Generated query_25.sql
2018-08-14 12:20:48: Generated query_26.sql
2018-08-14 12:20:48: Generated query_27.sql
2018-08-14 12:20:48: Generated query_28.sql
2018-08-14 12:20:48: Generated query_29.sql
2018-08-14 12:20:48: Generated query_30.sql
2018-08-14 12:20:48: Generated query_31.sql
2018-08-14 12:20:48: Generated query_32.sql
2018-08-14 12:20:48: Generated query_33.sql
2018-08-14 12:20:48: Generated query_34.sql
2018-08-14 12:20:48: Generated query_35.sql
2018-08-14 12:20:48: Generated query_36.sql
2018-08-14 12:20:48: Generated query_37.sql
2018-08-14 12:20:48: Generated query_38.sql
2018-08-14 12:20:48: Generated query_39.sql
2018-08-14 12:20:48: Generated query_40.sql
2018-08-14 12:20:48: Generated query_41.sql
2018-08-14 12:20:48: Generated query_42.sql
2018-08-14 12:20:48: Generated query_43.sql
2018-08-14 12:20:48: Generated query_44.sql
2018-08-14 12:20:48: Generated query_45.sql
2018-08-14 12:20:48: Generated query_46.sql
2018-08-14 12:20:48: Generated query_47.sql
2018-08-14 12:20:48: Generated query_48.sql
2018-08-14 12:20:48: Generated query_49.sql
2018-08-14 12:20:48: Generated query_50.sql
2018-08-14 12:20:48: Generated query_51.sql
2018-08-14 12:20:48: Generated query_52.sql
2018-08-14 12:20:48: Generated query_53.sql
2018-08-14 12:20:48: Generated query_54.sql
2018-08-14 12:20:48: Generated query_55.sql
2018-08-14 12:20:48: Generated query_56.sql
2018-08-14 12:20:48: Generated query_57.sql
2018-08-14 12:20:48: Generated query_58.sql
2018-08-14 12:20:48: Generated query_59.sql
2018-08-14 12:20:48: Generated query_60.sql
2018-08-14 12:20:48: Generated query_61.sql
2018-08-14 12:20:48: Generated query_62.sql
2018-08-14 12:20:48: Generated query_63.sql
2018-08-14 12:20:48: Generated query_64.sql
2018-08-14 12:20:48: Generated query_65.sql
2018-08-14 12:20:48: Generated query_66.sql
2018-08-14 12:20:48: Generated query_67.sql
2018-08-14 12:20:48: Generated query_68.sql
2018-08-14 12:20:48: Generated query_69.sql
2018-08-14 12:20:48: Generated query_70.sql
2018-08-14 12:20:48: Generated query_71.sql
2018-08-14 12:20:48: Generated query_72.sql
2018-08-14 12:20:48: Generated query_73.sql
2018-08-14 12:20:48: Generated query_74.sql
2018-08-14 12:20:48: Generated query_75.sql
2018-08-14 12:20:48: Generated query_76.sql
2018-08-14 12:20:48: Generated query_77.sql
2018-08-14 12:20:48: Generated query_78.sql
2018-08-14 12:20:48: Generated query_79.sql
2018-08-14 12:20:48: Generated query_80.sql
2018-08-14 12:20:48: Generated query_81.sql
2018-08-14 12:20:48: Generated query_82.sql
2018-08-14 12:20:48: Generated query_83.sql
2018-08-14 12:20:48: Generated query_84.sql
2018-08-14 12:20:48: Generated query_85.sql
2018-08-14 12:20:48: Generated query_86.sql
2018-08-14 12:20:48: Generated query_87.sql
2018-08-14 12:20:48: Generated query_88.sql
2018-08-14 12:20:48: Generated query_89.sql
2018-08-14 12:20:48: Generated query_90.sql
2018-08-14 12:20:48: Generated query_91.sql
2018-08-14 12:20:48: Generated query_92.sql
2018-08-14 12:20:48: Generated query_93.sql
2018-08-14 12:20:48: Generated query_94.sql
2018-08-14 12:20:48: Generated query_95.sql
2018-08-14 12:20:48: Generated query_96.sql
2018-08-14 12:20:48: Generated query_97.sql
2018-08-14 12:20:48: Generated query_98.sql
2018-08-14 12:20:48: Generated query_99.sql
2018-08-14 12:20:48: Generated query_100.sql
2018-08-14 12:20:48: Generated query_101.sql
2018-08-14 12:20:48: Generated query_102.sql
2018-08-14 12:20:48: Generated query_103.sql
2018-08-14 12:20:48: Generated query_104.sql
2018-08-14 12:20:48: Script Complete!
-------------------------------------
2018-08-14 13:05:20: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:05:20: Connection pool instantiated with [1] connections
2018-08-14 13:05:22: ('spark.cores.max', '20')
2018-08-14 13:05:22: ('spark.executor.memory', '2g')
2018-08-14 13:05:22: ('spark.driver.port', '12881')
2018-08-14 13:05:22: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:05:22: ('spark.app.id', 'app-20180814130522-0051')
2018-08-14 13:05:22: ('spark.executor.id', 'driver')
2018-08-14 13:05:22: ('spark.python.worker.reuse', 'True')
2018-08-14 13:05:22: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:05:22: ('spark.default.parallelism', '80')
2018-08-14 13:05:22: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:05:22: ('spark.executor.instances', '20')
2018-08-14 13:05:22: ('spark.logConf', 'False')
2018-08-14 13:05:22: ('spark.rdd.compress', 'True')
2018-08-14 13:05:22: ('spark.driver.memory', '2g')
2018-08-14 13:05:22: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:05:22: ('spark.executor.cores', '1')
2018-08-14 13:05:22: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:05:22: ('spark.submit.deployMode', 'client')
2018-08-14 13:05:22: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:05:22: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:05:22: ('spark.app.name', 'ICS5200')
2018-08-14 13:05:22: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 13:05:22: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 13:05:22: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 13:05:22: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 13:05:22: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 13:05:22: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 13:05:23: Successfully finished migrating DML scripts!
2018-08-14 13:05:23: Starting TPC-DS sql splitting
2018-08-14 13:05:23: Generated query_1.sql
2018-08-14 13:05:23: Generated query_2.sql
2018-08-14 13:05:23: Generated query_3.sql
2018-08-14 13:05:23: Generated query_4.sql
2018-08-14 13:05:23: Generated query_5.sql
2018-08-14 13:05:23: Generated query_6.sql
2018-08-14 13:05:23: Generated query_7.sql
2018-08-14 13:05:23: Generated query_8.sql
2018-08-14 13:05:23: Generated query_9.sql
2018-08-14 13:05:23: Generated query_10.sql
2018-08-14 13:05:23: Generated query_11.sql
2018-08-14 13:05:23: Generated query_12.sql
2018-08-14 13:05:23: Generated query_13.sql
2018-08-14 13:05:23: Generated query_14.sql
2018-08-14 13:05:23: Generated query_15.sql
2018-08-14 13:05:23: Generated query_16.sql
2018-08-14 13:05:23: Generated query_17.sql
2018-08-14 13:05:23: Generated query_18.sql
2018-08-14 13:05:23: Generated query_19.sql
2018-08-14 13:05:23: Generated query_20.sql
2018-08-14 13:05:23: Generated query_21.sql
2018-08-14 13:05:23: Generated query_22.sql
2018-08-14 13:05:23: Generated query_23.sql
2018-08-14 13:05:23: Generated query_24.sql
2018-08-14 13:05:23: Generated query_25.sql
2018-08-14 13:05:23: Generated query_26.sql
2018-08-14 13:05:23: Generated query_27.sql
2018-08-14 13:05:23: Generated query_28.sql
2018-08-14 13:05:23: Generated query_29.sql
2018-08-14 13:05:23: Generated query_30.sql
2018-08-14 13:05:23: Generated query_31.sql
2018-08-14 13:05:23: Generated query_32.sql
2018-08-14 13:05:23: Generated query_33.sql
2018-08-14 13:05:23: Generated query_34.sql
2018-08-14 13:05:23: Generated query_35.sql
2018-08-14 13:05:23: Generated query_36.sql
2018-08-14 13:05:23: Generated query_37.sql
2018-08-14 13:05:23: Generated query_38.sql
2018-08-14 13:05:23: Generated query_39.sql
2018-08-14 13:05:23: Generated query_40.sql
2018-08-14 13:05:23: Generated query_41.sql
2018-08-14 13:05:23: Generated query_42.sql
2018-08-14 13:05:23: Generated query_43.sql
2018-08-14 13:05:23: Generated query_44.sql
2018-08-14 13:05:23: Generated query_45.sql
2018-08-14 13:05:23: Generated query_46.sql
2018-08-14 13:05:23: Generated query_47.sql
2018-08-14 13:05:23: Generated query_48.sql
2018-08-14 13:05:23: Generated query_49.sql
2018-08-14 13:05:23: Generated query_50.sql
2018-08-14 13:05:23: Generated query_51.sql
2018-08-14 13:05:23: Generated query_52.sql
2018-08-14 13:05:23: Generated query_53.sql
2018-08-14 13:05:23: Generated query_54.sql
2018-08-14 13:05:23: Generated query_55.sql
2018-08-14 13:05:23: Generated query_56.sql
2018-08-14 13:05:23: Generated query_57.sql
2018-08-14 13:05:23: Generated query_58.sql
2018-08-14 13:05:23: Generated query_59.sql
2018-08-14 13:05:23: Generated query_60.sql
2018-08-14 13:05:23: Generated query_61.sql
2018-08-14 13:05:23: Generated query_62.sql
2018-08-14 13:05:23: Generated query_63.sql
2018-08-14 13:05:23: Generated query_64.sql
2018-08-14 13:05:23: Generated query_65.sql
2018-08-14 13:05:23: Generated query_66.sql
2018-08-14 13:05:23: Generated query_67.sql
2018-08-14 13:05:23: Generated query_68.sql
2018-08-14 13:05:23: Generated query_69.sql
2018-08-14 13:05:23: Generated query_70.sql
2018-08-14 13:05:23: Generated query_71.sql
2018-08-14 13:05:23: Generated query_72.sql
2018-08-14 13:05:23: Generated query_73.sql
2018-08-14 13:05:23: Generated query_74.sql
2018-08-14 13:05:23: Generated query_75.sql
2018-08-14 13:05:23: Generated query_76.sql
2018-08-14 13:05:23: Generated query_77.sql
2018-08-14 13:05:23: Generated query_78.sql
2018-08-14 13:05:23: Generated query_79.sql
2018-08-14 13:05:23: Generated query_80.sql
2018-08-14 13:05:23: Generated query_81.sql
2018-08-14 13:05:23: Generated query_82.sql
2018-08-14 13:05:23: Generated query_83.sql
2018-08-14 13:05:23: Generated query_84.sql
2018-08-14 13:05:23: Generated query_85.sql
2018-08-14 13:05:23: Generated query_86.sql
2018-08-14 13:05:23: Generated query_87.sql
2018-08-14 13:05:23: Generated query_88.sql
2018-08-14 13:05:23: Generated query_89.sql
2018-08-14 13:05:23: Generated query_90.sql
2018-08-14 13:05:23: Generated query_91.sql
2018-08-14 13:05:23: Generated query_92.sql
2018-08-14 13:05:23: Generated query_93.sql
2018-08-14 13:05:23: Generated query_94.sql
2018-08-14 13:05:23: Generated query_95.sql
2018-08-14 13:05:23: Generated query_96.sql
2018-08-14 13:05:23: Generated query_97.sql
2018-08-14 13:05:23: Generated query_98.sql
2018-08-14 13:05:23: Generated query_99.sql
2018-08-14 13:05:23: Generated query_100.sql
2018-08-14 13:05:23: Generated query_101.sql
2018-08-14 13:05:23: Generated query_102.sql
2018-08-14 13:05:23: Generated query_103.sql
2018-08-14 13:05:23: Generated query_104.sql
2018-08-14 13:05:23: Script Complete!
-------------------------------------
2018-08-14 13:07:22: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:07:22: Connection pool instantiated with [1] connections
2018-08-14 13:07:24: ('spark.cores.max', '20')
2018-08-14 13:07:24: ('spark.executor.memory', '2g')
2018-08-14 13:07:24: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:07:24: ('spark.executor.id', 'driver')
2018-08-14 13:07:24: ('spark.python.worker.reuse', 'True')
2018-08-14 13:07:24: ('spark.driver.port', '36076')
2018-08-14 13:07:24: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:07:24: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:07:24: ('spark.default.parallelism', '80')
2018-08-14 13:07:24: ('spark.executor.instances', '20')
2018-08-14 13:07:24: ('spark.logConf', 'False')
2018-08-14 13:07:24: ('spark.rdd.compress', 'True')
2018-08-14 13:07:24: ('spark.driver.memory', '2g')
2018-08-14 13:07:24: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:07:24: ('spark.executor.cores', '1')
2018-08-14 13:07:24: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:07:24: ('spark.submit.deployMode', 'client')
2018-08-14 13:07:24: ('spark.app.id', 'app-20180814130724-0055')
2018-08-14 13:07:24: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:07:24: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:07:24: ('spark.app.name', 'ICS5200')
2018-08-14 13:07:25: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 13:07:25: Generating execution metrics for [query_1.sql]..
2018-08-14 13:07:25: Generating execution metrics for [query_2.sql]..
2018-08-14 13:07:25: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 13:07:25: Generating execution metrics for [query_3.sql]..
2018-08-14 13:07:25: Generating execution metrics for [query_4.sql]..
2018-08-14 13:07:33: Generating execution metrics for [query_5.sql]..
2018-08-14 13:07:33: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast('2000-08-19' ,'yyyy/mm/dd') and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' ,'yyyy/mm/dd') and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' ,'yyyy/mm/dd') and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 13:07:34: Generating execution metrics for [query_6.sql]..
2018-08-14 13:07:34: Generating execution metrics for [query_7.sql]..
2018-08-14 13:07:34: Generating execution metrics for [query_8.sql]..
2018-08-14 13:07:34: Generating execution metrics for [query_9.sql]..
2018-08-14 13:07:38: Generating execution metrics for [query_10.sql]..
2018-08-14 13:07:38: Generating execution metrics for [query_11.sql]..
2018-08-14 13:07:40: Generating execution metrics for [query_12.sql]..
2018-08-14 13:07:40: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-06-15' ,'yyyy/mm/dd') and to_char((to_date('2001-06-15' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:07:41: Generating execution metrics for [query_13.sql]..
2018-08-14 13:07:45: Generating execution metrics for [query_14.sql]..
2018-08-14 13:07:49: Generating execution metrics for [query_15.sql]..
2018-08-14 13:07:49: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 13:07:49: Generating execution metrics for [query_16.sql]..
2018-08-14 13:07:49: Generating execution metrics for [query_17.sql]..
2018-08-14 13:07:49: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and to_char((to_date('2002-4-01' ,'yyyy/mm/dd') + 60),'yyyy-mm-dd' and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 13:07:49: Generating execution metrics for [query_18.sql]..
2018-08-14 13:07:50: Generating execution metrics for [query_19.sql]..
2018-08-14 13:07:50: Generating execution metrics for [query_20.sql]..
2018-08-14 13:07:51: Generating execution metrics for [query_21.sql]..
2018-08-14 13:07:51: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' ,'yyyy/mm/dd') and to_char((to_date('2002-06-18' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:07:51: Generating execution metrics for [query_22.sql]..
2018-08-14 13:07:51: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd') < cast ('1999-06-22' ,'yyyy/mm/dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date ,'yyyy/mm/dd') >= cast ('1999-06-22' ,'yyyy/mm/dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' ,'yyyy/mm/dd') - 30),'yyyy-mm-dd' and (cast ('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 13:07:51: Generating execution metrics for [query_23.sql]..
2018-08-14 13:07:58: Generating execution metrics for [query_24.sql]..
2018-08-14 13:08:07: Generating execution metrics for [query_25.sql]..
2018-08-14 13:08:14: Generating execution metrics for [query_26.sql]..
2018-08-14 13:08:14: Generating execution metrics for [query_27.sql]..
2018-08-14 13:08:14: Generating execution metrics for [query_28.sql]..
2018-08-14 13:08:15: Generating execution metrics for [query_29.sql]..
2018-08-14 13:08:15: Generating execution metrics for [query_30.sql]..
2018-08-14 13:08:16: Generating execution metrics for [query_31.sql]..
2018-08-14 13:08:18: Generating execution metrics for [query_32.sql]..
2018-08-14 13:08:18: Generating execution metrics for [query_33.sql]..
2018-08-14 13:08:18: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 13:08:18: Generating execution metrics for [query_34.sql]..
2018-08-14 13:08:20: Generating execution metrics for [query_35.sql]..
2018-08-14 13:08:20: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and to_char((to_date('2001-03-09' ,'yyyy/mm/dd') + 90),'yyyy-mm-dd' and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and to_char((to_date('2001-03-09' ,'yyyy/mm/dd') + 90),'yyyy-mm-dd' and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 13:08:20: Generating execution metrics for [query_36.sql]..
2018-08-14 13:08:21: Generating execution metrics for [query_37.sql]..
2018-08-14 13:08:21: Generating execution metrics for [query_38.sql]..
2018-08-14 13:10:14: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:10:14: Connection pool instantiated with [1] connections
2018-08-14 13:10:17: ('spark.cores.max', '20')
2018-08-14 13:10:17: ('spark.executor.memory', '2g')
2018-08-14 13:10:17: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:10:17: ('spark.executor.id', 'driver')
2018-08-14 13:10:17: ('spark.python.worker.reuse', 'True')
2018-08-14 13:10:17: ('spark.driver.port', '16486')
2018-08-14 13:10:17: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:10:17: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:10:17: ('spark.default.parallelism', '80')
2018-08-14 13:10:17: ('spark.app.id', 'app-20180814131017-0056')
2018-08-14 13:10:17: ('spark.executor.instances', '20')
2018-08-14 13:10:17: ('spark.logConf', 'False')
2018-08-14 13:10:17: ('spark.rdd.compress', 'True')
2018-08-14 13:10:17: ('spark.driver.memory', '2g')
2018-08-14 13:10:17: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:10:17: ('spark.executor.cores', '1')
2018-08-14 13:10:17: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:10:17: ('spark.submit.deployMode', 'client')
2018-08-14 13:10:17: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:10:17: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:10:17: ('spark.app.name', 'ICS5200')
2018-08-14 13:10:17: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 13:10:17: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 13:10:17: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 13:10:18: Successfully finished migrating DML scripts!
2018-08-14 13:10:18: Starting TPC-DS sql splitting
2018-08-14 13:10:18: Generated query_1.sql
2018-08-14 13:10:18: Generated query_2.sql
2018-08-14 13:10:18: Generated query_3.sql
2018-08-14 13:10:18: Generated query_4.sql
2018-08-14 13:10:18: Generated query_5.sql
2018-08-14 13:10:18: Generated query_6.sql
2018-08-14 13:10:18: Generated query_7.sql
2018-08-14 13:10:18: Generated query_8.sql
2018-08-14 13:10:18: Generated query_9.sql
2018-08-14 13:10:18: Generated query_10.sql
2018-08-14 13:10:18: Generated query_11.sql
2018-08-14 13:10:18: Generated query_12.sql
2018-08-14 13:10:18: Generated query_13.sql
2018-08-14 13:10:18: Generated query_14.sql
2018-08-14 13:10:18: Generated query_15.sql
2018-08-14 13:10:18: Generated query_16.sql
2018-08-14 13:10:18: Generated query_17.sql
2018-08-14 13:10:18: Generated query_18.sql
2018-08-14 13:10:18: Generated query_19.sql
2018-08-14 13:10:18: Generated query_20.sql
2018-08-14 13:10:18: Generated query_21.sql
2018-08-14 13:10:18: Generated query_22.sql
2018-08-14 13:10:18: Generated query_23.sql
2018-08-14 13:10:18: Generated query_24.sql
2018-08-14 13:10:18: Generated query_25.sql
2018-08-14 13:10:18: Generated query_26.sql
2018-08-14 13:10:18: Generated query_27.sql
2018-08-14 13:10:18: Generated query_28.sql
2018-08-14 13:10:18: Generated query_29.sql
2018-08-14 13:10:18: Generated query_30.sql
2018-08-14 13:10:18: Generated query_31.sql
2018-08-14 13:10:18: Generated query_32.sql
2018-08-14 13:10:18: Generated query_33.sql
2018-08-14 13:10:18: Generated query_34.sql
2018-08-14 13:10:18: Generated query_35.sql
2018-08-14 13:10:18: Generated query_36.sql
2018-08-14 13:10:18: Generated query_37.sql
2018-08-14 13:10:18: Generated query_38.sql
2018-08-14 13:10:18: Generated query_39.sql
2018-08-14 13:10:18: Generated query_40.sql
2018-08-14 13:10:18: Generated query_41.sql
2018-08-14 13:10:18: Generated query_42.sql
2018-08-14 13:10:18: Generated query_43.sql
2018-08-14 13:10:18: Generated query_44.sql
2018-08-14 13:10:18: Generated query_45.sql
2018-08-14 13:10:18: Generated query_46.sql
2018-08-14 13:10:18: Generated query_47.sql
2018-08-14 13:10:18: Generated query_48.sql
2018-08-14 13:10:18: Generated query_49.sql
2018-08-14 13:10:18: Generated query_50.sql
2018-08-14 13:10:18: Generated query_51.sql
2018-08-14 13:10:18: Generated query_52.sql
2018-08-14 13:10:18: Generated query_53.sql
2018-08-14 13:10:18: Generated query_54.sql
2018-08-14 13:10:18: Generated query_55.sql
2018-08-14 13:10:18: Generated query_56.sql
2018-08-14 13:10:18: Generated query_57.sql
2018-08-14 13:10:18: Generated query_58.sql
2018-08-14 13:10:18: Generated query_59.sql
2018-08-14 13:10:18: Generated query_60.sql
2018-08-14 13:10:18: Generated query_61.sql
2018-08-14 13:10:18: Generated query_62.sql
2018-08-14 13:10:18: Generated query_63.sql
2018-08-14 13:10:18: Generated query_64.sql
2018-08-14 13:10:18: Generated query_65.sql
2018-08-14 13:10:18: Generated query_66.sql
2018-08-14 13:10:18: Generated query_67.sql
2018-08-14 13:10:18: Generated query_68.sql
2018-08-14 13:10:18: Generated query_69.sql
2018-08-14 13:10:18: Generated query_70.sql
2018-08-14 13:10:18: Generated query_71.sql
2018-08-14 13:10:18: Generated query_72.sql
2018-08-14 13:10:18: Generated query_73.sql
2018-08-14 13:10:18: Generated query_74.sql
2018-08-14 13:10:18: Generated query_75.sql
2018-08-14 13:10:18: Generated query_76.sql
2018-08-14 13:10:18: Generated query_77.sql
2018-08-14 13:10:18: Generated query_78.sql
2018-08-14 13:10:18: Generated query_79.sql
2018-08-14 13:10:18: Generated query_80.sql
2018-08-14 13:10:18: Generated query_81.sql
2018-08-14 13:10:18: Generated query_82.sql
2018-08-14 13:10:18: Generated query_83.sql
2018-08-14 13:10:18: Generated query_84.sql
2018-08-14 13:10:18: Generated query_85.sql
2018-08-14 13:10:18: Generated query_86.sql
2018-08-14 13:10:18: Generated query_87.sql
2018-08-14 13:10:18: Generated query_88.sql
2018-08-14 13:10:18: Generated query_89.sql
2018-08-14 13:10:18: Generated query_90.sql
2018-08-14 13:10:18: Generated query_91.sql
2018-08-14 13:10:18: Generated query_92.sql
2018-08-14 13:10:18: Generated query_93.sql
2018-08-14 13:10:18: Generated query_94.sql
2018-08-14 13:10:18: Generated query_95.sql
2018-08-14 13:10:18: Generated query_96.sql
2018-08-14 13:10:18: Generated query_97.sql
2018-08-14 13:10:18: Generated query_98.sql
2018-08-14 13:10:18: Generated query_99.sql
2018-08-14 13:10:18: Generated query_100.sql
2018-08-14 13:10:18: Generated query_101.sql
2018-08-14 13:10:18: Generated query_102.sql
2018-08-14 13:10:18: Generated query_103.sql
2018-08-14 13:10:18: Generated query_104.sql
2018-08-14 13:10:18: Script Complete!
-------------------------------------
2018-08-14 13:11:13: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:11:13: Connection pool instantiated with [1] connections
2018-08-14 13:11:16: ('spark.cores.max', '20')
2018-08-14 13:11:16: ('spark.executor.memory', '2g')
2018-08-14 13:11:16: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:11:16: ('spark.executor.id', 'driver')
2018-08-14 13:11:16: ('spark.python.worker.reuse', 'True')
2018-08-14 13:11:16: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:11:16: ('spark.default.parallelism', '80')
2018-08-14 13:11:16: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:11:16: ('spark.executor.instances', '20')
2018-08-14 13:11:16: ('spark.logConf', 'False')
2018-08-14 13:11:16: ('spark.rdd.compress', 'True')
2018-08-14 13:11:16: ('spark.driver.memory', '2g')
2018-08-14 13:11:16: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:11:16: ('spark.executor.cores', '1')
2018-08-14 13:11:16: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:11:16: ('spark.submit.deployMode', 'client')
2018-08-14 13:11:16: ('spark.app.id', 'app-20180814131116-0059')
2018-08-14 13:11:16: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:11:16: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:11:16: ('spark.driver.port', '28426')
2018-08-14 13:11:16: ('spark.app.name', 'ICS5200')
2018-08-14 13:11:17: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 13:11:17: Generating execution metrics for [query_1.sql]..
2018-08-14 13:11:17: Generating execution metrics for [query_2.sql]..
2018-08-14 13:11:17: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 13:11:17: Generating execution metrics for [query_3.sql]..
2018-08-14 13:11:17: Generating execution metrics for [query_4.sql]..
2018-08-14 13:11:25: Generating execution metrics for [query_5.sql]..
2018-08-14 13:11:25: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd') and (to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd') and (to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd') and (to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 13:11:25: Generating execution metrics for [query_6.sql]..
2018-08-14 13:11:25: Generating execution metrics for [query_7.sql]..
2018-08-14 13:11:25: Generating execution metrics for [query_8.sql]..
2018-08-14 13:11:25: Generating execution metrics for [query_9.sql]..
2018-08-14 13:11:28: Generating execution metrics for [query_10.sql]..
2018-08-14 13:11:29: Generating execution metrics for [query_11.sql]..
2018-08-14 13:11:32: Generating execution metrics for [query_12.sql]..
2018-08-14 13:11:32: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between to_char((to_date('2001-06-15' ,'yyyy/mm/dd') and (to_char((to_date('2001-06-15' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:11:32: Generating execution metrics for [query_13.sql]..
2018-08-14 13:31:43: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:31:43: Connection pool instantiated with [1] connections
2018-08-14 13:31:45: ('spark.cores.max', '20')
2018-08-14 13:31:45: ('spark.executor.memory', '2g')
2018-08-14 13:31:45: ('spark.app.id', 'app-20180814133145-0060')
2018-08-14 13:31:45: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:31:45: ('spark.executor.id', 'driver')
2018-08-14 13:31:45: ('spark.python.worker.reuse', 'True')
2018-08-14 13:31:45: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:31:45: ('spark.default.parallelism', '80')
2018-08-14 13:31:45: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:31:45: ('spark.executor.instances', '20')
2018-08-14 13:31:45: ('spark.logConf', 'False')
2018-08-14 13:31:45: ('spark.rdd.compress', 'True')
2018-08-14 13:31:45: ('spark.driver.memory', '2g')
2018-08-14 13:31:45: ('spark.driver.port', '15159')
2018-08-14 13:31:45: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:31:45: ('spark.executor.cores', '1')
2018-08-14 13:31:45: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:31:45: ('spark.submit.deployMode', 'client')
2018-08-14 13:31:45: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:31:45: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:31:45: ('spark.app.name', 'ICS5200')
2018-08-14 13:31:46: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 13:31:46: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 13:31:46: Successfully finished migrating DML scripts!
2018-08-14 13:31:46: Starting TPC-DS sql splitting
2018-08-14 13:31:46: Generated query_1.sql
2018-08-14 13:31:46: Generated query_2.sql
2018-08-14 13:31:46: Generated query_3.sql
2018-08-14 13:31:46: Generated query_4.sql
2018-08-14 13:31:46: Generated query_5.sql
2018-08-14 13:31:46: Generated query_6.sql
2018-08-14 13:31:46: Generated query_7.sql
2018-08-14 13:31:46: Generated query_8.sql
2018-08-14 13:31:46: Generated query_9.sql
2018-08-14 13:31:46: Generated query_10.sql
2018-08-14 13:31:46: Generated query_11.sql
2018-08-14 13:31:46: Generated query_12.sql
2018-08-14 13:31:46: Generated query_13.sql
2018-08-14 13:31:46: Generated query_14.sql
2018-08-14 13:31:46: Generated query_15.sql
2018-08-14 13:31:46: Generated query_16.sql
2018-08-14 13:31:46: Generated query_17.sql
2018-08-14 13:31:46: Generated query_18.sql
2018-08-14 13:31:46: Generated query_19.sql
2018-08-14 13:31:46: Generated query_20.sql
2018-08-14 13:31:46: Generated query_21.sql
2018-08-14 13:31:46: Generated query_22.sql
2018-08-14 13:31:46: Generated query_23.sql
2018-08-14 13:31:46: Generated query_24.sql
2018-08-14 13:31:46: Generated query_25.sql
2018-08-14 13:31:46: Generated query_26.sql
2018-08-14 13:31:46: Generated query_27.sql
2018-08-14 13:31:46: Generated query_28.sql
2018-08-14 13:31:46: Generated query_29.sql
2018-08-14 13:31:46: Generated query_30.sql
2018-08-14 13:31:46: Generated query_31.sql
2018-08-14 13:31:46: Generated query_32.sql
2018-08-14 13:31:46: Generated query_33.sql
2018-08-14 13:31:46: Generated query_34.sql
2018-08-14 13:31:46: Generated query_35.sql
2018-08-14 13:31:46: Generated query_36.sql
2018-08-14 13:31:46: Generated query_37.sql
2018-08-14 13:31:46: Generated query_38.sql
2018-08-14 13:31:46: Generated query_39.sql
2018-08-14 13:31:46: Generated query_40.sql
2018-08-14 13:31:46: Generated query_41.sql
2018-08-14 13:31:46: Generated query_42.sql
2018-08-14 13:31:46: Generated query_43.sql
2018-08-14 13:31:46: Generated query_44.sql
2018-08-14 13:31:46: Generated query_45.sql
2018-08-14 13:31:46: Generated query_46.sql
2018-08-14 13:31:46: Generated query_47.sql
2018-08-14 13:31:46: Generated query_48.sql
2018-08-14 13:31:46: Generated query_49.sql
2018-08-14 13:31:46: Generated query_50.sql
2018-08-14 13:31:46: Generated query_51.sql
2018-08-14 13:31:46: Generated query_52.sql
2018-08-14 13:31:46: Generated query_53.sql
2018-08-14 13:31:46: Generated query_54.sql
2018-08-14 13:31:46: Generated query_55.sql
2018-08-14 13:31:46: Generated query_56.sql
2018-08-14 13:31:46: Generated query_57.sql
2018-08-14 13:31:46: Generated query_58.sql
2018-08-14 13:31:46: Generated query_59.sql
2018-08-14 13:31:46: Generated query_60.sql
2018-08-14 13:31:46: Generated query_61.sql
2018-08-14 13:31:46: Generated query_62.sql
2018-08-14 13:31:46: Generated query_63.sql
2018-08-14 13:31:46: Generated query_64.sql
2018-08-14 13:31:46: Generated query_65.sql
2018-08-14 13:31:46: Generated query_66.sql
2018-08-14 13:31:46: Generated query_67.sql
2018-08-14 13:31:46: Generated query_68.sql
2018-08-14 13:31:46: Generated query_69.sql
2018-08-14 13:31:46: Generated query_70.sql
2018-08-14 13:31:46: Generated query_71.sql
2018-08-14 13:31:46: Generated query_72.sql
2018-08-14 13:31:46: Generated query_73.sql
2018-08-14 13:31:46: Generated query_74.sql
2018-08-14 13:31:46: Generated query_75.sql
2018-08-14 13:31:46: Generated query_76.sql
2018-08-14 13:31:46: Generated query_77.sql
2018-08-14 13:31:46: Generated query_78.sql
2018-08-14 13:31:46: Generated query_79.sql
2018-08-14 13:31:46: Generated query_80.sql
2018-08-14 13:31:46: Generated query_81.sql
2018-08-14 13:31:46: Generated query_82.sql
2018-08-14 13:31:46: Generated query_83.sql
2018-08-14 13:31:46: Generated query_84.sql
2018-08-14 13:31:46: Generated query_85.sql
2018-08-14 13:31:46: Generated query_86.sql
2018-08-14 13:31:46: Generated query_87.sql
2018-08-14 13:31:46: Generated query_88.sql
2018-08-14 13:31:46: Generated query_89.sql
2018-08-14 13:31:46: Generated query_90.sql
2018-08-14 13:31:46: Generated query_91.sql
2018-08-14 13:31:46: Generated query_92.sql
2018-08-14 13:31:46: Generated query_93.sql
2018-08-14 13:31:46: Generated query_94.sql
2018-08-14 13:31:46: Generated query_95.sql
2018-08-14 13:31:46: Generated query_96.sql
2018-08-14 13:31:46: Generated query_97.sql
2018-08-14 13:31:46: Generated query_98.sql
2018-08-14 13:31:46: Generated query_99.sql
2018-08-14 13:31:46: Generated query_100.sql
2018-08-14 13:31:46: Generated query_101.sql
2018-08-14 13:31:46: Generated query_102.sql
2018-08-14 13:31:46: Generated query_103.sql
2018-08-14 13:31:46: Generated query_104.sql
2018-08-14 13:31:46: Script Complete!
-------------------------------------
2018-08-14 13:31:54: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:31:54: Connection pool instantiated with [1] connections
2018-08-14 13:31:57: ('spark.cores.max', '20')
2018-08-14 13:31:57: ('spark.executor.memory', '2g')
2018-08-14 13:31:57: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:31:57: ('spark.executor.id', 'driver')
2018-08-14 13:31:57: ('spark.python.worker.reuse', 'True')
2018-08-14 13:31:57: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:31:57: ('spark.default.parallelism', '80')
2018-08-14 13:31:57: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:31:57: ('spark.executor.instances', '20')
2018-08-14 13:31:57: ('spark.app.id', 'app-20180814133156-0061')
2018-08-14 13:31:57: ('spark.logConf', 'False')
2018-08-14 13:31:57: ('spark.rdd.compress', 'True')
2018-08-14 13:31:57: ('spark.driver.memory', '2g')
2018-08-14 13:31:57: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:31:57: ('spark.executor.cores', '1')
2018-08-14 13:31:57: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:31:57: ('spark.driver.port', '14746')
2018-08-14 13:31:57: ('spark.submit.deployMode', 'client')
2018-08-14 13:31:57: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:31:57: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:31:57: ('spark.app.name', 'ICS5200')
2018-08-14 13:31:57: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 13:31:57: Generating execution metrics for [query_1.sql]..
2018-08-14 13:31:58: Generating execution metrics for [query_2.sql]..
2018-08-14 13:31:58: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 13:31:58: Generating execution metrics for [query_3.sql]..
2018-08-14 13:31:58: Generating execution metrics for [query_4.sql]..
2018-08-14 13:32:06: Generating execution metrics for [query_5.sql]..
2018-08-14 13:32:06: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') 14),'yyyy-mm-dd' and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') 14),'yyyy-mm-dd' and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') 14),'yyyy-mm-dd' and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 13:32:06: Generating execution metrics for [query_6.sql]..
2018-08-14 13:32:06: Generating execution metrics for [query_7.sql]..
2018-08-14 13:32:06: Generating execution metrics for [query_8.sql]..
2018-08-14 13:32:07: Generating execution metrics for [query_9.sql]..
2018-08-14 13:32:09: Generating execution metrics for [query_10.sql]..
2018-08-14 13:32:09: Generating execution metrics for [query_11.sql]..
2018-08-14 13:32:12: Generating execution metrics for [query_12.sql]..
2018-08-14 13:32:12: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between to_char((to_date('2001-06-15' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2001-06-15' ,'yyyy/mm/dd') 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:32:12: Generating execution metrics for [query_13.sql]..
2018-08-14 13:32:15: Generating execution metrics for [query_14.sql]..
2018-08-14 13:32:18: Generating execution metrics for [query_15.sql]..
2018-08-14 13:32:18: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 13:32:18: Generating execution metrics for [query_16.sql]..
2018-08-14 13:32:19: Generating execution metrics for [query_17.sql]..
2018-08-14 13:32:19: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and to_char((to_date('2002-4-01' ,'yyyy/mm/dd') 60),'yyyy-mm-dd' and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 13:32:19: Generating execution metrics for [query_18.sql]..
2018-08-14 13:32:19: Generating execution metrics for [query_19.sql]..
2018-08-14 13:32:20: Generating execution metrics for [query_20.sql]..
2018-08-14 13:32:20: Generating execution metrics for [query_21.sql]..
2018-08-14 13:32:20: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between to_char((to_date('2002-06-18' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2002-06-18' ,'yyyy/mm/dd') 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:32:20: Generating execution metrics for [query_22.sql]..
2018-08-14 13:32:20: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' < cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' >= cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd' - 30),'yyyy-mm-dd' and (cast ('1999-06-22' ,'yyyy/mm/dd') 30),'yyyy-mm-dd' group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 13:32:20: Generating execution metrics for [query_23.sql]..
2018-08-14 13:32:25: Generating execution metrics for [query_24.sql]..
2018-08-14 13:32:31: Generating execution metrics for [query_25.sql]..
2018-08-14 13:32:37: Generating execution metrics for [query_26.sql]..
2018-08-14 13:32:37: Generating execution metrics for [query_27.sql]..
2018-08-14 13:32:37: Generating execution metrics for [query_28.sql]..
2018-08-14 13:32:38: Generating execution metrics for [query_29.sql]..
2018-08-14 13:32:38: Generating execution metrics for [query_30.sql]..
2018-08-14 13:32:38: Generating execution metrics for [query_31.sql]..
2018-08-14 13:32:40: Generating execution metrics for [query_32.sql]..
2018-08-14 13:32:40: Generating execution metrics for [query_33.sql]..
2018-08-14 13:32:40: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 13:32:40: Generating execution metrics for [query_34.sql]..
2018-08-14 13:32:42: Generating execution metrics for [query_35.sql]..
2018-08-14 13:32:42: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and to_char((to_date('2001-03-09' ,'yyyy/mm/dd') 90),'yyyy-mm-dd' and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and to_char((to_date('2001-03-09' ,'yyyy/mm/dd') 90),'yyyy-mm-dd' and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 13:32:42: Generating execution metrics for [query_36.sql]..
2018-08-14 13:32:42: Generating execution metrics for [query_37.sql]..
2018-08-14 13:32:42: Generating execution metrics for [query_38.sql]..
2018-08-14 13:33:25: Generating execution metrics for [query_39.sql]..
2018-08-14 13:33:26: Generating execution metrics for [query_40.sql]..
2018-08-14 13:33:26: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between to_char((to_date('2002-03-29' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2002-03-29' ,'yyyy/mm/dd') 60),'yyyy-mm-dd' and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 13:33:26: Generating execution metrics for [query_41.sql]..
2018-08-14 13:33:27: Generating execution metrics for [query_42.sql]..
2018-08-14 13:33:30: Generating execution metrics for [query_43.sql]..
2018-08-14 13:33:33: Generating execution metrics for [query_44.sql]..
2018-08-14 13:33:33: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' < cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' >= cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd' - 30),'yyyy-mm-dd' and (cast ('2001-05-02' ,'yyyy/mm/dd') 30),'yyyy-mm-dd' group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 13:33:33: Generating execution metrics for [query_45.sql]..
2018-08-14 13:33:33: Generating execution metrics for [query_46.sql]..
2018-08-14 13:33:33: Generating execution metrics for [query_47.sql]..
2018-08-14 13:33:34: Generating execution metrics for [query_48.sql]..
2018-08-14 13:33:35: Generating execution metrics for [query_49.sql]..
2018-08-14 13:33:35: Generating execution metrics for [query_50.sql]..
2018-08-14 13:33:36: Generating execution metrics for [query_51.sql]..
2018-08-14 13:33:38: Generating execution metrics for [query_52.sql]..
2018-08-14 13:35:43: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:35:43: Connection pool instantiated with [1] connections
2018-08-14 13:35:46: ('spark.cores.max', '20')
2018-08-14 13:35:46: ('spark.executor.memory', '2g')
2018-08-14 13:35:46: ('spark.app.id', 'app-20180814133545-0062')
2018-08-14 13:35:46: ('spark.executor.id', 'driver')
2018-08-14 13:35:46: ('spark.python.worker.reuse', 'True')
2018-08-14 13:35:46: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:35:46: ('spark.default.parallelism', '80')
2018-08-14 13:35:46: ('spark.driver.port', '9182')
2018-08-14 13:35:46: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:35:46: ('spark.executor.instances', '20')
2018-08-14 13:35:46: ('spark.logConf', 'False')
2018-08-14 13:35:46: ('spark.rdd.compress', 'True')
2018-08-14 13:35:46: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 13:35:46: ('spark.driver.memory', '2g')
2018-08-14 13:35:46: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:35:46: ('spark.executor.cores', '1')
2018-08-14 13:35:46: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:35:46: ('spark.submit.deployMode', 'client')
2018-08-14 13:35:46: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:35:46: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:35:46: ('spark.app.name', 'ICS5200')
2018-08-14 13:35:46: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 13:35:46: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 13:35:46: Successfully finished migrating DML scripts!
2018-08-14 13:35:46: Starting TPC-DS sql splitting
2018-08-14 13:35:46: Generated query_1.sql
2018-08-14 13:35:46: Generated query_2.sql
2018-08-14 13:35:46: Generated query_3.sql
2018-08-14 13:35:46: Generated query_4.sql
2018-08-14 13:35:46: Generated query_5.sql
2018-08-14 13:35:46: Generated query_6.sql
2018-08-14 13:35:46: Generated query_7.sql
2018-08-14 13:35:46: Generated query_8.sql
2018-08-14 13:35:46: Generated query_9.sql
2018-08-14 13:35:46: Generated query_10.sql
2018-08-14 13:35:46: Generated query_11.sql
2018-08-14 13:35:46: Generated query_12.sql
2018-08-14 13:35:46: Generated query_13.sql
2018-08-14 13:35:46: Generated query_14.sql
2018-08-14 13:35:46: Generated query_15.sql
2018-08-14 13:35:46: Generated query_16.sql
2018-08-14 13:35:46: Generated query_17.sql
2018-08-14 13:35:46: Generated query_18.sql
2018-08-14 13:35:46: Generated query_19.sql
2018-08-14 13:35:46: Generated query_20.sql
2018-08-14 13:35:46: Generated query_21.sql
2018-08-14 13:35:46: Generated query_22.sql
2018-08-14 13:35:46: Generated query_23.sql
2018-08-14 13:35:46: Generated query_24.sql
2018-08-14 13:35:46: Generated query_25.sql
2018-08-14 13:35:46: Generated query_26.sql
2018-08-14 13:35:46: Generated query_27.sql
2018-08-14 13:35:46: Generated query_28.sql
2018-08-14 13:35:46: Generated query_29.sql
2018-08-14 13:35:46: Generated query_30.sql
2018-08-14 13:35:46: Generated query_31.sql
2018-08-14 13:35:46: Generated query_32.sql
2018-08-14 13:35:46: Generated query_33.sql
2018-08-14 13:35:46: Generated query_34.sql
2018-08-14 13:35:46: Generated query_35.sql
2018-08-14 13:35:46: Generated query_36.sql
2018-08-14 13:35:46: Generated query_37.sql
2018-08-14 13:35:46: Generated query_38.sql
2018-08-14 13:35:46: Generated query_39.sql
2018-08-14 13:35:46: Generated query_40.sql
2018-08-14 13:35:46: Generated query_41.sql
2018-08-14 13:35:46: Generated query_42.sql
2018-08-14 13:35:46: Generated query_43.sql
2018-08-14 13:35:46: Generated query_44.sql
2018-08-14 13:35:46: Generated query_45.sql
2018-08-14 13:35:46: Generated query_46.sql
2018-08-14 13:35:46: Generated query_47.sql
2018-08-14 13:35:46: Generated query_48.sql
2018-08-14 13:35:46: Generated query_49.sql
2018-08-14 13:35:46: Generated query_50.sql
2018-08-14 13:35:46: Generated query_51.sql
2018-08-14 13:35:46: Generated query_52.sql
2018-08-14 13:35:46: Generated query_53.sql
2018-08-14 13:35:46: Generated query_54.sql
2018-08-14 13:35:46: Generated query_55.sql
2018-08-14 13:35:46: Generated query_56.sql
2018-08-14 13:35:46: Generated query_57.sql
2018-08-14 13:35:46: Generated query_58.sql
2018-08-14 13:35:46: Generated query_59.sql
2018-08-14 13:35:46: Generated query_60.sql
2018-08-14 13:35:46: Generated query_61.sql
2018-08-14 13:35:46: Generated query_62.sql
2018-08-14 13:35:46: Generated query_63.sql
2018-08-14 13:35:46: Generated query_64.sql
2018-08-14 13:35:46: Generated query_65.sql
2018-08-14 13:35:46: Generated query_66.sql
2018-08-14 13:35:46: Generated query_67.sql
2018-08-14 13:35:46: Generated query_68.sql
2018-08-14 13:35:46: Generated query_69.sql
2018-08-14 13:35:46: Generated query_70.sql
2018-08-14 13:35:46: Generated query_71.sql
2018-08-14 13:35:46: Generated query_72.sql
2018-08-14 13:35:46: Generated query_73.sql
2018-08-14 13:35:46: Generated query_74.sql
2018-08-14 13:35:46: Generated query_75.sql
2018-08-14 13:35:46: Generated query_76.sql
2018-08-14 13:35:46: Generated query_77.sql
2018-08-14 13:35:46: Generated query_78.sql
2018-08-14 13:35:46: Generated query_79.sql
2018-08-14 13:35:46: Generated query_80.sql
2018-08-14 13:35:46: Generated query_81.sql
2018-08-14 13:35:46: Generated query_82.sql
2018-08-14 13:35:46: Generated query_83.sql
2018-08-14 13:35:46: Generated query_84.sql
2018-08-14 13:35:46: Generated query_85.sql
2018-08-14 13:35:46: Generated query_86.sql
2018-08-14 13:35:46: Generated query_87.sql
2018-08-14 13:35:46: Generated query_88.sql
2018-08-14 13:35:46: Generated query_89.sql
2018-08-14 13:35:46: Generated query_90.sql
2018-08-14 13:35:46: Generated query_91.sql
2018-08-14 13:35:46: Generated query_92.sql
2018-08-14 13:35:46: Generated query_93.sql
2018-08-14 13:35:46: Generated query_94.sql
2018-08-14 13:35:46: Generated query_95.sql
2018-08-14 13:35:46: Generated query_96.sql
2018-08-14 13:35:46: Generated query_97.sql
2018-08-14 13:35:46: Generated query_98.sql
2018-08-14 13:35:46: Generated query_99.sql
2018-08-14 13:35:46: Generated query_100.sql
2018-08-14 13:35:46: Generated query_101.sql
2018-08-14 13:35:46: Generated query_102.sql
2018-08-14 13:35:46: Generated query_103.sql
2018-08-14 13:35:46: Generated query_104.sql
2018-08-14 13:35:46: Script Complete!
-------------------------------------
2018-08-14 13:35:52: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:35:52: Connection pool instantiated with [1] connections
2018-08-14 13:35:55: ('spark.cores.max', '20')
2018-08-14 13:35:55: ('spark.executor.memory', '2g')
2018-08-14 13:35:55: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:35:55: ('spark.executor.id', 'driver')
2018-08-14 13:35:55: ('spark.python.worker.reuse', 'True')
2018-08-14 13:35:55: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:35:55: ('spark.default.parallelism', '80')
2018-08-14 13:35:55: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:35:55: ('spark.executor.instances', '20')
2018-08-14 13:35:55: ('spark.logConf', 'False')
2018-08-14 13:35:55: ('spark.driver.port', '22664')
2018-08-14 13:35:55: ('spark.rdd.compress', 'True')
2018-08-14 13:35:55: ('spark.driver.memory', '2g')
2018-08-14 13:35:55: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:35:55: ('spark.executor.cores', '1')
2018-08-14 13:35:55: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:35:55: ('spark.submit.deployMode', 'client')
2018-08-14 13:35:55: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:35:55: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:35:55: ('spark.app.id', 'app-20180814133554-0063')
2018-08-14 13:35:55: ('spark.app.name', 'ICS5200')
2018-08-14 13:35:55: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 13:35:55: Generating execution metrics for [query_1.sql]..
2018-08-14 13:35:55: Generating execution metrics for [query_2.sql]..
2018-08-14 13:35:55: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 13:35:56: Generating execution metrics for [query_3.sql]..
2018-08-14 13:35:56: Generating execution metrics for [query_4.sql]..
2018-08-14 13:36:03: Generating execution metrics for [query_5.sql]..
2018-08-14 13:36:03: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd' and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 13:36:03: Generating execution metrics for [query_6.sql]..
2018-08-14 13:36:03: Generating execution metrics for [query_7.sql]..
2018-08-14 13:36:04: Generating execution metrics for [query_8.sql]..
2018-08-14 13:36:04: Generating execution metrics for [query_9.sql]..
2018-08-14 13:36:07: Generating execution metrics for [query_10.sql]..
2018-08-14 13:36:08: Generating execution metrics for [query_11.sql]..
2018-08-14 13:36:11: Generating execution metrics for [query_12.sql]..
2018-08-14 13:36:11: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between to_char((to_date('2001-06-15' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2001-06-15' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:36:11: Generating execution metrics for [query_13.sql]..
2018-08-14 13:36:16: Generating execution metrics for [query_14.sql]..
2018-08-14 13:36:21: Generating execution metrics for [query_15.sql]..
2018-08-14 13:36:21: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 13:36:21: Generating execution metrics for [query_16.sql]..
2018-08-14 13:36:21: Generating execution metrics for [query_17.sql]..
2018-08-14 13:36:21: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and to_char((to_date('2002-4-01' ,'yyyy/mm/dd') + 60),'yyyy-mm-dd' and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 13:36:21: Generating execution metrics for [query_18.sql]..
2018-08-14 13:36:22: Generating execution metrics for [query_19.sql]..
2018-08-14 13:36:22: Generating execution metrics for [query_20.sql]..
2018-08-14 13:36:23: Generating execution metrics for [query_21.sql]..
2018-08-14 13:36:23: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between to_char((to_date('2002-06-18' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2002-06-18' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 13:36:23: Generating execution metrics for [query_22.sql]..
2018-08-14 13:36:23: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' < cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' >= cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd' - 30),'yyyy-mm-dd' and (cast ('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 13:36:23: Generating execution metrics for [query_23.sql]..
2018-08-14 13:36:29: Generating execution metrics for [query_24.sql]..
2018-08-14 13:36:37: Generating execution metrics for [query_25.sql]..
2018-08-14 13:36:46: Generating execution metrics for [query_26.sql]..
2018-08-14 13:36:46: Generating execution metrics for [query_27.sql]..
2018-08-14 13:36:47: Generating execution metrics for [query_28.sql]..
2018-08-14 13:36:47: Generating execution metrics for [query_29.sql]..
2018-08-14 13:36:47: Generating execution metrics for [query_30.sql]..
2018-08-14 13:36:48: Generating execution metrics for [query_31.sql]..
2018-08-14 13:36:50: Generating execution metrics for [query_32.sql]..
2018-08-14 13:36:50: Generating execution metrics for [query_33.sql]..
2018-08-14 13:36:50: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 13:36:50: Generating execution metrics for [query_34.sql]..
2018-08-14 13:36:52: Generating execution metrics for [query_35.sql]..
2018-08-14 13:36:52: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and to_char((to_date('2001-03-09' ,'yyyy/mm/dd') + 90),'yyyy-mm-dd' and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and to_char((to_date('2001-03-09' ,'yyyy/mm/dd') + 90),'yyyy-mm-dd' and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 13:36:52: Generating execution metrics for [query_36.sql]..
2018-08-14 13:36:52: Generating execution metrics for [query_37.sql]..
2018-08-14 13:36:52: Generating execution metrics for [query_38.sql]..
2018-08-14 13:37:48: Generating execution metrics for [query_39.sql]..
2018-08-14 13:37:49: Generating execution metrics for [query_40.sql]..
2018-08-14 13:37:49: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between to_char((to_date('2002-03-29' ,'yyyy/mm/dd'),'yyyy-mm-dd' and to_char((to_date('2002-03-29' ,'yyyy/mm/dd') + 60),'yyyy-mm-dd' and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 13:37:49: Generating execution metrics for [query_41.sql]..
2018-08-14 13:37:49: Generating execution metrics for [query_42.sql]..
2018-08-14 13:37:53: Generating execution metrics for [query_43.sql]..
2018-08-14 13:37:58: Generating execution metrics for [query_44.sql]..
2018-08-14 13:37:58: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' < cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd' >= cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd' - 30),'yyyy-mm-dd' and (cast ('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd' group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 13:37:58: Generating execution metrics for [query_45.sql]..
2018-08-14 13:37:58: Generating execution metrics for [query_46.sql]..
2018-08-14 13:37:58: Generating execution metrics for [query_47.sql]..
2018-08-14 13:37:59: Generating execution metrics for [query_48.sql]..
2018-08-14 13:38:00: Generating execution metrics for [query_49.sql]..
2018-08-14 13:38:00: Generating execution metrics for [query_50.sql]..
2018-08-14 13:38:03: Generating execution metrics for [query_51.sql]..
2018-08-14 13:38:06: Generating execution metrics for [query_52.sql]..
2018-08-14 13:39:44: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:39:44: Connection pool instantiated with [1] connections
2018-08-14 13:39:47: ('spark.cores.max', '20')
2018-08-14 13:39:47: ('spark.executor.memory', '2g')
2018-08-14 13:39:47: ('spark.executor.id', 'driver')
2018-08-14 13:39:47: ('spark.python.worker.reuse', 'True')
2018-08-14 13:39:47: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:39:47: ('spark.default.parallelism', '80')
2018-08-14 13:39:47: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:39:47: ('spark.driver.port', '12861')
2018-08-14 13:39:47: ('spark.executor.instances', '20')
2018-08-14 13:39:47: ('spark.app.id', 'app-20180814133946-0064')
2018-08-14 13:39:47: ('spark.logConf', 'False')
2018-08-14 13:39:47: ('spark.rdd.compress', 'True')
2018-08-14 13:39:47: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 13:39:47: ('spark.driver.memory', '2g')
2018-08-14 13:39:47: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:39:47: ('spark.executor.cores', '1')
2018-08-14 13:39:47: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:39:47: ('spark.submit.deployMode', 'client')
2018-08-14 13:39:47: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:39:47: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:39:47: ('spark.app.name', 'ICS5200')
2018-08-14 13:39:47: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 13:39:47: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 13:39:47: Successfully finished migrating DML scripts!
2018-08-14 13:39:47: Starting TPC-DS sql splitting
2018-08-14 13:39:47: Generated query_1.sql
2018-08-14 13:39:47: Generated query_2.sql
2018-08-14 13:39:47: Generated query_3.sql
2018-08-14 13:39:47: Generated query_4.sql
2018-08-14 13:39:47: Generated query_5.sql
2018-08-14 13:39:47: Generated query_6.sql
2018-08-14 13:39:47: Generated query_7.sql
2018-08-14 13:39:47: Generated query_8.sql
2018-08-14 13:39:47: Generated query_9.sql
2018-08-14 13:39:47: Generated query_10.sql
2018-08-14 13:39:47: Generated query_11.sql
2018-08-14 13:39:47: Generated query_12.sql
2018-08-14 13:39:47: Generated query_13.sql
2018-08-14 13:39:47: Generated query_14.sql
2018-08-14 13:39:47: Generated query_15.sql
2018-08-14 13:39:47: Generated query_16.sql
2018-08-14 13:39:47: Generated query_17.sql
2018-08-14 13:39:47: Generated query_18.sql
2018-08-14 13:39:47: Generated query_19.sql
2018-08-14 13:39:47: Generated query_20.sql
2018-08-14 13:39:47: Generated query_21.sql
2018-08-14 13:39:47: Generated query_22.sql
2018-08-14 13:39:47: Generated query_23.sql
2018-08-14 13:39:47: Generated query_24.sql
2018-08-14 13:39:47: Generated query_25.sql
2018-08-14 13:39:47: Generated query_26.sql
2018-08-14 13:39:47: Generated query_27.sql
2018-08-14 13:39:47: Generated query_28.sql
2018-08-14 13:39:47: Generated query_29.sql
2018-08-14 13:39:47: Generated query_30.sql
2018-08-14 13:39:47: Generated query_31.sql
2018-08-14 13:39:47: Generated query_32.sql
2018-08-14 13:39:47: Generated query_33.sql
2018-08-14 13:39:47: Generated query_34.sql
2018-08-14 13:39:47: Generated query_35.sql
2018-08-14 13:39:47: Generated query_36.sql
2018-08-14 13:39:47: Generated query_37.sql
2018-08-14 13:39:47: Generated query_38.sql
2018-08-14 13:39:47: Generated query_39.sql
2018-08-14 13:39:47: Generated query_40.sql
2018-08-14 13:39:47: Generated query_41.sql
2018-08-14 13:39:47: Generated query_42.sql
2018-08-14 13:39:47: Generated query_43.sql
2018-08-14 13:39:47: Generated query_44.sql
2018-08-14 13:39:47: Generated query_45.sql
2018-08-14 13:39:47: Generated query_46.sql
2018-08-14 13:39:47: Generated query_47.sql
2018-08-14 13:39:47: Generated query_48.sql
2018-08-14 13:39:47: Generated query_49.sql
2018-08-14 13:39:47: Generated query_50.sql
2018-08-14 13:39:47: Generated query_51.sql
2018-08-14 13:39:47: Generated query_52.sql
2018-08-14 13:39:47: Generated query_53.sql
2018-08-14 13:39:47: Generated query_54.sql
2018-08-14 13:39:47: Generated query_55.sql
2018-08-14 13:39:47: Generated query_56.sql
2018-08-14 13:39:47: Generated query_57.sql
2018-08-14 13:39:47: Generated query_58.sql
2018-08-14 13:39:47: Generated query_59.sql
2018-08-14 13:39:47: Generated query_60.sql
2018-08-14 13:39:47: Generated query_61.sql
2018-08-14 13:39:47: Generated query_62.sql
2018-08-14 13:39:47: Generated query_63.sql
2018-08-14 13:39:47: Generated query_64.sql
2018-08-14 13:39:47: Generated query_65.sql
2018-08-14 13:39:47: Generated query_66.sql
2018-08-14 13:39:47: Generated query_67.sql
2018-08-14 13:39:47: Generated query_68.sql
2018-08-14 13:39:47: Generated query_69.sql
2018-08-14 13:39:47: Generated query_70.sql
2018-08-14 13:39:47: Generated query_71.sql
2018-08-14 13:39:47: Generated query_72.sql
2018-08-14 13:39:47: Generated query_73.sql
2018-08-14 13:39:47: Generated query_74.sql
2018-08-14 13:39:47: Generated query_75.sql
2018-08-14 13:39:47: Generated query_76.sql
2018-08-14 13:39:47: Generated query_77.sql
2018-08-14 13:39:47: Generated query_78.sql
2018-08-14 13:39:47: Generated query_79.sql
2018-08-14 13:39:47: Generated query_80.sql
2018-08-14 13:39:47: Generated query_81.sql
2018-08-14 13:39:47: Generated query_82.sql
2018-08-14 13:39:47: Generated query_83.sql
2018-08-14 13:39:47: Generated query_84.sql
2018-08-14 13:39:47: Generated query_85.sql
2018-08-14 13:39:47: Generated query_86.sql
2018-08-14 13:39:47: Generated query_87.sql
2018-08-14 13:39:47: Generated query_88.sql
2018-08-14 13:39:47: Generated query_89.sql
2018-08-14 13:39:47: Generated query_90.sql
2018-08-14 13:39:47: Generated query_91.sql
2018-08-14 13:39:47: Generated query_92.sql
2018-08-14 13:39:47: Generated query_93.sql
2018-08-14 13:39:47: Generated query_94.sql
2018-08-14 13:39:47: Generated query_95.sql
2018-08-14 13:39:47: Generated query_96.sql
2018-08-14 13:39:47: Generated query_97.sql
2018-08-14 13:39:47: Generated query_98.sql
2018-08-14 13:39:47: Generated query_99.sql
2018-08-14 13:39:47: Generated query_100.sql
2018-08-14 13:39:47: Generated query_101.sql
2018-08-14 13:39:47: Generated query_102.sql
2018-08-14 13:39:47: Generated query_103.sql
2018-08-14 13:39:47: Generated query_104.sql
2018-08-14 13:39:47: Script Complete!
-------------------------------------
2018-08-14 13:39:53: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:39:53: Connection pool instantiated with [1] connections
2018-08-14 13:39:56: ('spark.cores.max', '20')
2018-08-14 13:39:56: ('spark.executor.memory', '2g')
2018-08-14 13:39:56: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:39:56: ('spark.executor.id', 'driver')
2018-08-14 13:39:56: ('spark.python.worker.reuse', 'True')
2018-08-14 13:39:56: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:39:56: ('spark.default.parallelism', '80')
2018-08-14 13:39:56: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:39:56: ('spark.executor.instances', '20')
2018-08-14 13:39:56: ('spark.logConf', 'False')
2018-08-14 13:39:56: ('spark.rdd.compress', 'True')
2018-08-14 13:39:56: ('spark.driver.memory', '2g')
2018-08-14 13:39:56: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:39:56: ('spark.executor.cores', '1')
2018-08-14 13:39:56: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:39:56: ('spark.submit.deployMode', 'client')
2018-08-14 13:39:56: ('spark.driver.port', '16414')
2018-08-14 13:39:56: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:39:56: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:39:56: ('spark.app.name', 'ICS5200')
2018-08-14 13:39:56: ('spark.app.id', 'app-20180814133955-0065')
2018-08-14 13:39:56: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 13:39:56: Generating execution metrics for [query_1.sql]..
2018-08-14 13:39:56: Generating execution metrics for [query_2.sql]..
2018-08-14 13:39:56: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 13:39:56: Generating execution metrics for [query_3.sql]..
2018-08-14 13:39:57: Generating execution metrics for [query_4.sql]..
2018-08-14 13:40:04: Generating execution metrics for [query_5.sql]..
2018-08-14 13:40:04: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd') and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd') and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd') and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd') and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char((to_date('2000-08-19' ,'yyyy/mm/dd'),'yyyy-mm-dd') and to_char((to_date('2000-08-19' ,'yyyy/mm/dd') + 14),'yyyy-mm-dd') and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 13:40:04: Generating execution metrics for [query_6.sql]..
2018-08-14 13:40:04: Generating execution metrics for [query_7.sql]..
2018-08-14 13:40:04: Generating execution metrics for [query_8.sql]..
2018-08-14 13:40:05: Generating execution metrics for [query_9.sql]..
2018-08-14 13:41:43: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:41:43: Connection pool instantiated with [1] connections
2018-08-14 13:41:46: ('spark.cores.max', '20')
2018-08-14 13:41:46: ('spark.executor.memory', '2g')
2018-08-14 13:41:46: ('spark.app.id', 'app-20180814134145-0066')
2018-08-14 13:41:46: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 13:41:46: ('spark.executor.id', 'driver')
2018-08-14 13:41:46: ('spark.python.worker.reuse', 'True')
2018-08-14 13:41:46: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:41:46: ('spark.default.parallelism', '80')
2018-08-14 13:41:46: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:41:46: ('spark.executor.instances', '20')
2018-08-14 13:41:46: ('spark.driver.port', '20199')
2018-08-14 13:41:46: ('spark.logConf', 'False')
2018-08-14 13:41:46: ('spark.rdd.compress', 'True')
2018-08-14 13:41:46: ('spark.driver.memory', '2g')
2018-08-14 13:41:46: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:41:46: ('spark.executor.cores', '1')
2018-08-14 13:41:46: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:41:46: ('spark.submit.deployMode', 'client')
2018-08-14 13:41:46: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:41:46: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:41:46: ('spark.app.name', 'ICS5200')
2018-08-14 13:41:46: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 13:41:46: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 13:41:46: Successfully finished migrating DML scripts!
2018-08-14 13:41:46: Starting TPC-DS sql splitting
2018-08-14 13:41:46: Generated query_1.sql
2018-08-14 13:41:46: Generated query_2.sql
2018-08-14 13:41:46: Generated query_3.sql
2018-08-14 13:41:46: Generated query_4.sql
2018-08-14 13:41:46: Generated query_5.sql
2018-08-14 13:41:46: Generated query_6.sql
2018-08-14 13:41:46: Generated query_7.sql
2018-08-14 13:41:46: Generated query_8.sql
2018-08-14 13:41:46: Generated query_9.sql
2018-08-14 13:41:46: Generated query_10.sql
2018-08-14 13:41:46: Generated query_11.sql
2018-08-14 13:41:46: Generated query_12.sql
2018-08-14 13:41:46: Generated query_13.sql
2018-08-14 13:41:46: Generated query_14.sql
2018-08-14 13:41:46: Generated query_15.sql
2018-08-14 13:41:46: Generated query_16.sql
2018-08-14 13:41:46: Generated query_17.sql
2018-08-14 13:41:46: Generated query_18.sql
2018-08-14 13:41:46: Generated query_19.sql
2018-08-14 13:41:46: Generated query_20.sql
2018-08-14 13:41:46: Generated query_21.sql
2018-08-14 13:41:46: Generated query_22.sql
2018-08-14 13:41:46: Generated query_23.sql
2018-08-14 13:41:46: Generated query_24.sql
2018-08-14 13:41:46: Generated query_25.sql
2018-08-14 13:41:46: Generated query_26.sql
2018-08-14 13:41:46: Generated query_27.sql
2018-08-14 13:41:46: Generated query_28.sql
2018-08-14 13:41:46: Generated query_29.sql
2018-08-14 13:41:46: Generated query_30.sql
2018-08-14 13:41:46: Generated query_31.sql
2018-08-14 13:41:46: Generated query_32.sql
2018-08-14 13:41:46: Generated query_33.sql
2018-08-14 13:41:46: Generated query_34.sql
2018-08-14 13:41:46: Generated query_35.sql
2018-08-14 13:41:46: Generated query_36.sql
2018-08-14 13:41:46: Generated query_37.sql
2018-08-14 13:41:46: Generated query_38.sql
2018-08-14 13:41:46: Generated query_39.sql
2018-08-14 13:41:46: Generated query_40.sql
2018-08-14 13:41:46: Generated query_41.sql
2018-08-14 13:41:46: Generated query_42.sql
2018-08-14 13:41:46: Generated query_43.sql
2018-08-14 13:41:46: Generated query_44.sql
2018-08-14 13:41:46: Generated query_45.sql
2018-08-14 13:41:46: Generated query_46.sql
2018-08-14 13:41:46: Generated query_47.sql
2018-08-14 13:41:46: Generated query_48.sql
2018-08-14 13:41:46: Generated query_49.sql
2018-08-14 13:41:46: Generated query_50.sql
2018-08-14 13:41:46: Generated query_51.sql
2018-08-14 13:41:46: Generated query_52.sql
2018-08-14 13:41:46: Generated query_53.sql
2018-08-14 13:41:46: Generated query_54.sql
2018-08-14 13:41:46: Generated query_55.sql
2018-08-14 13:41:46: Generated query_56.sql
2018-08-14 13:41:46: Generated query_57.sql
2018-08-14 13:41:46: Generated query_58.sql
2018-08-14 13:41:46: Generated query_59.sql
2018-08-14 13:41:46: Generated query_60.sql
2018-08-14 13:41:46: Generated query_61.sql
2018-08-14 13:41:46: Generated query_62.sql
2018-08-14 13:41:46: Generated query_63.sql
2018-08-14 13:41:46: Generated query_64.sql
2018-08-14 13:41:46: Generated query_65.sql
2018-08-14 13:41:46: Generated query_66.sql
2018-08-14 13:41:46: Generated query_67.sql
2018-08-14 13:41:46: Generated query_68.sql
2018-08-14 13:41:46: Generated query_69.sql
2018-08-14 13:41:46: Generated query_70.sql
2018-08-14 13:41:46: Generated query_71.sql
2018-08-14 13:41:46: Generated query_72.sql
2018-08-14 13:41:46: Generated query_73.sql
2018-08-14 13:41:46: Generated query_74.sql
2018-08-14 13:41:46: Generated query_75.sql
2018-08-14 13:41:46: Generated query_76.sql
2018-08-14 13:41:46: Generated query_77.sql
2018-08-14 13:41:46: Generated query_78.sql
2018-08-14 13:41:46: Generated query_79.sql
2018-08-14 13:41:46: Generated query_80.sql
2018-08-14 13:41:46: Generated query_81.sql
2018-08-14 13:41:46: Generated query_82.sql
2018-08-14 13:41:46: Generated query_83.sql
2018-08-14 13:41:46: Generated query_84.sql
2018-08-14 13:41:46: Generated query_85.sql
2018-08-14 13:41:46: Generated query_86.sql
2018-08-14 13:41:46: Generated query_87.sql
2018-08-14 13:41:46: Generated query_88.sql
2018-08-14 13:41:46: Generated query_89.sql
2018-08-14 13:41:46: Generated query_90.sql
2018-08-14 13:41:46: Generated query_91.sql
2018-08-14 13:41:46: Generated query_92.sql
2018-08-14 13:41:46: Generated query_93.sql
2018-08-14 13:41:46: Generated query_94.sql
2018-08-14 13:41:46: Generated query_95.sql
2018-08-14 13:41:46: Generated query_96.sql
2018-08-14 13:41:46: Generated query_97.sql
2018-08-14 13:41:46: Generated query_98.sql
2018-08-14 13:41:46: Generated query_99.sql
2018-08-14 13:41:46: Generated query_100.sql
2018-08-14 13:41:46: Generated query_101.sql
2018-08-14 13:41:46: Generated query_102.sql
2018-08-14 13:41:46: Generated query_103.sql
2018-08-14 13:41:46: Generated query_104.sql
2018-08-14 13:41:46: Script Complete!
-------------------------------------
2018-08-14 13:41:50: Connected to database [gabsam] with user [tpcds1]
2018-08-14 13:41:50: Connection pool instantiated with [1] connections
2018-08-14 13:41:52: ('spark.cores.max', '20')
2018-08-14 13:41:52: ('spark.executor.memory', '2g')
2018-08-14 13:41:52: ('spark.executor.id', 'driver')
2018-08-14 13:41:52: ('spark.driver.port', '34053')
2018-08-14 13:41:52: ('spark.python.worker.reuse', 'True')
2018-08-14 13:41:52: ('spark.driver.maxResultSize', '1g')
2018-08-14 13:41:52: ('spark.default.parallelism', '80')
2018-08-14 13:41:52: ('spark.sql.shuffle.partitions', '80')
2018-08-14 13:41:52: ('spark.executor.instances', '20')
2018-08-14 13:41:52: ('spark.logConf', 'False')
2018-08-14 13:41:52: ('spark.rdd.compress', 'True')
2018-08-14 13:41:52: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 13:41:52: ('spark.driver.memory', '2g')
2018-08-14 13:41:52: ('spark.serializer.objectStreamReset', '100')
2018-08-14 13:41:52: ('spark.executor.cores', '1')
2018-08-14 13:41:52: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 13:41:52: ('spark.submit.deployMode', 'client')
2018-08-14 13:41:52: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 13:41:52: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 13:41:52: ('spark.app.id', 'app-20180814134152-0067')
2018-08-14 13:41:52: ('spark.app.name', 'ICS5200')
2018-08-14 13:41:53: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 13:41:53: Generating execution metrics for [query_1.sql]..
2018-08-14 13:41:53: Generating execution metrics for [query_2.sql]..
2018-08-14 13:41:53: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 13:41:53: Generating execution metrics for [query_3.sql]..
2018-08-14 13:41:53: Generating execution metrics for [query_4.sql]..
2018-08-14 13:42:01: Generating execution metrics for [query_5.sql]..
2018-08-14 13:42:10: Generating execution metrics for [query_6.sql]..
2018-08-14 13:42:11: Generating execution metrics for [query_7.sql]..
2018-08-14 13:42:11: Generating execution metrics for [query_8.sql]..
2018-08-14 13:42:11: Generating execution metrics for [query_9.sql]..
2018-08-14 13:42:14: Generating execution metrics for [query_10.sql]..
2018-08-14 13:42:15: Generating execution metrics for [query_11.sql]..
2018-08-14 13:42:17: Generating execution metrics for [query_12.sql]..
2018-08-14 13:42:17: Generating execution metrics for [query_13.sql]..
2018-08-14 13:42:21: Generating execution metrics for [query_14.sql]..
2018-08-14 13:42:26: Generating execution metrics for [query_15.sql]..
2018-08-14 13:42:26: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 13:42:27: Generating execution metrics for [query_16.sql]..
2018-08-14 13:42:27: Generating execution metrics for [query_17.sql]..
2018-08-14 13:42:27: Generating execution metrics for [query_18.sql]..
2018-08-14 13:42:28: Generating execution metrics for [query_19.sql]..
2018-08-14 13:42:28: Generating execution metrics for [query_20.sql]..
2018-08-14 13:42:29: Generating execution metrics for [query_21.sql]..
2018-08-14 13:42:29: Generating execution metrics for [query_22.sql]..
2018-08-14 13:42:29: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (cast ('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 13:42:29: Generating execution metrics for [query_23.sql]..
2018-08-14 13:42:36: Generating execution metrics for [query_24.sql]..
2018-08-14 13:42:46: Generating execution metrics for [query_25.sql]..
2018-08-14 13:42:54: Generating execution metrics for [query_26.sql]..
2018-08-14 13:42:55: Generating execution metrics for [query_27.sql]..
2018-08-14 13:42:55: Generating execution metrics for [query_28.sql]..
2018-08-14 13:42:55: Generating execution metrics for [query_29.sql]..
2018-08-14 13:42:55: Generating execution metrics for [query_30.sql]..
2018-08-14 13:42:56: Generating execution metrics for [query_31.sql]..
2018-08-14 13:42:58: Generating execution metrics for [query_32.sql]..
2018-08-14 13:42:58: Generating execution metrics for [query_33.sql]..
2018-08-14 13:42:58: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 13:42:58: Generating execution metrics for [query_34.sql]..
2018-08-14 13:43:00: Generating execution metrics for [query_35.sql]..
2018-08-14 13:43:01: Generating execution metrics for [query_36.sql]..
2018-08-14 13:43:01: Generating execution metrics for [query_37.sql]..
2018-08-14 13:43:02: Generating execution metrics for [query_38.sql]..
2018-08-14 13:44:08: Generating execution metrics for [query_39.sql]..
2018-08-14 13:44:10: Generating execution metrics for [query_40.sql]..
2018-08-14 13:44:10: Generating execution metrics for [query_41.sql]..
2018-08-14 13:44:11: Generating execution metrics for [query_42.sql]..
2018-08-14 13:44:16: Generating execution metrics for [query_43.sql]..
2018-08-14 13:44:20: Generating execution metrics for [query_44.sql]..
2018-08-14 13:44:20: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (cast ('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 13:44:20: Generating execution metrics for [query_45.sql]..
2018-08-14 13:44:20: Generating execution metrics for [query_46.sql]..
2018-08-14 13:44:21: Generating execution metrics for [query_47.sql]..
2018-08-14 13:44:21: Generating execution metrics for [query_48.sql]..
2018-08-14 13:44:22: Generating execution metrics for [query_49.sql]..
2018-08-14 13:44:22: Generating execution metrics for [query_50.sql]..
2018-08-14 13:44:24: Generating execution metrics for [query_51.sql]..
2018-08-14 13:44:27: Generating execution metrics for [query_52.sql]..
2018-08-14 14:08:29: Generating execution metrics for [query_53.sql]..
2018-08-14 14:08:32: Generating execution metrics for [query_54.sql]..
2018-08-14 14:08:32: Generating execution metrics for [query_55.sql]..
2018-08-14 14:08:34: Generating execution metrics for [query_56.sql]..
2018-08-14 14:08:34: Generating execution metrics for [query_57.sql]..
2018-08-14 14:08:34: Generating execution metrics for [query_58.sql]..
2018-08-14 14:08:35: Generating execution metrics for [query_59.sql]..
2018-08-14 14:08:35: Generating execution metrics for [query_60.sql]..
2018-08-14 14:08:35: Generating execution metrics for [query_61.sql]..
2018-08-14 14:08:35: Generating execution metrics for [query_62.sql]..
2018-08-14 14:08:36: Generating execution metrics for [query_63.sql]..
2018-08-14 14:08:38: Generating execution metrics for [query_64.sql]..
2018-08-14 14:08:38: Generating execution metrics for [query_65.sql]..
2018-08-14 14:08:38: Generating execution metrics for [query_66.sql]..
2018-08-14 14:08:38: Generating execution metrics for [query_67.sql]..
2018-08-14 14:08:39: Generating execution metrics for [query_68.sql]..
2018-08-14 14:08:39: Generating execution metrics for [query_69.sql]..
2018-08-14 14:08:41: Generating execution metrics for [query_70.sql]..
2018-08-14 14:08:42: Generating execution metrics for [query_71.sql]..
2018-08-14 14:08:46: Generating execution metrics for [query_72.sql]..
2018-08-14 14:08:46: Generating execution metrics for [query_73.sql]..
2018-08-14 14:08:53: Generating execution metrics for [query_74.sql]..
2018-08-14 14:08:54: Generating execution metrics for [query_75.sql]..
2018-08-14 14:08:54: Generating execution metrics for [query_76.sql]..
2018-08-14 14:08:55: Skipped DML instruction due to following exception: [ORA-01722: invalid number] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_desc ,w_warehouse_name ,d1.d_week_seq ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo ,sum(case when p_promo_sk is not null then 1 else 0 end) promo ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand < cs_quantity and d3.d_date > d1.d_date + 5 and hd_buy_potential = '501-1000' and d1.d_year = 1999 and cd_marital_status = 'D' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq ) where rownum <= 100 ]
2018-08-14 14:08:55: Generating execution metrics for [query_77.sql]..
2018-08-14 14:08:55: Generating execution metrics for [query_78.sql]..
2018-08-14 14:08:57: Generating execution metrics for [query_79.sql]..
2018-08-14 14:08:59: Generating execution metrics for [query_80.sql]..
2018-08-14 14:08:59: Generating execution metrics for [query_81.sql]..
2018-08-14 14:09:00: Generating execution metrics for [query_82.sql]..
2018-08-14 14:09:03: Generating execution metrics for [query_83.sql]..
2018-08-14 14:09:03: Generating execution metrics for [query_84.sql]..
2018-08-14 14:09:03: Generating execution metrics for [query_85.sql]..
2018-08-14 14:09:03: Generating execution metrics for [query_86.sql]..
2018-08-14 14:09:04: Generating execution metrics for [query_87.sql]..
2018-08-14 14:09:04: Generating execution metrics for [query_88.sql]..
2018-08-14 14:09:05: Generating execution metrics for [query_89.sql]..
2018-08-14 14:09:05: Generating execution metrics for [query_90.sql]..
2018-08-14 14:09:05: Generating execution metrics for [query_91.sql]..
2018-08-14 14:09:05: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) ) cool_cust ]
2018-08-14 14:09:05: Generating execution metrics for [query_92.sql]..
2018-08-14 14:09:07: Generating execution metrics for [query_93.sql]..
2018-08-14 14:09:07: Generating execution metrics for [query_94.sql]..
2018-08-14 14:09:07: Skipped DML instruction due to following exception: [ORA-01476: divisor is equal to zero] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 7 and 7+1 and household_demographics.hd_dep_count = 6 and web_page.wp_char_count between 5000 and 5200) at, ( select count(*) pmc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 20 and 20+1 and household_demographics.hd_dep_count = 6 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio ) where rownum <= 100 ]
2018-08-14 14:09:07: Generating execution metrics for [query_95.sql]..
2018-08-14 14:09:08: Generating execution metrics for [query_96.sql]..
2018-08-14 14:09:08: Generating execution metrics for [query_97.sql]..
2018-08-14 14:09:08: Generating execution metrics for [query_98.sql]..
2018-08-14 14:09:08: Generating execution metrics for [query_99.sql]..
2018-08-14 14:09:08: Generating execution metrics for [query_100.sql]..
2018-08-14 14:09:09: Generating execution metrics for [query_101.sql]..
2018-08-14 14:09:10: Generating execution metrics for [query_102.sql]..
2018-08-14 14:09:10: Generating execution metrics for [query_103.sql]..
2018-08-14 14:09:10: Generating execution metrics for [query_104.sql]..
2018-08-14 14:09:10: Skipped DML instruction due to following exception: [ORA-24373: invalid length specified for statement] - Instruction: [ ]
2018-08-14 14:09:10: Generating execution metrics for [catv_up.sql]..
2018-08-14 14:09:10: Skipped DML instruction due to following exception: [ORA-00923: FROM keyword not found where expected] - Instruction: [ create /*ICS5200_MONITOR_HINT*/ table s_catalog_page as (select CP_CATALOG_NUMBER cpag_catalog_number ,CP_CATALOG_PAGE_NUMBER cpag_catalog_page_number ,CP_DEPARTMENT cpag_department ]
2018-08-14 14:09:10: Generating execution metrics for [ccv_up.sql]..
2018-08-14 14:09:10: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_call_center; create table s_call_center as (select cc_call_center_id call_center_id ,d1.d_date call_open_date ,d2.d_date call_closed_date ,cc_name call_center_name ,cc_class call_center_class ,cc_employees call_center_employees ,cc_sq_ft call_center_sq_ft ,CC_HOURS call_center_hours ,CC_MANAGER call_center_manager ,CC_TAX_PERCENTAGE call_tax_percentage from call_center left outer join date_dim d2 on CC_CLOSED_DATE_SK = d2.d_date_sk left outer join date_dim d1 on CC_OPEN_DATE_SK = d1.d_date_sk where cc_rec_end_date is NULL -- need this to avoid duplicates and rownum < 5 ); ]
2018-08-14 14:09:10: Generating execution metrics for [custv_up.sql]..
2018-08-14 14:09:10: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_customer; create table s_customer as (select C_CUSTOMER_ID CUST_CUSTOMER_ID ,C_SALUTATION CUST_SALUTATION ,C_LAST_NAME CUST_LAST_NAME ,C_FIRST_NAME CUST_FIRST_NAME ,C_PREFERRED_CUST_FLAG CUST_PREFFERED_FLAG ,d3.d_date CUST_BIRTH_DATE ,C_BIRTH_COUNTRY CUST_BIRTH_COUNTRY ,C_LOGIN CUST_LOGIN_ID ,C_EMAIL_ADDRESS CUST_EMAIL_ADDRESS ,d1.d_date CUST_FIRST_SHIPTO_DATE ,d2.d_date CUST_FIRST_PURCHASE_DATE ,C_LAST_REVIEW_DATE CUST_LAST_REVIEW_DATE ,CA_STREET_NUMBER CUST_STREET_NUMBER ,CA_SUITE_NUMBER CUST_SUITE_NUMBER ,CA_STREET_NAME CUST_STREET_NAME1 ,CA_STREET_NAME CUST_STREET_NAME2 ,CA_STREET_TYPE CUST_STREET_TYPE ,CA_CITY CUST_CITY ,CA_ZIP CUST_ZIP ,CA_COUNTY CUST_COUNTY ,CA_STATE CUST_STATE ,CA_COUNTRY CUST_COUNTRY ,CA_LOCATION_TYPE CUST_LOC_TYPE ,CD_GENDER CUST_GENDER_CODE ,CD_MARITAL_STATUS CUST_MARITAL_STATUS ,CD_EDUCATION_STATUS CUST_EDUC_STATUS ,CD_CREDIT_RATING CUST_CREDIT_RATING ,CD_PURCHASE_ESTIMATE CUST_PURCH_EST ,HD_BUY_POTENTIAL CUST_BUY_POTENTIAL ,HD_DEP_COUNT CUST_DEPEND_CNT ,CD_DEP_EMPLOYED_COUNT CUST_DEPEND_EMP_CNT ,CD_DEP_COLLEGE_COUNT CUST_DEPEND_COLLEGE_CNT ,HD_VEHICLE_COUNT CUST_VEHICLE_CNT ,IB_LOWER_BOUND+800 CUST_ANNUAL_INCOME from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,date_dim d1 ,date_dim d2 ,date_dim d3 where c_current_addr_sk = ca_address_sk and d1.d_date_sk = C_FIRST_SHIPTO_DATE_SK and d2.d_date_sk = C_FIRST_SALES_DATE_SK and extract (day from d3.d_date) = c_birth_day and extract (month from d3.d_date) = c_birth_month and extract (year from d3.d_date) = c_birth_year and C_CURRENT_CDEMO_SK = cd_demo_sk and C_CURRENT_HDEMO_SK = hd_demo_sk and HD_INCOME_BAND_SK = IB_INCOME_BAND_SK and rownum < 1000 ); ]
2018-08-14 14:09:10: Generating execution metrics for [dm_c.sql]..
2018-08-14 14:09:10: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; BEGIN FOR c_rec IN (SELECT C_CUSTOMER_ID ,C_CURRENT_CDEMO_SK ,C_CURRENT_HDEMO_SK ,C_CURRENT_ADDR_SK ,C_FIRST_SHIPTO_DATE_SK ,C_FIRST_SALES_DATE_SK ,C_SALUTATION ,C_FIRST_NAME ,C_LAST_NAME ,C_PREFERRED_CUST_FLAG ,C_BIRTH_DAY ,C_BIRTH_MONTH ,C_BIRTH_YEAR ,C_BIRTH_COUNTRY ,C_LOGIN ,C_EMAIL_ADDRESS ,C_LAST_REVIEW_DATE from custv) LOOP update customer set C_CUSTOMER_ID=c_rec.C_CUSTOMER_ID ,C_CURRENT_CDEMO_SK=c_rec.C_CURRENT_CDEMO_SK ,C_CURRENT_HDEMO_SK=c_rec.C_CURRENT_HDEMO_SK ,C_CURRENT_ADDR_SK=c_rec.C_CURRENT_ADDR_SK ,C_FIRST_SHIPTO_DATE_SK=c_rec.C_FIRST_SHIPTO_DATE_SK ,C_FIRST_SALES_DATE_SK=c_rec.C_FIRST_SALES_DATE_SK ,C_SALUTATION=c_rec.C_SALUTATION ,C_FIRST_NAME=c_rec.C_FIRST_NAME ,C_LAST_NAME=c_rec.C_LAST_NAME ,C_PREFERRED_CUST_FLAG=c_rec.C_PREFERRED_CUST_FLAG ,C_BIRTH_DAY=c_rec.C_BIRTH_DAY ,C_BIRTH_MONTH=c_rec.C_BIRTH_MONTH ,C_BIRTH_YEAR=c_rec.C_BIRTH_YEAR ,C_BIRTH_COUNTRY=c_rec.C_BIRTH_COUNTRY ,C_LOGIN=c_rec.C_LOGIN ,C_EMAIL_ADDRESS=c_rec.C_EMAIL_ADDRESS ,C_LAST_REVIEW_DATE=c_rec.C_LAST_REVIEW_DATE where c_customer_id=c_rec.c_customer_id; END LOOP; commit; END; . run; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_c_t.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table custv; create table custv as select cust_customer_id c_customer_id ,cd_demo_sk c_current_cdemo_sk ,hd_demo_sk c_current_hdemo_sk ,ca_address_sk c_current_addr_sk ,d1.d_date_sk c_first_shipto_date_sk ,d2.d_date_sk c_first_sales_date_sk ,cust_salutation c_salutation ,cust_first_name c_first_name ,cust_last_name c_last_name ,cust_preffered_flag c_preferred_cust_flag ,extract(day from cast(cust_birth_date as date)) c_birth_day ,extract(month from cast(cust_birth_date as date)) c_birth_month ,extract(year from cast(cust_birth_date as date)) c_birth_year ,cust_birth_country c_birth_country ,cust_login_id c_login ,cust_email_address c_email_address ,cust_last_review_date c_last_review_date from s_customer_m left outer join customer on (c_customer_id=cust_customer_id) left outer join customer_address on (c_current_addr_sk = ca_address_sk) ,customer_demographics ,household_demographics ,income_band ib ,date_dim d1 ,date_dim d2 where cust_gender = cd_gender and cust_marital_status = cd_marital_status and cust_educ_status = cd_education_status and cust_purch_est = cd_purchase_estimate and cust_credit_rating = cd_credit_rating and cust_depend_cnt = cd_dep_count and cust_depend_emp_cnt = cd_dep_employed_count and cust_depend_college_cnt = cd_dep_college_count and round(cust_annual_income, 0) between ib.ib_lower_bound and ib.ib_upper_bound and hd_income_band_sk = ib_income_band_sk and cust_buy_potential = hd_buy_potential and cust_depend_cnt= hd_dep_count and cust_vehicle_cnt = hd_vehicle_count and d1.d_date = cust_first_purchase_date and d2.d_date = cust_first_shipto_date ; select count(*) from s_customer_m; select count(*) from custv; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_ca.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR ca_rec IN (SELECT CA_ADDRESS_ID ,CA_STREET_NUMBER ,CA_STREET_NAME ,CA_STREET_TYPE ,CA_SUITE_NUMBER ,CA_CITY ,CA_COUNTY ,CA_STATE ,CA_ZIP ,CA_COUNTRY ,CA_GMT_OFFSET ,CA_LOCATION_TYPE from cadrv) LOOP update customer_address set CA_STREET_NUMBER=ca_rec.CA_STREET_NUMBER ,CA_STREET_NAME=ca_rec.CA_STREET_NAME ,CA_STREET_TYPE=ca_rec.CA_STREET_TYPE ,CA_SUITE_NUMBER=ca_rec.CA_SUITE_NUMBER ,CA_CITY=ca_rec.CA_CITY ,CA_COUNTY=ca_rec.CA_COUNTY ,CA_STATE=ca_rec.CA_STATE ,CA_ZIP=ca_rec.CA_ZIP ,CA_COUNTRY=ca_rec.CA_COUNTRY ,CA_GMT_OFFSET=ca_rec.CA_GMT_OFFSET ,CA_LOCATION_TYPE=ca_rec.CA_LOCATION_TYPE where CA_ADDRESS_ID=ca_rec.CA_ADDRESS_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_ca_t.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table cadrv; create table cadrv as select ca_address_id ca_address_id ,cust_street_number ca_street_number ,concat(concat(rtrim(cust_street_name1),' '),rtrim(cust_street_name2)) ca_street_name ,cust_street_type ca_street_type ,cust_suite_number ca_suite_number ,cust_city ca_city ,cust_county ca_county ,cust_state ca_state ,cust_zip ca_zip ,cust_country ca_country ,zipg_gmt_offset ca_gmt_offset ,cust_loc_type ca_location_type from s_customer_m ,customer ,customer_address ,s_zip_to_gmt_m where cust_zip = zipg_zip and cust_customer_id = c_customer_id and c_current_addr_sk = ca_address_sk; select count(*) from s_customer_m; select count(*) from cadrv; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_ca_v.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ view cadrv; create view cadrv as select cust_customer_id ,cust_street_number ,concat(cust_street_name1,cust_street_name2) street ,cust_street_type ,cust_suite_number ,cust_city ,cust_county ,cust_state ,cust_zip ,cust_country ,zipg_gmt_offset from s_customer_m ,s_zip_to_gmt where cust_zip = zipg_zip; select count(*) from s_customer_m; select count(*) from cadrv; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_cc.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ call_center set cc_rec_end_date = sysdate where cc_call_center_id in (select cc_call_center_id from call_center) and cc_rec_end_date is NULL; insert into call_center(select * from ccv); ]
2018-08-14 14:09:11: Generating execution metrics for [dm_cc_s.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE item_seq; SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(cc_call_center_sk)+1 INTO max_sk FROM call_center; dbms_output.put_line('max call center sk '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE callcenter_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_cc_t.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table ccv; create table CCV as select callcenter_seq.nextval cc_call_center_sk ,call_center_id cc_call_center_id ,sysdate cc_rec_start_date ,cast(NULL as date) cc_rec_end_date ,d1.d_date_sk cc_closed_date_sk ,d2.d_date_sk cc_open_date_sk ,call_center_name cc_name ,call_center_class cc_class ,call_center_employees cc_employees ,call_center_sq_ft cc_sq_ft ,call_center_hours cc_hours ,call_center_manager cc_manager ,cc_mkt_id ,cc_mkt_class ,cc_mkt_desc ,cc_market_manager ,cc_division ,cc_division_name ,cc_company ,cc_company_name ,cc_street_number ,cc_street_name ,cc_street_type ,cc_suite_number ,cc_city ,cc_county ,cc_state ,cc_zip ,cc_country ,cc_gmt_offset ,call_center_tax_percentage cc_tax_percentage from s_call_center_m left outer join date_dim d2 on d2.d_date = cast(call_closed_date as date) left outer join date_dim d1 on d1.d_date = cast(call_open_date as date), call_center where call_center_id = cc_call_center_id and cc_rec_end_date is null; select count(*) from s_call_center_m; select count(*) from ccv; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_cp.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR cp_rec IN (SELECT CP_CATALOG_PAGE_ID ,CP_START_DATE_SK ,CP_END_DATE_SK ,CP_DEPARTMENT ,CP_CATALOG_NUMBER ,CP_DESCRIPTION ,CP_TYPE FROM catv) LOOP update catalog_page set CP_CATALOG_PAGE_ID=cp_rec.CP_CATALOG_PAGE_ID ,CP_START_DATE_SK=cp_rec.CP_START_DATE_SK ,CP_END_DATE_SK=cp_rec.CP_END_DATE_SK ,CP_DEPARTMENT=cp_rec.CP_DEPARTMENT ,CP_CATALOG_NUMBER=cp_rec.CP_CATALOG_NUMBER ,CP_DESCRIPTION=cp_rec.CP_DESCRIPTION ,CP_TYPE=cp_rec.CP_TYPE where CP_CATALOG_PAGE_ID=cp_rec.CP_CATALOG_PAGE_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:09:11: Generating execution metrics for [dm_cp_t.sql]..
2018-08-14 14:09:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table catv; create table catv as select cpag_id cp_catalog_page_id ,startd.d_date_sk cp_start_date_sk ,endd.d_date_sk cp_end_date_sk ,cpag_department cp_department ,cpag_catalog_number cp_catalog_number ,cpag_description cp_description ,cpag_type cp_type from s_catalog_page ,date_dim startd ,date_dim endd where cpag_start_date = startd.d_date and cpag_end_date = endd.d_date; select count(*) from catv; select count(*) from s_catalog_page; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_i.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ item set i_rec_end_date = sysdate where i_item_id in (select i_item_id from itemv) and i_rec_end_date is NULL; insert into item (select * from itemv); ]
2018-08-14 14:09:12: Generating execution metrics for [dm_i_s.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE item_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(i_item_sk)+1 INTO max_sk FROM item; dbms_output.put_line('max item sk '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE item_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_i_t.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table itemv; create table itemv as select item_seq.nextVal i_item_sk ,item_item_id i_item_id ,sysdate i_rec_start_date ,cast(NULL as date) i_rec_end_date ,item_item_description i_item_desc ,item_list_price i_current_price ,item_wholesale_cost i_wholesalecost ,i_brand_id ,i_brand ,i_class_id ,i_class ,i_category_id ,i_category ,i_manufact_id ,i_manufact ,item_size i_size ,item_formulation i_formulation ,item_color i_color ,item_units i_units ,item_container i_container ,item_manager_id i_manager ,i_product_name from s_item_m, item where item_item_id = i_item_id and i_rec_end_date is null; select count(*) from s_item_m; select count(*) from itemv; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_p.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ count(*) from promv; select count(*) from promv s,promotion d where s.P_PROMO_ID=d.P_PROMO_ID; SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR p_rec IN (SELECT P_PROMO_ID ,P_START_DATE_SK ,P_END_DATE_SK ,P_COST ,P_RESPONSE_TARGET ,P_PROMO_NAME ,P_CHANNEL_DMAIL ,P_CHANNEL_EMAIL ,P_CHANNEL_CATALOG ,P_CHANNEL_TV ,P_CHANNEL_RADIO ,P_CHANNEL_PRESS ,P_CHANNEL_EVENT ,P_CHANNEL_DEMO ,P_CHANNEL_DETAILS ,P_PURPOSE ,P_DISCOUNT_ACTIVE FROM promv) LOOP update promotion set P_END_DATE_SK=p_rec.P_END_DATE_SK ,P_COST=p_rec.P_COST ,P_RESPONSE_TARGET=p_rec.P_RESPONSE_TARGET ,P_PROMO_NAME=p_rec.P_PROMO_NAME ,P_CHANNEL_DMAIL=p_rec.P_CHANNEL_DMAIL ,P_CHANNEL_EMAIL=p_rec.P_CHANNEL_EMAIL ,P_CHANNEL_CATALOG=p_rec.P_CHANNEL_CATALOG ,P_CHANNEL_TV=p_rec.P_CHANNEL_TV ,P_CHANNEL_RADIO=p_rec.P_CHANNEL_RADIO ,P_CHANNEL_PRESS=p_rec.P_CHANNEL_PRESS ,P_CHANNEL_EVENT=p_rec.P_CHANNEL_EVENT ,P_CHANNEL_DEMO=p_rec.P_CHANNEL_DEMO ,P_CHANNEL_DETAILS=p_rec.P_CHANNEL_DETAILS ,P_PURPOSE=p_rec.P_PURPOSE ,P_DISCOUNT_ACTIVE=p_rec.P_DISCOUNT_ACTIVE where P_PROMO_ID=p_rec.P_PROMO_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_p_t.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table promv; create table promv as select prom_promotion_id p_promo_id ,d1.d_date_sk p_start_date_sk ,d2.d_date_sk p_end_date_sk ,prom_cost p_cost ,prom_response_target p_response_target ,prom_promotion_name p_promo_name ,prom_channel_dmail p_channel_dmail ,prom_channel_email p_channel_email ,prom_channel_catalog p_channel_catalog ,prom_channel_tv p_channel_tv ,prom_channel_radio p_channel_radio ,prom_channel_press p_channel_press ,prom_channel_event p_channel_event ,prom_channel_demo p_channel_demo ,prom_channel_details p_channel_details ,prom_purpose p_purpose ,prom_discount_active p_discount_active from s_promotion_m left outer join date_dim d1 on prom_start_date = d1.d_date left outer join date_dim d2 on prom_end_date = d2.d_date; select count(*) from s_promotion_m; select count(*) from promv; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_s.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ store set s_rec_end_date = sysdate where s_store_id in (select s_store_id from storv) and s_rec_end_date is NULL; insert into store (select * from storv); ]
2018-08-14 14:09:12: Generating execution metrics for [dm_s_s.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE store_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(s_store_sk)+1 INTO max_sk FROM store; dbms_output.put_line('max store sk '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE store_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_s_t.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table storv; create table storv as select store_seq.nextVal s_store_sk ,stor_store_id s_store_id ,sysdate s_rec_start_date ,cast(NULL as date) s_rec_end_date ,d1.d_date_sk s_closed_date_sk ,stor_name s_store_name ,stor_employees s_number_employees ,stor_floor_space s_floor_space ,stor_hours s_hours ,stor_store_manager s_manager ,stor_market_id s_market_id ,stor_geography_class s_geography_class ,s_market_desc ,stor_market_manager s_market_manager ,s_division_id ,s_division_name ,s_company_id ,s_company_name ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip ,s_country ,s_gmt_offset ,stor_tax_percentage s_tax_percentage from s_store_m left outer join date_dim d1 on TO_DATE(stor_closed_date,'YYYY-MM-DD')= d1.d_date ,store where stor_store_id = s_store_id and s_rec_end_date is null; select 's_store_m '||count(*) from s_store_m; select 's_storv '||count(*) from storv; select 'null date_dim '||count(*) from storv where s_closed_date_sk is null; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_w.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR w_rec IN (SELECT W_WAREHOUSE_ID ,W_WAREHOUSE_NAME ,W_WAREHOUSE_SQ_FT ,W_STREET_NUMBER ,W_STREET_NAME ,W_STREET_TYPE ,W_SUITE_NUMBER ,W_CITY ,W_COUNTY ,W_STATE ,W_ZIP ,W_COUNTRY ,W_GMT_OFFSET FROM wrhsv) LOOP update warehouse set W_WAREHOUSE_NAME=w_rec.W_WAREHOUSE_NAME ,W_WAREHOUSE_SQ_FT=w_rec.W_WAREHOUSE_SQ_FT ,W_STREET_NUMBER=w_rec.W_STREET_NUMBER ,W_STREET_NAME=w_rec.W_STREET_NAME ,W_STREET_TYPE=w_rec.W_STREET_TYPE ,W_SUITE_NUMBER=w_rec.W_SUITE_NUMBER ,W_CITY=w_rec.W_CITY ,W_COUNTY=w_rec.W_COUNTY ,W_STATE=w_rec.W_STATE ,W_ZIP=w_rec.W_ZIP ,W_COUNTRY=w_rec.W_COUNTRY ,W_GMT_OFFSET=w_rec.W_GMT_OFFSET where W_WAREHOUSE_ID=w_rec.W_WAREHOUSE_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:09:12: Generating execution metrics for [dm_w_t.sql]..
2018-08-14 14:09:12: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table wrhsv; create table wrhsv as select wrhs_warehouse_id w_warehouse_id ,wrhs_warehouse_desc w_warehouse_name ,wrhs_warehouse_sq_ft w_warehouse_sq_ft ,w_street_number ,w_street_name ,w_street_type ,w_suite_number ,w_city ,w_county ,w_state ,w_zip ,w_country ,w_gmt_offset from s_warehouse_m, warehouse where wrhs_warehouse_id = w_warehouse_id; select count(*) from s_warehouse_m; select count(*) from wrhsv; ]
2018-08-14 14:09:13: Generating execution metrics for [dm_wp.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ web_page set wp_rec_end_date = sysdate where wp_web_page_id in (select wp_web_page_id from webv) and wp_rec_end_date is NULL; insert into web_page (select * from webv); ]
2018-08-14 14:09:13: Generating execution metrics for [dm_wp_s.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE web_page_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(WP_WEB_PAGE_SK)+1 INTO max_sk FROM web_page; dbms_output.put_line('max WP_WEB_PAGE_SK '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE web_page_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:09:13: Generating execution metrics for [dm_wp_t.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table webv; create table webv as select web_page_seq.nextVal wp_web_page_sk ,wpag_web_page_id wp_web_page_id ,sysdate wp_rec_start_date ,cast(null as date) wp_rec_end_date ,d1.d_date_sk wp_creation_date_sk ,d2.d_date_sk wp_access_date_sk ,wpag_autogen_flag wp_autogen_flag ,wpag_url wp_url ,wpag_type wp_type ,wpag_char_cnt wp_char_count ,wpag_link_cnt wp_link_count ,wpag_image_cnt wp_image_count ,wpag_max_ad_cnt wp_max_ad_count from s_web_page_m left outer join date_dim d1 on wpag_create_date = d1.d_date left outer join date_dim d2 on wpag_access_date = d2.d_date; select count(*) from s_web_page; select count(*) from webv; ]
2018-08-14 14:09:13: Generating execution metrics for [dm_ws.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ web_site set web_rec_end_date = sysdate where web_site_id in (select web_site_id from websv) and web_rec_end_date is NULL; insert into web_site (select * from websv); rollback; ]
2018-08-14 14:09:13: Generating execution metrics for [dm_ws_s.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE web_site_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(web_site_sk)+1 INTO max_sk FROM web_site; dbms_output.put_line('max web_site_sk'||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE web_site_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:09:13: Generating execution metrics for [dm_ws_t.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table websv; create table websv as select web_site_seq.nextVal web_site_sk ,wsit_web_site_id web_site_id ,sysdate web_rec_start_date ,cast(null as date) web_rec_end_date ,wsit_site_name web_name ,d1.d_date_sk web_open_date_sk ,d2.d_date_sk web_close_date_sk ,wsit_site_class web_class ,wsit_site_manager web_manager ,web_mkt_id ,web_mkt_class ,web_mkt_desc ,web_market_manager ,web_company_id ,web_company_name ,web_street_number ,web_street_name ,web_street_type ,web_suite_number ,web_city ,web_county ,web_state ,web_zip ,web_country ,web_gmt_offset ,wsit_tax_percentage web_tax_percentage from s_web_site_m left outer join date_dim d1 on (d1.d_date = wsit_open_date) left outer join date_dim d2 on (d2.d_date = wsit_closed_date), web_site where web_site_id = wsit_web_site_id and web_rec_end_date is null; select count(*) from s_web_site_m; select count(*) from websv; ]
2018-08-14 14:09:13: Generating execution metrics for [itemv_up.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_item; create table s_item as (select i_item_id item_item_id ,i_item_desc item_item_description ,i_current_price item_list_price ,i_wholesale_cost item_wholesale_cost ,i_manager_id item_manager_id ,i_size item_size ,i_formulation item_formulation ,i_color item_color ,i_units item_units ,i_container item_container from item where i_rec_end_date is null and rownum < 1000); -- I need the following statement because of a bug in dbgen that generates some duplicates in item delete from s_item where item_item_id in (select ITEM_ITEM_ID from (select ITEM_ITEM_ID ,count(*) cnt from s_item group by ITEM_ITEM_ID) where cnt > 1); ]
2018-08-14 14:09:13: Generating execution metrics for [iv_up.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_inventory; create table s_inventory as (select w_warehouse_id invn_warehouse_id ,i_item_id invn_item_id ,d_date invn_date ,inv_quantity_on_hand invn_qty_on_hand from inventory ,warehouse ,item ,date_dim where inv_warehouse_sk = w_warehouse_sk and inv_item_sk = i_item_sk and i_rec_end_date is null and inv_date_sk = d_date_sk and d_year = 2001 and d_dom between 10 and 15 ); delete from s_inventory where (invn_warehouse_id,invn_item_id,invn_date) in (select invn_warehouse_id,invn_item_id,invn_date from (select invn_warehouse_id,invn_item_id,invn_date,count(*) from s_inventory group by invn_warehouse_id,invn_item_id,invn_date having count(*) > 1)); ]
2018-08-14 14:09:13: Generating execution metrics for [lf_cr.sql]..
2018-08-14 14:09:13: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into catalog_returns (select * from crv); rollback; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_cr_t.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table crv; --update call_center set CC_REC_END_date = null where CC_CALL_CENTER_SK in (3,6); update s_catalog_returns_m set cret_return_date = null where cret_return_date like '%-47%'; create table crv as select d_date_sk cr_return_date_sk ,t_time_sk cr_return_time_sk ,0 CR_SHIP_DATE_SK ,i_item_sk cr_item_sk ,c1.c_customer_sk cr_refunded_customer_sk ,c1.c_current_cdemo_sk cr_refunded_cdemo_sk ,c1.c_current_hdemo_sk cr_refunded_hdemo_sk ,c1.c_current_addr_sk cr_refunded_addr_sk ,c2.c_customer_sk cr_returning_customer_sk ,c2.c_current_cdemo_sk cr_returning_cdemo_sk ,c2.c_current_hdemo_sk cr_returning_hdemo_sk ,c2.c_current_addr_sk cr_returing_addr_sk ,cc_call_center_sk cr_call_center_sk ,0 CR_CATALOG_PAGE_SK ,0 CR_SHIP_MODE_SK ,0 CR_WAREHOUSE_SK ,r_reason_sk cr_reason_sk ,cret_order_id cr_order_number ,cret_return_qty cr_return_quantity ,cret_return_amt cr_return_amt ,cret_return_tax cr_return_tax ,cret_return_amt + cret_return_tax as cr_return_amt_inc_tax ,cret_return_fee cr_fee ,cret_return_ship_cost cr_return_ship_cost ,cret_refunded_cash cr_refunded_cash ,cret_reversed_charge cr_reversed_charde ,cret_merchant_credit cr_merchant_credit ,cret_return_amt+cret_return_tax+cret_return_fee -cret_refunded_cash-cret_reversed_charge-cret_merchant_credit cr_net_loss from s_catalog_returns_m left outer join date_dim on (to_date(cret_return_date,'YYYY-MM-DD') = d_date) left outer join time_dim on (( cast(substr(cret_return_time,1,2) as integer)*3600 +cast(substr(cret_return_time,4,2) as integer)*60 +cast(substr(cret_return_time,7,2) as integer)) = t_time) left outer join item on (cret_item_id = i_item_id) left outer join customer c1 on (cret_return_customer_id = c1.c_customer_id) left outer join customer c2 on (cret_refund_customer = c2.c_customer_id) left outer join reason on (cret_reason_id = r_reason_id) left outer join call_center on (cret_call_center_id = cc_call_center_id) where i_rec_end_date is NULL and cc_rec_end_date is NULL; select count(*) from s_catalog_returns_m; select count(*) from crv; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_cs.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into catalog_sales (select * from csv); rollback; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_cs_t.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ s_catalog_order_m set cord_order_date = '' where cord_order_date='-4713-11-2'; update s_catalog_order_lineitem_m set clin_ship_date = '' where clin_ship_date='-4713-11-2'; drop table csv; create table csv as select d1.d_date_sk cs_sold_date_sk ,t_time_sk cs_sold_time_sk ,d2.d_date_sk cs_ship_date_sk ,c1.c_customer_sk cs_bill_customer_sk ,c1.c_current_cdemo_sk cs_bill_cdemo_sk ,c1.c_current_hdemo_sk cs_bill_hdemo_sk ,c1.c_current_addr_sk cs_bill_addr_sk ,c2.c_customer_sk cs_ship_customer_sk ,c2.c_current_cdemo_sk cs_ship_cdemo_sk ,c2.c_current_hdemo_sk cs_ship_hdemo_sk ,c2.c_current_addr_sk cs_ship_addr_sk ,cc_call_center_sk cs_call_center ,cp_catalog_page_sk cs_catalog_page_sk ,sm_ship_mode_sk cs_ship_mode_sk ,w_warehouse_sk cs_warehouse_sk ,i_item_sk cs_item_sk ,p_promo_sk cs_promo_sk ,cord_order_id cs_order_number ,clin_quantity cs_quantity ,i_wholesale_cost cs_wholesale_cost ,i_current_price cs_list_price ,clin_sales_price cs_sales_price ,(i_current_price-clin_sales_price)*clin_quantity cs_ext_discount_amt ,clin_sales_price * clin_quantity cs_ext_sales_price ,i_wholesale_cost * clin_quantity cs_ext_wholesale_cost ,i_current_price * clin_quantity CS_EXT_LIST_PRICE ,i_current_price * cc_tax_percentage CS_EXT_TAX ,clin_coupon_amt cs_coupon_amt ,clin_ship_cost * clin_quantity CS_EXT_SHIP_COST ,(clin_sales_price * clin_quantity)-clin_coupon_amt cs_net_paid ,((clin_sales_price * clin_quantity)-clin_coupon_amt)*(1+cc_tax_percentage) cs_net_paid_inc_tax ,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) CS_NET_PAID_INC_SHIP ,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) + i_current_price * cc_tax_percentage CS_NET_PAID_INC_SHIP_TAX ,((clin_sales_price * clin_quantity)-clin_coupon_amt)-(clin_quantity*i_wholesale_cost) cs_net_profit from s_catalog_order_m left outer join date_dim d1 on (to_date(cord_order_date,'YYYY-MM-DD') = d1.d_date) left outer join time_dim on (cord_order_time = t_time) left outer join customer c1 on (cord_bill_customer_id = c1.c_customer_id) left outer join customer c2 on (cord_ship_customer_id = c2.c_customer_id) left outer join call_center on (cord_call_center_id = cc_call_center_id) left outer join ship_mode on (cord_ship_mode_id = sm_ship_mode_id), s_catalog_order_lineitem_m left outer join date_dim d2 on (to_date(clin_ship_date,'YYYY-MM-DD') = d2.d_date) left outer join catalog_page on (clin_catalog_page_number = cp_catalog_page_number and clin_catalog_number = cp_catalog_number) left outer join warehouse on (clin_warehouse_id = w_warehouse_id) left outer join item on (clin_item_id = i_item_id) left outer join promotion on (clin_promotion_id = p_promo_id) where cord_order_id = clin_order_id and i_rec_end_date is NULL and cc_rec_end_date is null; select count(*) from csv where cs_item_sk is null; select count(*) from s_catalog_order_m,s_catalog_order_lineitem_m where cord_order_id = clin_order_id; select count(*) from csv; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_sr.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into store_returns (select * from srv); rollback; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_sr_t.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table srv; create table srv as select d_date_sk sr_returned_date_sk ,t_time_sk sr_return_time_sk ,i_item_sk sr_item_sk ,c_customer_sk sr_customer_sk ,c_current_cdemo_sk sr_cdemo_sk ,c_current_hdemo_sk sr_hdemo_sk ,c_current_addr_sk sr_addr_sk ,s_store_sk sr_store_sk ,r_reason_sk sr_reason_sk ,sret_ticket_number sr_ticket_number ,sret_return_qty sr_return_quantity ,sret_return_amount sr_return_amt ,sret_return_tax sr_return_tax ,sret_return_amount + sret_return_tax sr_return_amt_inc_tax ,sret_return_fee sr_fee ,sret_return_ship_cost sr_return_ship_cost ,sret_refunded_cash sr_refunded_cash ,sret_reversed_charge sr_reversed_charde ,sret_store_credit sr_store_credit ,sret_return_amount+sret_return_tax+sret_return_fee -sret_refunded_cash-sret_reversed_charge-sret_store_credit sr_net_loss from s_store_returns_m left outer join date_dim on (sret_return_date = d_date) left outer join time_dim on (( cast(substr(sret_return_time,1,2) as integer)*3600 +cast(substr(sret_return_time,4,2) as integer)*60 +cast(substr(sret_return_time,7,2) as integer)) = t_time) left outer join item on (sret_item_id = i_item_id) left outer join customer on (sret_customer_id = c_customer_id) left outer join store on (sret_store_id = s_store_id) left outer join reason on (sret_reason_id = r_reason_id) where i_rec_end_date is NULL and s_rec_end_date is NULL; select count(*) from srv where sr_item_sk is null; select count(*) from s_store_returns_m; select count(*) from srv; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_ss.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into store_sales (select * from ssv); rollback; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_ss_t.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table ssv; create table ssv as select d_date_sk ss_sold_date_sk, t_time_sk ss_sold_time_sk, i_item_sk ss_item_sk, c_customer_sk ss_customer_sk, c_current_cdemo_sk ss_cdemo_sk, c_current_hdemo_sk ss_hdemo_sk, c_current_addr_sk ss_addr_sk, s_store_sk ss_store_sk, p_promo_sk ss_promo_sk, purc_purchase_id ss_ticket_number, plin_quantity ss_quantity, i_wholesale_cost ss_wholesale_cost, i_current_price ss_list_price, plin_sale_price ss_sales_price, (i_current_price-plin_sale_price)*plin_quantity ss_ext_discount_amt, plin_sale_price * plin_quantity ss_ext_sales_price, i_wholesale_cost * plin_quantity ss_ext_wholesale_cost, i_current_price * plin_quantity ss_ext_list_price, i_current_price * s_tax_percentage ss_ext_tax, plin_coupon_amt ss_coupon_amt, (plin_sale_price * plin_quantity)-plin_coupon_amt ss_net_paid, ((plin_sale_price * plin_quantity)-plin_coupon_amt)*(1+s_tax_percentage) ss_net_paid_inc_tax, ((plin_sale_price * plin_quantity)-plin_coupon_amt)-(plin_quantity*i_wholesale_cost) ss_net_profit from s_purchase_m left outer join customer on (purc_customer_id = c_customer_id) left outer join store on (purc_store_id = s_store_id) left outer join date_dim on (to_date(purc_purchase_date,'YYYY-MM-DD') = d_date) left outer join time_dim on (PURC_PURCHASE_TIME = t_time), s_purchase_lineitem_m left outer join promotion on plin_promotion_id = p_promo_id left outer join item on plin_item_id = i_item_id where purc_purchase_id = plin_purchase_id and i_rec_end_date is NULL and s_rec_end_date is NULL; -- for now delete the rows that have lineitem = null --delete from ssv where ss_item_sk is null; select count(*) from ssv where ss_item_sk is null; -- for now delete pk violaters --delete from ssv where ss_ticket_number in (select ss_ticket_number from (select ss_ticket_number,ss_item_sk from ssv group by ss_ticket_number,ss_item_sk having count(*) > 1)); --select ss_ticket_number,ss_item_sk from ssv group by ss_ticket_number,ss_item_sk having count(*) > 1; select count(*) from s_purchase_m,s_purchase_lineitem_m where purc_purchase_id = plin_purchase_id; select count(*) from ssv; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_wr.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into web_returns (select * from wrv); rollback; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_wr_t.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ s_web_returns_m set wret_return_date = null where wret_return_date like '%-47%'; drop table wrv; create table wrv as select d_date_sk wr_return_date_sk ,t_time_sk wr_return_time_sk ,i_item_sk wr_item_sk ,c1.c_customer_sk wr_refunded_customer_sk ,c1.c_current_cdemo_sk wr_refunded_cdemo_sk ,c1.c_current_hdemo_sk wr_refunded_hdemo_sk ,c1.c_current_addr_sk wr_refunded_addr_sk ,c2.c_customer_sk wr_returning_customer_sk ,c2.c_current_cdemo_sk wr_returning_cdemo_sk ,c2.c_current_hdemo_sk wr_returning_hdemo_sk ,c2.c_current_addr_sk wr_returing_addr_sk ,wp_web_page_sk wr_web_page_sk ,r_reason_sk wr_reason_sk ,wret_order_id wr_order_number ,wret_return_qty wr_return_quantity ,wret_return_amt wr_return_amt ,wret_return_tax wr_return_tax ,wret_return_amt + wret_return_tax as wr_return_amt_inc_tax ,wret_return_fee wr_fee ,wret_return_ship_cost wr_return_ship_cost ,wret_refunded_cash wr_refunded_cash ,wret_reversed_charge wr_reversed_charde ,wret_account_credit wr_account_credit ,wret_return_amt+wret_return_tax+wret_return_fee -wret_refunded_cash-wret_reversed_charge-wret_account_credit wr_net_loss from s_web_returns_m left outer join date_dim on (to_date(wret_return_date,'YYYY-MM-DD') = d_date) left outer join time_dim on (( cast(substr(wret_return_time,1,2) as integer)*3600 +cast(substr(wret_return_time,4,2) as integer)*60 +cast(substr(wret_return_time,7,2) as integer)) = t_time) left outer join item on (wret_item_id = i_item_id) left outer join customer c1 on (wret_return_customer_id = c1.c_customer_id) left outer join customer c2 on (wret_refund_customer_id = c2.c_customer_id) left outer join reason on (wret_reason_id = r_reason_id) left outer join web_page on (wret_web_page_id = WP_WEB_PAGE_id) where i_rec_end_date is NULL and wp_rec_end_date is NULL; select count(*) from wrv where wr_item_sk is null; select count(*) from s_web_returns_m; select count(*) from wrv; ]
2018-08-14 14:09:14: Generating execution metrics for [lf_ws.sql]..
2018-08-14 14:09:14: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into web_sales (select * from wsv); rollback; ]
2018-08-14 14:09:15: Generating execution metrics for [lf_ws_t.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ s_web_order_m set word_order_date = null where word_order_date like '%-47%'; update s_web_order_lineitem_m set wlin_ship_date = null where wlin_ship_date like '%-47%'; drop table wsv; create table wsv as select d1.d_date_sk ws_sold_date_sk, t_time_sk ws_sold_time_sk, d2.d_date_sk ws_ship_date_sk, i_item_sk ws_item_sk, c1.c_customer_sk ws_bill_customer_sk, c1.c_current_cdemo_sk ws_bill_cdemo_sk, c1.c_current_hdemo_sk ws_bill_hdemo_sk, c1.c_current_addr_sk ws_bill_addr_sk, c2.c_customer_sk ws_ship_customer_sk, c2.c_current_cdemo_sk ws_ship_cdemo_sk, c2.c_current_hdemo_sk ws_ship_hdemo_sk, c2.c_current_addr_sk ws_ship_addr_sk, web_site_sk ws_web_page_sk, wp_web_page_sk ws_web_site_s, sm_ship_mode_sk ws_ship_mode_sk, w_warehouse_sk ws_warehouse_sk, p_promo_sk ws_promo_sk, word_order_id ws_order_number, wlin_quantity ws_quantity, i_wholesale_cost ws_wholesale_cost, i_current_price ws_list_price, wlin_sales_price ws_sales_price, (i_current_price-wlin_sales_price)*wlin_quantity ws_ext_discount_amt, wlin_sales_price * wlin_quantity ws_ext_sales_price, i_wholesale_cost * wlin_quantity ws_ext_wholesale_cost, i_current_price * wlin_quantity ws_ext_list_price, i_current_price * web_tax_percentage ws_ext_tax, wlin_coupon_amt ws_coupon_amt, 0 WS_EXT_SHIP_COST, (wlin_sales_price * wlin_quantity)-wlin_coupon_amt ws_net_paid, ((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)*(1+web_tax_percentage) ws_net_paid_inc_tax, ((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(wlin_quantity*i_wholesale_cost) WS_NET_PAID_INC_SHIP, (wlin_sales_price * wlin_quantity)-wlin_coupon_amt + (wlin_ship_cost * wlin_quantity) + i_current_price * web_tax_percentage WS_NET_PAID_INC_SHIP_TAX, ((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(i_wholesale_cost * wlin_quantity) WS_NET_PROFIT from s_web_order_m left outer join date_dim d1 on (to_date(word_order_date,'YYYY-MM-DD') = d1.d_date) left outer join time_dim on (word_order_time = t_time) left outer join customer c1 on (word_bill_customer_id = c1.c_customer_id) left outer join customer c2 on (word_ship_customer_id = c2.c_customer_id) left outer join web_site on (word_web_site_id = web_site_id) left outer join ship_mode on (word_ship_mode_id = sm_ship_mode_id), s_web_order_lineitem_m left outer join date_dim d2 on (to_date(wlin_ship_date,'YYYY-MM-DD') = d2.d_date) left outer join item on (wlin_item_id = i_item_id) left outer join web_page on (wlin_web_page_id = wp_web_page_id) left outer join warehouse on (wlin_warehouse_id = w_warehouse_id) left outer join promotion on (wlin_promotion_id = p_promo_id) where word_order_id = wlin_order_id and i_rec_end_date is NULL and web_rec_end_date is null and wp_rec_end_date is null; select count(*) from wsv where ws_item_sk is null; select count(*) from s_web_order_m,s_web_order_lineitem_m where word_order_id = wlin_order_id; select count(*) from wsv; ]
2018-08-14 14:09:15: Generating execution metrics for [promv_up.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_promotion; create table s_promotion as (select P_PROMO_ID PROM_PROMOTION_ID ,d1.d_date PROM_START_DATE ,d2.d_date PROM_END_DATE ,P_COST PROM_COST ,P_RESPONSE_TARGET PROM_RESPONSE_TARGET ,P_PROMO_NAME PROM_PROMO_NAME ,P_CHANNEL_DMAIL PROM_CHANNEL_DMAIL ,P_CHANNEL_EMAIL PROM_CHANNEL_EMAIL ,P_CHANNEL_CATALOG PROM_CHANNEL_CATALOG ,P_CHANNEL_TV PROM_CHANNEL_TV ,P_CHANNEL_RADIO PROM_CHANNEL_RADIO ,P_CHANNEL_PRESS PROM_CHANNEL_PRESS ,P_CHANNEL_EVENT PROM_CHANNEL_EVENT ,P_CHANNEL_DEMO PROM_CHANNEL_DEMO ,P_CHANNEL_DETAILS PROM_CHANNEL_DETAILS ,P_PURPOSE PROM_PURPOSE ,P_DISCOUNT_ACTIVE PROM_DISCOUNT_ACTIVE from promotion left outer join date_dim d1 on P_START_DATE_SK = d1.d_date_sk left outer join date_dim d2 on P_END_DATE_SK = d2.d_date_sk where rownum < 100 ); ]
2018-08-14 14:09:15: Generating execution metrics for [storv_up.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_store; create table s_store as select * from (select s_store_id stor_store_id --,stor_address_id --,stor_divison_id --,stor_opened_date ,d1.d_date stor_closed_date ,s_store_name stor_name --,stor_store_class ,s_number_employees stor_employees ,s_floor_space stor_floor_space ,s_hours stor_hours ,s_market_manager stor_market_manager ,s_manager stor_store_manager ,s_market_id stor_market_id ,s_geography_class stor_geography_class ,s_tax_precentage stor_tax_percentage from store ,date_dim d1 where d_date_sk = s_closed_date_sk and s_rec_end_date is null) where rownum < 4; ]
2018-08-14 14:09:15: Generating execution metrics for [websv_up.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_web_site; create table s_web_site as select * from (select web_site_id wsit_web_site_id ,d1.d_date wsit_open_date ,d2.d_date wsit_closed_date ,web_name wsit_site_name ,web_class wsit_site_class ,web_manager wsit_site_manager ,web_tax_percentage wsit_tax_percentage from web_site ,date_dim d1 ,date_dim d2 where web_open_date_sk = d1.d_date_sk and web_close_date_sk = d2.d_date_sk and web_rec_end_date is null) where rownum < 6; ]
2018-08-14 14:09:15: Generating execution metrics for [webv_up.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_web_page; create table s_web_page as (select WP_WEB_PAGE_ID WPAG_WEB_PAGE_ID ,d1.d_date WPAG_CREATE_DATE ,d2.d_date WPAG_ACCESS_DATE ,WP_AUTOGEN_FLAG WPAG_AUTOGEN_FLAG ,WP_URL WPAG_URL ,WP_TYPE WPAG_TYPE ,WP_CHAR_COUNT WPAG_CHAR_COUNT ,WP_LINK_COUNT WPAG_LINK_COUNT ,WP_IMAGE_COUNT WPAG_IMAGE_COUNT ,WP_MAX_AD_COUNT WPAG_MAX_AD_COUNT from web_page left outer join date_dim d1 on wp_creation_date_sk = d1.d_date_sk left outer join date_dim d2 on wp_access_date_sk = d2.d_date_sk where wp_rec_end_date is null -- need this to eliminate duplicates and rownum < 10 ); ]
2018-08-14 14:09:15: Generating execution metrics for [wrhsv_up.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_warehouse; create table s_warehouse as (select W_WAREHOUSE_ID WRHS_WAREHOUSE_ID ,W_WAREHOUSE_name WRHS_WAREHOUSE_DESC ,W_WAREHOUSE_SQ_FT WRHS_WAREHOUSE_SQ_FT from warehouse where rownum < 10); ]
2018-08-14 14:09:15: Executed iteration [1] of removed stats benchmark
2018-08-14 14:09:15: Generating execution metrics for [query_1.sql]..
2018-08-14 14:09:15: Generating execution metrics for [query_2.sql]..
2018-08-14 14:09:15: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 14:09:16: Generating execution metrics for [query_3.sql]..
2018-08-14 14:09:16: Generating execution metrics for [query_4.sql]..
2018-08-14 14:09:20: Generating execution metrics for [query_5.sql]..
2018-08-14 14:09:23: Generating execution metrics for [query_6.sql]..
2018-08-14 14:09:23: Generating execution metrics for [query_7.sql]..
2018-08-14 14:09:23: Generating execution metrics for [query_8.sql]..
2018-08-14 14:09:24: Generating execution metrics for [query_9.sql]..
2018-08-14 14:09:26: Generating execution metrics for [query_10.sql]..
2018-08-14 14:09:26: Generating execution metrics for [query_11.sql]..
2018-08-14 14:09:28: Generating execution metrics for [query_12.sql]..
2018-08-14 14:09:29: Generating execution metrics for [query_13.sql]..
2018-08-14 14:09:32: Generating execution metrics for [query_14.sql]..
2018-08-14 14:09:35: Generating execution metrics for [query_15.sql]..
2018-08-14 14:09:35: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 14:09:35: Generating execution metrics for [query_16.sql]..
2018-08-14 14:09:36: Generating execution metrics for [query_17.sql]..
2018-08-14 14:09:36: Generating execution metrics for [query_18.sql]..
2018-08-14 14:09:36: Generating execution metrics for [query_19.sql]..
2018-08-14 14:09:37: Generating execution metrics for [query_20.sql]..
2018-08-14 14:09:37: Generating execution metrics for [query_21.sql]..
2018-08-14 14:09:37: Generating execution metrics for [query_22.sql]..
2018-08-14 14:09:37: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (cast ('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 14:09:37: Generating execution metrics for [query_23.sql]..
2018-08-14 14:09:42: Generating execution metrics for [query_24.sql]..
2018-08-14 14:09:48: Generating execution metrics for [query_25.sql]..
2018-08-14 14:09:54: Generating execution metrics for [query_26.sql]..
2018-08-14 14:09:54: Generating execution metrics for [query_27.sql]..
2018-08-14 14:09:54: Generating execution metrics for [query_28.sql]..
2018-08-14 14:09:54: Generating execution metrics for [query_29.sql]..
2018-08-14 14:09:54: Generating execution metrics for [query_30.sql]..
2018-08-14 14:09:55: Generating execution metrics for [query_31.sql]..
2018-08-14 14:09:57: Generating execution metrics for [query_32.sql]..
2018-08-14 14:09:57: Generating execution metrics for [query_33.sql]..
2018-08-14 14:09:57: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 14:09:57: Generating execution metrics for [query_34.sql]..
2018-08-14 14:09:58: Generating execution metrics for [query_35.sql]..
2018-08-14 14:09:58: Generating execution metrics for [query_36.sql]..
2018-08-14 14:09:58: Generating execution metrics for [query_37.sql]..
2018-08-14 14:09:59: Generating execution metrics for [query_38.sql]..
2018-08-14 14:10:42: Generating execution metrics for [query_39.sql]..
2018-08-14 14:10:42: Generating execution metrics for [query_40.sql]..
2018-08-14 14:10:42: Generating execution metrics for [query_41.sql]..
2018-08-14 14:10:43: Generating execution metrics for [query_42.sql]..
2018-08-14 14:10:46: Generating execution metrics for [query_43.sql]..
2018-08-14 14:10:49: Generating execution metrics for [query_44.sql]..
2018-08-14 14:10:49: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (cast ('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 14:10:49: Generating execution metrics for [query_45.sql]..
2018-08-14 14:10:49: Generating execution metrics for [query_46.sql]..
2018-08-14 14:10:50: Generating execution metrics for [query_47.sql]..
2018-08-14 14:10:50: Generating execution metrics for [query_48.sql]..
2018-08-14 14:10:51: Generating execution metrics for [query_49.sql]..
2018-08-14 14:10:51: Generating execution metrics for [query_50.sql]..
2018-08-14 14:10:53: Generating execution metrics for [query_51.sql]..
2018-08-14 14:10:55: Generating execution metrics for [query_52.sql]..
2018-08-14 14:29:29: Generating execution metrics for [query_53.sql]..
2018-08-14 14:29:29: Generating execution metrics for [query_54.sql]..
2018-08-14 14:29:29: Generating execution metrics for [query_55.sql]..
2018-08-14 14:29:31: Generating execution metrics for [query_56.sql]..
2018-08-14 14:29:31: Generating execution metrics for [query_57.sql]..
2018-08-14 14:29:31: Generating execution metrics for [query_58.sql]..
2018-08-14 14:29:32: Generating execution metrics for [query_59.sql]..
2018-08-14 14:29:32: Generating execution metrics for [query_60.sql]..
2018-08-14 14:29:32: Generating execution metrics for [query_61.sql]..
2018-08-14 14:29:32: Generating execution metrics for [query_62.sql]..
2018-08-14 14:29:32: Generating execution metrics for [query_63.sql]..
2018-08-14 14:29:34: Generating execution metrics for [query_64.sql]..
2018-08-14 14:29:34: Generating execution metrics for [query_65.sql]..
2018-08-14 14:29:34: Generating execution metrics for [query_66.sql]..
2018-08-14 14:29:34: Generating execution metrics for [query_67.sql]..
2018-08-14 14:29:35: Generating execution metrics for [query_68.sql]..
2018-08-14 14:29:35: Generating execution metrics for [query_69.sql]..
2018-08-14 14:29:36: Generating execution metrics for [query_70.sql]..
2018-08-14 14:29:36: Generating execution metrics for [query_71.sql]..
2018-08-14 14:29:40: Generating execution metrics for [query_72.sql]..
2018-08-14 14:29:40: Generating execution metrics for [query_73.sql]..
2018-08-14 14:29:46: Generating execution metrics for [query_74.sql]..
2018-08-14 14:29:47: Generating execution metrics for [query_75.sql]..
2018-08-14 14:29:47: Generating execution metrics for [query_76.sql]..
2018-08-14 14:29:48: Skipped DML instruction due to following exception: [ORA-01722: invalid number] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_desc ,w_warehouse_name ,d1.d_week_seq ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo ,sum(case when p_promo_sk is not null then 1 else 0 end) promo ,count(*) total_cnt from catalog_sales join inventory on (cs_item_sk = inv_item_sk) join warehouse on (w_warehouse_sk=inv_warehouse_sk) join item on (i_item_sk = cs_item_sk) join customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk) join household_demographics on (cs_bill_hdemo_sk = hd_demo_sk) join date_dim d1 on (cs_sold_date_sk = d1.d_date_sk) join date_dim d2 on (inv_date_sk = d2.d_date_sk) join date_dim d3 on (cs_ship_date_sk = d3.d_date_sk) left outer join promotion on (cs_promo_sk=p_promo_sk) left outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number) where d1.d_week_seq = d2.d_week_seq and inv_quantity_on_hand < cs_quantity and d3.d_date > d1.d_date + 5 and hd_buy_potential = '501-1000' and d1.d_year = 1999 and cd_marital_status = 'D' group by i_item_desc,w_warehouse_name,d1.d_week_seq order by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq ) where rownum <= 100 ]
2018-08-14 14:29:48: Generating execution metrics for [query_77.sql]..
2018-08-14 14:29:48: Generating execution metrics for [query_78.sql]..
2018-08-14 14:29:49: Generating execution metrics for [query_79.sql]..
2018-08-14 14:29:51: Generating execution metrics for [query_80.sql]..
2018-08-14 14:29:51: Generating execution metrics for [query_81.sql]..
2018-08-14 14:29:52: Generating execution metrics for [query_82.sql]..
2018-08-14 14:29:54: Generating execution metrics for [query_83.sql]..
2018-08-14 14:29:54: Generating execution metrics for [query_84.sql]..
2018-08-14 14:29:54: Generating execution metrics for [query_85.sql]..
2018-08-14 14:29:54: Generating execution metrics for [query_86.sql]..
2018-08-14 14:29:55: Generating execution metrics for [query_87.sql]..
2018-08-14 14:29:55: Generating execution metrics for [query_88.sql]..
2018-08-14 14:29:55: Generating execution metrics for [query_89.sql]..
2018-08-14 14:29:55: Generating execution metrics for [query_90.sql]..
2018-08-14 14:29:55: Generating execution metrics for [query_91.sql]..
2018-08-14 14:29:55: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ count(*) from ((select distinct c_last_name, c_first_name, d_date from store_sales, date_dim, customer where store_sales.ss_sold_date_sk = date_dim.d_date_sk and store_sales.ss_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) except (select distinct c_last_name, c_first_name, d_date from catalog_sales, date_dim, customer where catalog_sales.cs_sold_date_sk = date_dim.d_date_sk and catalog_sales.cs_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) except (select distinct c_last_name, c_first_name, d_date from web_sales, date_dim, customer where web_sales.ws_sold_date_sk = date_dim.d_date_sk and web_sales.ws_bill_customer_sk = customer.c_customer_sk and d_month_seq between 1221 and 1221+11) ) cool_cust ]
2018-08-14 14:29:55: Generating execution metrics for [query_92.sql]..
2018-08-14 14:29:56: Generating execution metrics for [query_93.sql]..
2018-08-14 14:29:57: Generating execution metrics for [query_94.sql]..
2018-08-14 14:29:57: Skipped DML instruction due to following exception: [ORA-01476: divisor is equal to zero] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio from ( select count(*) amc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 7 and 7+1 and household_demographics.hd_dep_count = 6 and web_page.wp_char_count between 5000 and 5200) at, ( select count(*) pmc from web_sales, household_demographics , time_dim, web_page where ws_sold_time_sk = time_dim.t_time_sk and ws_ship_hdemo_sk = household_demographics.hd_demo_sk and ws_web_page_sk = web_page.wp_web_page_sk and time_dim.t_hour between 20 and 20+1 and household_demographics.hd_dep_count = 6 and web_page.wp_char_count between 5000 and 5200) pt order by am_pm_ratio ) where rownum <= 100 ]
2018-08-14 14:29:57: Generating execution metrics for [query_95.sql]..
2018-08-14 14:29:57: Generating execution metrics for [query_96.sql]..
2018-08-14 14:29:57: Generating execution metrics for [query_97.sql]..
2018-08-14 14:29:57: Generating execution metrics for [query_98.sql]..
2018-08-14 14:29:57: Generating execution metrics for [query_99.sql]..
2018-08-14 14:29:58: Generating execution metrics for [query_100.sql]..
2018-08-14 14:29:58: Generating execution metrics for [query_101.sql]..
2018-08-14 14:29:59: Generating execution metrics for [query_102.sql]..
2018-08-14 14:29:59: Generating execution metrics for [query_103.sql]..
2018-08-14 14:29:59: Generating execution metrics for [query_104.sql]..
2018-08-14 14:29:59: Skipped DML instruction due to following exception: [ORA-24373: invalid length specified for statement] - Instruction: [ ]
2018-08-14 14:29:59: Generating execution metrics for [catv_up.sql]..
2018-08-14 14:29:59: Skipped DML instruction due to following exception: [ORA-00923: FROM keyword not found where expected] - Instruction: [ create /*ICS5200_MONITOR_HINT*/ table s_catalog_page as (select CP_CATALOG_NUMBER cpag_catalog_number ,CP_CATALOG_PAGE_NUMBER cpag_catalog_page_number ,CP_DEPARTMENT cpag_department ]
2018-08-14 14:29:59: Generating execution metrics for [ccv_up.sql]..
2018-08-14 14:29:59: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_call_center; create table s_call_center as (select cc_call_center_id call_center_id ,d1.d_date call_open_date ,d2.d_date call_closed_date ,cc_name call_center_name ,cc_class call_center_class ,cc_employees call_center_employees ,cc_sq_ft call_center_sq_ft ,CC_HOURS call_center_hours ,CC_MANAGER call_center_manager ,CC_TAX_PERCENTAGE call_tax_percentage from call_center left outer join date_dim d2 on CC_CLOSED_DATE_SK = d2.d_date_sk left outer join date_dim d1 on CC_OPEN_DATE_SK = d1.d_date_sk where cc_rec_end_date is NULL -- need this to avoid duplicates and rownum < 5 ); ]
2018-08-14 14:29:59: Generating execution metrics for [custv_up.sql]..
2018-08-14 14:29:59: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_customer; create table s_customer as (select C_CUSTOMER_ID CUST_CUSTOMER_ID ,C_SALUTATION CUST_SALUTATION ,C_LAST_NAME CUST_LAST_NAME ,C_FIRST_NAME CUST_FIRST_NAME ,C_PREFERRED_CUST_FLAG CUST_PREFFERED_FLAG ,d3.d_date CUST_BIRTH_DATE ,C_BIRTH_COUNTRY CUST_BIRTH_COUNTRY ,C_LOGIN CUST_LOGIN_ID ,C_EMAIL_ADDRESS CUST_EMAIL_ADDRESS ,d1.d_date CUST_FIRST_SHIPTO_DATE ,d2.d_date CUST_FIRST_PURCHASE_DATE ,C_LAST_REVIEW_DATE CUST_LAST_REVIEW_DATE ,CA_STREET_NUMBER CUST_STREET_NUMBER ,CA_SUITE_NUMBER CUST_SUITE_NUMBER ,CA_STREET_NAME CUST_STREET_NAME1 ,CA_STREET_NAME CUST_STREET_NAME2 ,CA_STREET_TYPE CUST_STREET_TYPE ,CA_CITY CUST_CITY ,CA_ZIP CUST_ZIP ,CA_COUNTY CUST_COUNTY ,CA_STATE CUST_STATE ,CA_COUNTRY CUST_COUNTRY ,CA_LOCATION_TYPE CUST_LOC_TYPE ,CD_GENDER CUST_GENDER_CODE ,CD_MARITAL_STATUS CUST_MARITAL_STATUS ,CD_EDUCATION_STATUS CUST_EDUC_STATUS ,CD_CREDIT_RATING CUST_CREDIT_RATING ,CD_PURCHASE_ESTIMATE CUST_PURCH_EST ,HD_BUY_POTENTIAL CUST_BUY_POTENTIAL ,HD_DEP_COUNT CUST_DEPEND_CNT ,CD_DEP_EMPLOYED_COUNT CUST_DEPEND_EMP_CNT ,CD_DEP_COLLEGE_COUNT CUST_DEPEND_COLLEGE_CNT ,HD_VEHICLE_COUNT CUST_VEHICLE_CNT ,IB_LOWER_BOUND+800 CUST_ANNUAL_INCOME from customer ,customer_address ,customer_demographics ,household_demographics ,income_band ,date_dim d1 ,date_dim d2 ,date_dim d3 where c_current_addr_sk = ca_address_sk and d1.d_date_sk = C_FIRST_SHIPTO_DATE_SK and d2.d_date_sk = C_FIRST_SALES_DATE_SK and extract (day from d3.d_date) = c_birth_day and extract (month from d3.d_date) = c_birth_month and extract (year from d3.d_date) = c_birth_year and C_CURRENT_CDEMO_SK = cd_demo_sk and C_CURRENT_HDEMO_SK = hd_demo_sk and HD_INCOME_BAND_SK = IB_INCOME_BAND_SK and rownum < 1000 ); ]
2018-08-14 14:29:59: Generating execution metrics for [dm_c.sql]..
2018-08-14 14:29:59: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; BEGIN FOR c_rec IN (SELECT C_CUSTOMER_ID ,C_CURRENT_CDEMO_SK ,C_CURRENT_HDEMO_SK ,C_CURRENT_ADDR_SK ,C_FIRST_SHIPTO_DATE_SK ,C_FIRST_SALES_DATE_SK ,C_SALUTATION ,C_FIRST_NAME ,C_LAST_NAME ,C_PREFERRED_CUST_FLAG ,C_BIRTH_DAY ,C_BIRTH_MONTH ,C_BIRTH_YEAR ,C_BIRTH_COUNTRY ,C_LOGIN ,C_EMAIL_ADDRESS ,C_LAST_REVIEW_DATE from custv) LOOP update customer set C_CUSTOMER_ID=c_rec.C_CUSTOMER_ID ,C_CURRENT_CDEMO_SK=c_rec.C_CURRENT_CDEMO_SK ,C_CURRENT_HDEMO_SK=c_rec.C_CURRENT_HDEMO_SK ,C_CURRENT_ADDR_SK=c_rec.C_CURRENT_ADDR_SK ,C_FIRST_SHIPTO_DATE_SK=c_rec.C_FIRST_SHIPTO_DATE_SK ,C_FIRST_SALES_DATE_SK=c_rec.C_FIRST_SALES_DATE_SK ,C_SALUTATION=c_rec.C_SALUTATION ,C_FIRST_NAME=c_rec.C_FIRST_NAME ,C_LAST_NAME=c_rec.C_LAST_NAME ,C_PREFERRED_CUST_FLAG=c_rec.C_PREFERRED_CUST_FLAG ,C_BIRTH_DAY=c_rec.C_BIRTH_DAY ,C_BIRTH_MONTH=c_rec.C_BIRTH_MONTH ,C_BIRTH_YEAR=c_rec.C_BIRTH_YEAR ,C_BIRTH_COUNTRY=c_rec.C_BIRTH_COUNTRY ,C_LOGIN=c_rec.C_LOGIN ,C_EMAIL_ADDRESS=c_rec.C_EMAIL_ADDRESS ,C_LAST_REVIEW_DATE=c_rec.C_LAST_REVIEW_DATE where c_customer_id=c_rec.c_customer_id; END LOOP; commit; END; . run; ]
2018-08-14 14:29:59: Generating execution metrics for [dm_c_t.sql]..
2018-08-14 14:29:59: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table custv; create table custv as select cust_customer_id c_customer_id ,cd_demo_sk c_current_cdemo_sk ,hd_demo_sk c_current_hdemo_sk ,ca_address_sk c_current_addr_sk ,d1.d_date_sk c_first_shipto_date_sk ,d2.d_date_sk c_first_sales_date_sk ,cust_salutation c_salutation ,cust_first_name c_first_name ,cust_last_name c_last_name ,cust_preffered_flag c_preferred_cust_flag ,extract(day from cast(cust_birth_date as date)) c_birth_day ,extract(month from cast(cust_birth_date as date)) c_birth_month ,extract(year from cast(cust_birth_date as date)) c_birth_year ,cust_birth_country c_birth_country ,cust_login_id c_login ,cust_email_address c_email_address ,cust_last_review_date c_last_review_date from s_customer_m left outer join customer on (c_customer_id=cust_customer_id) left outer join customer_address on (c_current_addr_sk = ca_address_sk) ,customer_demographics ,household_demographics ,income_band ib ,date_dim d1 ,date_dim d2 where cust_gender = cd_gender and cust_marital_status = cd_marital_status and cust_educ_status = cd_education_status and cust_purch_est = cd_purchase_estimate and cust_credit_rating = cd_credit_rating and cust_depend_cnt = cd_dep_count and cust_depend_emp_cnt = cd_dep_employed_count and cust_depend_college_cnt = cd_dep_college_count and round(cust_annual_income, 0) between ib.ib_lower_bound and ib.ib_upper_bound and hd_income_band_sk = ib_income_band_sk and cust_buy_potential = hd_buy_potential and cust_depend_cnt= hd_dep_count and cust_vehicle_cnt = hd_vehicle_count and d1.d_date = cust_first_purchase_date and d2.d_date = cust_first_shipto_date ; select count(*) from s_customer_m; select count(*) from custv; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_ca.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR ca_rec IN (SELECT CA_ADDRESS_ID ,CA_STREET_NUMBER ,CA_STREET_NAME ,CA_STREET_TYPE ,CA_SUITE_NUMBER ,CA_CITY ,CA_COUNTY ,CA_STATE ,CA_ZIP ,CA_COUNTRY ,CA_GMT_OFFSET ,CA_LOCATION_TYPE from cadrv) LOOP update customer_address set CA_STREET_NUMBER=ca_rec.CA_STREET_NUMBER ,CA_STREET_NAME=ca_rec.CA_STREET_NAME ,CA_STREET_TYPE=ca_rec.CA_STREET_TYPE ,CA_SUITE_NUMBER=ca_rec.CA_SUITE_NUMBER ,CA_CITY=ca_rec.CA_CITY ,CA_COUNTY=ca_rec.CA_COUNTY ,CA_STATE=ca_rec.CA_STATE ,CA_ZIP=ca_rec.CA_ZIP ,CA_COUNTRY=ca_rec.CA_COUNTRY ,CA_GMT_OFFSET=ca_rec.CA_GMT_OFFSET ,CA_LOCATION_TYPE=ca_rec.CA_LOCATION_TYPE where CA_ADDRESS_ID=ca_rec.CA_ADDRESS_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_ca_t.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table cadrv; create table cadrv as select ca_address_id ca_address_id ,cust_street_number ca_street_number ,concat(concat(rtrim(cust_street_name1),' '),rtrim(cust_street_name2)) ca_street_name ,cust_street_type ca_street_type ,cust_suite_number ca_suite_number ,cust_city ca_city ,cust_county ca_county ,cust_state ca_state ,cust_zip ca_zip ,cust_country ca_country ,zipg_gmt_offset ca_gmt_offset ,cust_loc_type ca_location_type from s_customer_m ,customer ,customer_address ,s_zip_to_gmt_m where cust_zip = zipg_zip and cust_customer_id = c_customer_id and c_current_addr_sk = ca_address_sk; select count(*) from s_customer_m; select count(*) from cadrv; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_ca_v.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ view cadrv; create view cadrv as select cust_customer_id ,cust_street_number ,concat(cust_street_name1,cust_street_name2) street ,cust_street_type ,cust_suite_number ,cust_city ,cust_county ,cust_state ,cust_zip ,cust_country ,zipg_gmt_offset from s_customer_m ,s_zip_to_gmt where cust_zip = zipg_zip; select count(*) from s_customer_m; select count(*) from cadrv; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_cc.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ call_center set cc_rec_end_date = sysdate where cc_call_center_id in (select cc_call_center_id from call_center) and cc_rec_end_date is NULL; insert into call_center(select * from ccv); ]
2018-08-14 14:30:00: Generating execution metrics for [dm_cc_s.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE item_seq; SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(cc_call_center_sk)+1 INTO max_sk FROM call_center; dbms_output.put_line('max call center sk '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE callcenter_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_cc_t.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table ccv; create table CCV as select callcenter_seq.nextval cc_call_center_sk ,call_center_id cc_call_center_id ,sysdate cc_rec_start_date ,cast(NULL as date) cc_rec_end_date ,d1.d_date_sk cc_closed_date_sk ,d2.d_date_sk cc_open_date_sk ,call_center_name cc_name ,call_center_class cc_class ,call_center_employees cc_employees ,call_center_sq_ft cc_sq_ft ,call_center_hours cc_hours ,call_center_manager cc_manager ,cc_mkt_id ,cc_mkt_class ,cc_mkt_desc ,cc_market_manager ,cc_division ,cc_division_name ,cc_company ,cc_company_name ,cc_street_number ,cc_street_name ,cc_street_type ,cc_suite_number ,cc_city ,cc_county ,cc_state ,cc_zip ,cc_country ,cc_gmt_offset ,call_center_tax_percentage cc_tax_percentage from s_call_center_m left outer join date_dim d2 on d2.d_date = cast(call_closed_date as date) left outer join date_dim d1 on d1.d_date = cast(call_open_date as date), call_center where call_center_id = cc_call_center_id and cc_rec_end_date is null; select count(*) from s_call_center_m; select count(*) from ccv; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_cp.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR cp_rec IN (SELECT CP_CATALOG_PAGE_ID ,CP_START_DATE_SK ,CP_END_DATE_SK ,CP_DEPARTMENT ,CP_CATALOG_NUMBER ,CP_DESCRIPTION ,CP_TYPE FROM catv) LOOP update catalog_page set CP_CATALOG_PAGE_ID=cp_rec.CP_CATALOG_PAGE_ID ,CP_START_DATE_SK=cp_rec.CP_START_DATE_SK ,CP_END_DATE_SK=cp_rec.CP_END_DATE_SK ,CP_DEPARTMENT=cp_rec.CP_DEPARTMENT ,CP_CATALOG_NUMBER=cp_rec.CP_CATALOG_NUMBER ,CP_DESCRIPTION=cp_rec.CP_DESCRIPTION ,CP_TYPE=cp_rec.CP_TYPE where CP_CATALOG_PAGE_ID=cp_rec.CP_CATALOG_PAGE_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_cp_t.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table catv; create table catv as select cpag_id cp_catalog_page_id ,startd.d_date_sk cp_start_date_sk ,endd.d_date_sk cp_end_date_sk ,cpag_department cp_department ,cpag_catalog_number cp_catalog_number ,cpag_description cp_description ,cpag_type cp_type from s_catalog_page ,date_dim startd ,date_dim endd where cpag_start_date = startd.d_date and cpag_end_date = endd.d_date; select count(*) from catv; select count(*) from s_catalog_page; ]
2018-08-14 14:30:00: Generating execution metrics for [dm_i.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ item set i_rec_end_date = sysdate where i_item_id in (select i_item_id from itemv) and i_rec_end_date is NULL; insert into item (select * from itemv); ]
2018-08-14 14:30:00: Generating execution metrics for [dm_i_s.sql]..
2018-08-14 14:30:00: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE item_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(i_item_sk)+1 INTO max_sk FROM item; dbms_output.put_line('max item sk '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE item_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_i_t.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table itemv; create table itemv as select item_seq.nextVal i_item_sk ,item_item_id i_item_id ,sysdate i_rec_start_date ,cast(NULL as date) i_rec_end_date ,item_item_description i_item_desc ,item_list_price i_current_price ,item_wholesale_cost i_wholesalecost ,i_brand_id ,i_brand ,i_class_id ,i_class ,i_category_id ,i_category ,i_manufact_id ,i_manufact ,item_size i_size ,item_formulation i_formulation ,item_color i_color ,item_units i_units ,item_container i_container ,item_manager_id i_manager ,i_product_name from s_item_m, item where item_item_id = i_item_id and i_rec_end_date is null; select count(*) from s_item_m; select count(*) from itemv; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_p.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ count(*) from promv; select count(*) from promv s,promotion d where s.P_PROMO_ID=d.P_PROMO_ID; SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR p_rec IN (SELECT P_PROMO_ID ,P_START_DATE_SK ,P_END_DATE_SK ,P_COST ,P_RESPONSE_TARGET ,P_PROMO_NAME ,P_CHANNEL_DMAIL ,P_CHANNEL_EMAIL ,P_CHANNEL_CATALOG ,P_CHANNEL_TV ,P_CHANNEL_RADIO ,P_CHANNEL_PRESS ,P_CHANNEL_EVENT ,P_CHANNEL_DEMO ,P_CHANNEL_DETAILS ,P_PURPOSE ,P_DISCOUNT_ACTIVE FROM promv) LOOP update promotion set P_END_DATE_SK=p_rec.P_END_DATE_SK ,P_COST=p_rec.P_COST ,P_RESPONSE_TARGET=p_rec.P_RESPONSE_TARGET ,P_PROMO_NAME=p_rec.P_PROMO_NAME ,P_CHANNEL_DMAIL=p_rec.P_CHANNEL_DMAIL ,P_CHANNEL_EMAIL=p_rec.P_CHANNEL_EMAIL ,P_CHANNEL_CATALOG=p_rec.P_CHANNEL_CATALOG ,P_CHANNEL_TV=p_rec.P_CHANNEL_TV ,P_CHANNEL_RADIO=p_rec.P_CHANNEL_RADIO ,P_CHANNEL_PRESS=p_rec.P_CHANNEL_PRESS ,P_CHANNEL_EVENT=p_rec.P_CHANNEL_EVENT ,P_CHANNEL_DEMO=p_rec.P_CHANNEL_DEMO ,P_CHANNEL_DETAILS=p_rec.P_CHANNEL_DETAILS ,P_PURPOSE=p_rec.P_PURPOSE ,P_DISCOUNT_ACTIVE=p_rec.P_DISCOUNT_ACTIVE where P_PROMO_ID=p_rec.P_PROMO_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_p_t.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table promv; create table promv as select prom_promotion_id p_promo_id ,d1.d_date_sk p_start_date_sk ,d2.d_date_sk p_end_date_sk ,prom_cost p_cost ,prom_response_target p_response_target ,prom_promotion_name p_promo_name ,prom_channel_dmail p_channel_dmail ,prom_channel_email p_channel_email ,prom_channel_catalog p_channel_catalog ,prom_channel_tv p_channel_tv ,prom_channel_radio p_channel_radio ,prom_channel_press p_channel_press ,prom_channel_event p_channel_event ,prom_channel_demo p_channel_demo ,prom_channel_details p_channel_details ,prom_purpose p_purpose ,prom_discount_active p_discount_active from s_promotion_m left outer join date_dim d1 on prom_start_date = d1.d_date left outer join date_dim d2 on prom_end_date = d2.d_date; select count(*) from s_promotion_m; select count(*) from promv; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_s.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ store set s_rec_end_date = sysdate where s_store_id in (select s_store_id from storv) and s_rec_end_date is NULL; insert into store (select * from storv); ]
2018-08-14 14:30:01: Generating execution metrics for [dm_s_s.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE store_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(s_store_sk)+1 INTO max_sk FROM store; dbms_output.put_line('max store sk '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE store_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_s_t.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table storv; create table storv as select store_seq.nextVal s_store_sk ,stor_store_id s_store_id ,sysdate s_rec_start_date ,cast(NULL as date) s_rec_end_date ,d1.d_date_sk s_closed_date_sk ,stor_name s_store_name ,stor_employees s_number_employees ,stor_floor_space s_floor_space ,stor_hours s_hours ,stor_store_manager s_manager ,stor_market_id s_market_id ,stor_geography_class s_geography_class ,s_market_desc ,stor_market_manager s_market_manager ,s_division_id ,s_division_name ,s_company_id ,s_company_name ,s_street_number ,s_street_name ,s_street_type ,s_suite_number ,s_city ,s_county ,s_state ,s_zip ,s_country ,s_gmt_offset ,stor_tax_percentage s_tax_percentage from s_store_m left outer join date_dim d1 on TO_DATE(stor_closed_date,'YYYY-MM-DD')= d1.d_date ,store where stor_store_id = s_store_id and s_rec_end_date is null; select 's_store_m '||count(*) from s_store_m; select 's_storv '||count(*) from storv; select 'null date_dim '||count(*) from storv where s_closed_date_sk is null; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_w.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00922: missing or invalid option] - Instruction: [ SET /*ICS5200_MONITOR_HINT*/ SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN FOR w_rec IN (SELECT W_WAREHOUSE_ID ,W_WAREHOUSE_NAME ,W_WAREHOUSE_SQ_FT ,W_STREET_NUMBER ,W_STREET_NAME ,W_STREET_TYPE ,W_SUITE_NUMBER ,W_CITY ,W_COUNTY ,W_STATE ,W_ZIP ,W_COUNTRY ,W_GMT_OFFSET FROM wrhsv) LOOP update warehouse set W_WAREHOUSE_NAME=w_rec.W_WAREHOUSE_NAME ,W_WAREHOUSE_SQ_FT=w_rec.W_WAREHOUSE_SQ_FT ,W_STREET_NUMBER=w_rec.W_STREET_NUMBER ,W_STREET_NAME=w_rec.W_STREET_NAME ,W_STREET_TYPE=w_rec.W_STREET_TYPE ,W_SUITE_NUMBER=w_rec.W_SUITE_NUMBER ,W_CITY=w_rec.W_CITY ,W_COUNTY=w_rec.W_COUNTY ,W_STATE=w_rec.W_STATE ,W_ZIP=w_rec.W_ZIP ,W_COUNTRY=w_rec.W_COUNTRY ,W_GMT_OFFSET=w_rec.W_GMT_OFFSET where W_WAREHOUSE_ID=w_rec.W_WAREHOUSE_ID; END LOOP; commit; END; . run; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_w_t.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table wrhsv; create table wrhsv as select wrhs_warehouse_id w_warehouse_id ,wrhs_warehouse_desc w_warehouse_name ,wrhs_warehouse_sq_ft w_warehouse_sq_ft ,w_street_number ,w_street_name ,w_street_type ,w_suite_number ,w_city ,w_county ,w_state ,w_zip ,w_country ,w_gmt_offset from s_warehouse_m, warehouse where wrhs_warehouse_id = w_warehouse_id; select count(*) from s_warehouse_m; select count(*) from wrhsv; ]
2018-08-14 14:30:01: Generating execution metrics for [dm_wp.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ web_page set wp_rec_end_date = sysdate where wp_web_page_id in (select wp_web_page_id from webv) and wp_rec_end_date is NULL; insert into web_page (select * from webv); ]
2018-08-14 14:30:01: Generating execution metrics for [dm_wp_s.sql]..
2018-08-14 14:30:01: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE web_page_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(WP_WEB_PAGE_SK)+1 INTO max_sk FROM web_page; dbms_output.put_line('max WP_WEB_PAGE_SK '||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE web_page_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:30:02: Generating execution metrics for [dm_wp_t.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table webv; create table webv as select web_page_seq.nextVal wp_web_page_sk ,wpag_web_page_id wp_web_page_id ,sysdate wp_rec_start_date ,cast(null as date) wp_rec_end_date ,d1.d_date_sk wp_creation_date_sk ,d2.d_date_sk wp_access_date_sk ,wpag_autogen_flag wp_autogen_flag ,wpag_url wp_url ,wpag_type wp_type ,wpag_char_cnt wp_char_count ,wpag_link_cnt wp_link_count ,wpag_image_cnt wp_image_count ,wpag_max_ad_cnt wp_max_ad_count from s_web_page_m left outer join date_dim d1 on wpag_create_date = d1.d_date left outer join date_dim d2 on wpag_access_date = d2.d_date; select count(*) from s_web_page; select count(*) from webv; ]
2018-08-14 14:30:02: Generating execution metrics for [dm_ws.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ web_site set web_rec_end_date = sysdate where web_site_id in (select web_site_id from websv) and web_rec_end_date is NULL; insert into web_site (select * from websv); rollback; ]
2018-08-14 14:30:02: Generating execution metrics for [dm_ws_s.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ SEQUENCE web_site_seq; --SET SERVEROUTPUT ON; DECLARE max_sk NUMBER; BEGIN SELECT max(web_site_sk)+1 INTO max_sk FROM web_site; dbms_output.put_line('max web_site_sk'||max_sk); EXECUTE IMMEDIATE 'CREATE SEQUENCE web_site_seq INCREMENT BY 1 START WITH '||max_sk||' ORDER'; END; . run; ]
2018-08-14 14:30:02: Generating execution metrics for [dm_ws_t.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table websv; create table websv as select web_site_seq.nextVal web_site_sk ,wsit_web_site_id web_site_id ,sysdate web_rec_start_date ,cast(null as date) web_rec_end_date ,wsit_site_name web_name ,d1.d_date_sk web_open_date_sk ,d2.d_date_sk web_close_date_sk ,wsit_site_class web_class ,wsit_site_manager web_manager ,web_mkt_id ,web_mkt_class ,web_mkt_desc ,web_market_manager ,web_company_id ,web_company_name ,web_street_number ,web_street_name ,web_street_type ,web_suite_number ,web_city ,web_county ,web_state ,web_zip ,web_country ,web_gmt_offset ,wsit_tax_percentage web_tax_percentage from s_web_site_m left outer join date_dim d1 on (d1.d_date = wsit_open_date) left outer join date_dim d2 on (d2.d_date = wsit_closed_date), web_site where web_site_id = wsit_web_site_id and web_rec_end_date is null; select count(*) from s_web_site_m; select count(*) from websv; ]
2018-08-14 14:30:02: Generating execution metrics for [itemv_up.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_item; create table s_item as (select i_item_id item_item_id ,i_item_desc item_item_description ,i_current_price item_list_price ,i_wholesale_cost item_wholesale_cost ,i_manager_id item_manager_id ,i_size item_size ,i_formulation item_formulation ,i_color item_color ,i_units item_units ,i_container item_container from item where i_rec_end_date is null and rownum < 1000); -- I need the following statement because of a bug in dbgen that generates some duplicates in item delete from s_item where item_item_id in (select ITEM_ITEM_ID from (select ITEM_ITEM_ID ,count(*) cnt from s_item group by ITEM_ITEM_ID) where cnt > 1); ]
2018-08-14 14:30:02: Generating execution metrics for [iv_up.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_inventory; create table s_inventory as (select w_warehouse_id invn_warehouse_id ,i_item_id invn_item_id ,d_date invn_date ,inv_quantity_on_hand invn_qty_on_hand from inventory ,warehouse ,item ,date_dim where inv_warehouse_sk = w_warehouse_sk and inv_item_sk = i_item_sk and i_rec_end_date is null and inv_date_sk = d_date_sk and d_year = 2001 and d_dom between 10 and 15 ); delete from s_inventory where (invn_warehouse_id,invn_item_id,invn_date) in (select invn_warehouse_id,invn_item_id,invn_date from (select invn_warehouse_id,invn_item_id,invn_date,count(*) from s_inventory group by invn_warehouse_id,invn_item_id,invn_date having count(*) > 1)); ]
2018-08-14 14:30:02: Generating execution metrics for [lf_cr.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into catalog_returns (select * from crv); rollback; ]
2018-08-14 14:30:02: Generating execution metrics for [lf_cr_t.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table crv; --update call_center set CC_REC_END_date = null where CC_CALL_CENTER_SK in (3,6); update s_catalog_returns_m set cret_return_date = null where cret_return_date like '%-47%'; create table crv as select d_date_sk cr_return_date_sk ,t_time_sk cr_return_time_sk ,0 CR_SHIP_DATE_SK ,i_item_sk cr_item_sk ,c1.c_customer_sk cr_refunded_customer_sk ,c1.c_current_cdemo_sk cr_refunded_cdemo_sk ,c1.c_current_hdemo_sk cr_refunded_hdemo_sk ,c1.c_current_addr_sk cr_refunded_addr_sk ,c2.c_customer_sk cr_returning_customer_sk ,c2.c_current_cdemo_sk cr_returning_cdemo_sk ,c2.c_current_hdemo_sk cr_returning_hdemo_sk ,c2.c_current_addr_sk cr_returing_addr_sk ,cc_call_center_sk cr_call_center_sk ,0 CR_CATALOG_PAGE_SK ,0 CR_SHIP_MODE_SK ,0 CR_WAREHOUSE_SK ,r_reason_sk cr_reason_sk ,cret_order_id cr_order_number ,cret_return_qty cr_return_quantity ,cret_return_amt cr_return_amt ,cret_return_tax cr_return_tax ,cret_return_amt + cret_return_tax as cr_return_amt_inc_tax ,cret_return_fee cr_fee ,cret_return_ship_cost cr_return_ship_cost ,cret_refunded_cash cr_refunded_cash ,cret_reversed_charge cr_reversed_charde ,cret_merchant_credit cr_merchant_credit ,cret_return_amt+cret_return_tax+cret_return_fee -cret_refunded_cash-cret_reversed_charge-cret_merchant_credit cr_net_loss from s_catalog_returns_m left outer join date_dim on (to_date(cret_return_date,'YYYY-MM-DD') = d_date) left outer join time_dim on (( cast(substr(cret_return_time,1,2) as integer)*3600 +cast(substr(cret_return_time,4,2) as integer)*60 +cast(substr(cret_return_time,7,2) as integer)) = t_time) left outer join item on (cret_item_id = i_item_id) left outer join customer c1 on (cret_return_customer_id = c1.c_customer_id) left outer join customer c2 on (cret_refund_customer = c2.c_customer_id) left outer join reason on (cret_reason_id = r_reason_id) left outer join call_center on (cret_call_center_id = cc_call_center_id) where i_rec_end_date is NULL and cc_rec_end_date is NULL; select count(*) from s_catalog_returns_m; select count(*) from crv; ]
2018-08-14 14:30:02: Generating execution metrics for [lf_cs.sql]..
2018-08-14 14:30:02: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into catalog_sales (select * from csv); rollback; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_cs_t.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ s_catalog_order_m set cord_order_date = '' where cord_order_date='-4713-11-2'; update s_catalog_order_lineitem_m set clin_ship_date = '' where clin_ship_date='-4713-11-2'; drop table csv; create table csv as select d1.d_date_sk cs_sold_date_sk ,t_time_sk cs_sold_time_sk ,d2.d_date_sk cs_ship_date_sk ,c1.c_customer_sk cs_bill_customer_sk ,c1.c_current_cdemo_sk cs_bill_cdemo_sk ,c1.c_current_hdemo_sk cs_bill_hdemo_sk ,c1.c_current_addr_sk cs_bill_addr_sk ,c2.c_customer_sk cs_ship_customer_sk ,c2.c_current_cdemo_sk cs_ship_cdemo_sk ,c2.c_current_hdemo_sk cs_ship_hdemo_sk ,c2.c_current_addr_sk cs_ship_addr_sk ,cc_call_center_sk cs_call_center ,cp_catalog_page_sk cs_catalog_page_sk ,sm_ship_mode_sk cs_ship_mode_sk ,w_warehouse_sk cs_warehouse_sk ,i_item_sk cs_item_sk ,p_promo_sk cs_promo_sk ,cord_order_id cs_order_number ,clin_quantity cs_quantity ,i_wholesale_cost cs_wholesale_cost ,i_current_price cs_list_price ,clin_sales_price cs_sales_price ,(i_current_price-clin_sales_price)*clin_quantity cs_ext_discount_amt ,clin_sales_price * clin_quantity cs_ext_sales_price ,i_wholesale_cost * clin_quantity cs_ext_wholesale_cost ,i_current_price * clin_quantity CS_EXT_LIST_PRICE ,i_current_price * cc_tax_percentage CS_EXT_TAX ,clin_coupon_amt cs_coupon_amt ,clin_ship_cost * clin_quantity CS_EXT_SHIP_COST ,(clin_sales_price * clin_quantity)-clin_coupon_amt cs_net_paid ,((clin_sales_price * clin_quantity)-clin_coupon_amt)*(1+cc_tax_percentage) cs_net_paid_inc_tax ,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) CS_NET_PAID_INC_SHIP ,(clin_sales_price * clin_quantity)-clin_coupon_amt + (clin_ship_cost * clin_quantity) + i_current_price * cc_tax_percentage CS_NET_PAID_INC_SHIP_TAX ,((clin_sales_price * clin_quantity)-clin_coupon_amt)-(clin_quantity*i_wholesale_cost) cs_net_profit from s_catalog_order_m left outer join date_dim d1 on (to_date(cord_order_date,'YYYY-MM-DD') = d1.d_date) left outer join time_dim on (cord_order_time = t_time) left outer join customer c1 on (cord_bill_customer_id = c1.c_customer_id) left outer join customer c2 on (cord_ship_customer_id = c2.c_customer_id) left outer join call_center on (cord_call_center_id = cc_call_center_id) left outer join ship_mode on (cord_ship_mode_id = sm_ship_mode_id), s_catalog_order_lineitem_m left outer join date_dim d2 on (to_date(clin_ship_date,'YYYY-MM-DD') = d2.d_date) left outer join catalog_page on (clin_catalog_page_number = cp_catalog_page_number and clin_catalog_number = cp_catalog_number) left outer join warehouse on (clin_warehouse_id = w_warehouse_id) left outer join item on (clin_item_id = i_item_id) left outer join promotion on (clin_promotion_id = p_promo_id) where cord_order_id = clin_order_id and i_rec_end_date is NULL and cc_rec_end_date is null; select count(*) from csv where cs_item_sk is null; select count(*) from s_catalog_order_m,s_catalog_order_lineitem_m where cord_order_id = clin_order_id; select count(*) from csv; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_sr.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into store_returns (select * from srv); rollback; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_sr_t.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table srv; create table srv as select d_date_sk sr_returned_date_sk ,t_time_sk sr_return_time_sk ,i_item_sk sr_item_sk ,c_customer_sk sr_customer_sk ,c_current_cdemo_sk sr_cdemo_sk ,c_current_hdemo_sk sr_hdemo_sk ,c_current_addr_sk sr_addr_sk ,s_store_sk sr_store_sk ,r_reason_sk sr_reason_sk ,sret_ticket_number sr_ticket_number ,sret_return_qty sr_return_quantity ,sret_return_amount sr_return_amt ,sret_return_tax sr_return_tax ,sret_return_amount + sret_return_tax sr_return_amt_inc_tax ,sret_return_fee sr_fee ,sret_return_ship_cost sr_return_ship_cost ,sret_refunded_cash sr_refunded_cash ,sret_reversed_charge sr_reversed_charde ,sret_store_credit sr_store_credit ,sret_return_amount+sret_return_tax+sret_return_fee -sret_refunded_cash-sret_reversed_charge-sret_store_credit sr_net_loss from s_store_returns_m left outer join date_dim on (sret_return_date = d_date) left outer join time_dim on (( cast(substr(sret_return_time,1,2) as integer)*3600 +cast(substr(sret_return_time,4,2) as integer)*60 +cast(substr(sret_return_time,7,2) as integer)) = t_time) left outer join item on (sret_item_id = i_item_id) left outer join customer on (sret_customer_id = c_customer_id) left outer join store on (sret_store_id = s_store_id) left outer join reason on (sret_reason_id = r_reason_id) where i_rec_end_date is NULL and s_rec_end_date is NULL; select count(*) from srv where sr_item_sk is null; select count(*) from s_store_returns_m; select count(*) from srv; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_ss.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into store_sales (select * from ssv); rollback; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_ss_t.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table ssv; create table ssv as select d_date_sk ss_sold_date_sk, t_time_sk ss_sold_time_sk, i_item_sk ss_item_sk, c_customer_sk ss_customer_sk, c_current_cdemo_sk ss_cdemo_sk, c_current_hdemo_sk ss_hdemo_sk, c_current_addr_sk ss_addr_sk, s_store_sk ss_store_sk, p_promo_sk ss_promo_sk, purc_purchase_id ss_ticket_number, plin_quantity ss_quantity, i_wholesale_cost ss_wholesale_cost, i_current_price ss_list_price, plin_sale_price ss_sales_price, (i_current_price-plin_sale_price)*plin_quantity ss_ext_discount_amt, plin_sale_price * plin_quantity ss_ext_sales_price, i_wholesale_cost * plin_quantity ss_ext_wholesale_cost, i_current_price * plin_quantity ss_ext_list_price, i_current_price * s_tax_percentage ss_ext_tax, plin_coupon_amt ss_coupon_amt, (plin_sale_price * plin_quantity)-plin_coupon_amt ss_net_paid, ((plin_sale_price * plin_quantity)-plin_coupon_amt)*(1+s_tax_percentage) ss_net_paid_inc_tax, ((plin_sale_price * plin_quantity)-plin_coupon_amt)-(plin_quantity*i_wholesale_cost) ss_net_profit from s_purchase_m left outer join customer on (purc_customer_id = c_customer_id) left outer join store on (purc_store_id = s_store_id) left outer join date_dim on (to_date(purc_purchase_date,'YYYY-MM-DD') = d_date) left outer join time_dim on (PURC_PURCHASE_TIME = t_time), s_purchase_lineitem_m left outer join promotion on plin_promotion_id = p_promo_id left outer join item on plin_item_id = i_item_id where purc_purchase_id = plin_purchase_id and i_rec_end_date is NULL and s_rec_end_date is NULL; -- for now delete the rows that have lineitem = null --delete from ssv where ss_item_sk is null; select count(*) from ssv where ss_item_sk is null; -- for now delete pk violaters --delete from ssv where ss_ticket_number in (select ss_ticket_number from (select ss_ticket_number,ss_item_sk from ssv group by ss_ticket_number,ss_item_sk having count(*) > 1)); --select ss_ticket_number,ss_item_sk from ssv group by ss_ticket_number,ss_item_sk having count(*) > 1; select count(*) from s_purchase_m,s_purchase_lineitem_m where purc_purchase_id = plin_purchase_id; select count(*) from ssv; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_wr.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into web_returns (select * from wrv); rollback; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_wr_t.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ s_web_returns_m set wret_return_date = null where wret_return_date like '%-47%'; drop table wrv; create table wrv as select d_date_sk wr_return_date_sk ,t_time_sk wr_return_time_sk ,i_item_sk wr_item_sk ,c1.c_customer_sk wr_refunded_customer_sk ,c1.c_current_cdemo_sk wr_refunded_cdemo_sk ,c1.c_current_hdemo_sk wr_refunded_hdemo_sk ,c1.c_current_addr_sk wr_refunded_addr_sk ,c2.c_customer_sk wr_returning_customer_sk ,c2.c_current_cdemo_sk wr_returning_cdemo_sk ,c2.c_current_hdemo_sk wr_returning_hdemo_sk ,c2.c_current_addr_sk wr_returing_addr_sk ,wp_web_page_sk wr_web_page_sk ,r_reason_sk wr_reason_sk ,wret_order_id wr_order_number ,wret_return_qty wr_return_quantity ,wret_return_amt wr_return_amt ,wret_return_tax wr_return_tax ,wret_return_amt + wret_return_tax as wr_return_amt_inc_tax ,wret_return_fee wr_fee ,wret_return_ship_cost wr_return_ship_cost ,wret_refunded_cash wr_refunded_cash ,wret_reversed_charge wr_reversed_charde ,wret_account_credit wr_account_credit ,wret_return_amt+wret_return_tax+wret_return_fee -wret_refunded_cash-wret_reversed_charge-wret_account_credit wr_net_loss from s_web_returns_m left outer join date_dim on (to_date(wret_return_date,'YYYY-MM-DD') = d_date) left outer join time_dim on (( cast(substr(wret_return_time,1,2) as integer)*3600 +cast(substr(wret_return_time,4,2) as integer)*60 +cast(substr(wret_return_time,7,2) as integer)) = t_time) left outer join item on (wret_item_id = i_item_id) left outer join customer c1 on (wret_return_customer_id = c1.c_customer_id) left outer join customer c2 on (wret_refund_customer_id = c2.c_customer_id) left outer join reason on (wret_reason_id = r_reason_id) left outer join web_page on (wret_web_page_id = WP_WEB_PAGE_id) where i_rec_end_date is NULL and wp_rec_end_date is NULL; select count(*) from wrv where wr_item_sk is null; select count(*) from s_web_returns_m; select count(*) from wrv; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_ws.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ insert /*ICS5200_MONITOR_HINT*/ into web_sales (select * from wsv); rollback; ]
2018-08-14 14:30:03: Generating execution metrics for [lf_ws_t.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ update /*ICS5200_MONITOR_HINT*/ s_web_order_m set word_order_date = null where word_order_date like '%-47%'; update s_web_order_lineitem_m set wlin_ship_date = null where wlin_ship_date like '%-47%'; drop table wsv; create table wsv as select d1.d_date_sk ws_sold_date_sk, t_time_sk ws_sold_time_sk, d2.d_date_sk ws_ship_date_sk, i_item_sk ws_item_sk, c1.c_customer_sk ws_bill_customer_sk, c1.c_current_cdemo_sk ws_bill_cdemo_sk, c1.c_current_hdemo_sk ws_bill_hdemo_sk, c1.c_current_addr_sk ws_bill_addr_sk, c2.c_customer_sk ws_ship_customer_sk, c2.c_current_cdemo_sk ws_ship_cdemo_sk, c2.c_current_hdemo_sk ws_ship_hdemo_sk, c2.c_current_addr_sk ws_ship_addr_sk, web_site_sk ws_web_page_sk, wp_web_page_sk ws_web_site_s, sm_ship_mode_sk ws_ship_mode_sk, w_warehouse_sk ws_warehouse_sk, p_promo_sk ws_promo_sk, word_order_id ws_order_number, wlin_quantity ws_quantity, i_wholesale_cost ws_wholesale_cost, i_current_price ws_list_price, wlin_sales_price ws_sales_price, (i_current_price-wlin_sales_price)*wlin_quantity ws_ext_discount_amt, wlin_sales_price * wlin_quantity ws_ext_sales_price, i_wholesale_cost * wlin_quantity ws_ext_wholesale_cost, i_current_price * wlin_quantity ws_ext_list_price, i_current_price * web_tax_percentage ws_ext_tax, wlin_coupon_amt ws_coupon_amt, 0 WS_EXT_SHIP_COST, (wlin_sales_price * wlin_quantity)-wlin_coupon_amt ws_net_paid, ((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)*(1+web_tax_percentage) ws_net_paid_inc_tax, ((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(wlin_quantity*i_wholesale_cost) WS_NET_PAID_INC_SHIP, (wlin_sales_price * wlin_quantity)-wlin_coupon_amt + (wlin_ship_cost * wlin_quantity) + i_current_price * web_tax_percentage WS_NET_PAID_INC_SHIP_TAX, ((wlin_sales_price * wlin_quantity)-wlin_coupon_amt)-(i_wholesale_cost * wlin_quantity) WS_NET_PROFIT from s_web_order_m left outer join date_dim d1 on (to_date(word_order_date,'YYYY-MM-DD') = d1.d_date) left outer join time_dim on (word_order_time = t_time) left outer join customer c1 on (word_bill_customer_id = c1.c_customer_id) left outer join customer c2 on (word_ship_customer_id = c2.c_customer_id) left outer join web_site on (word_web_site_id = web_site_id) left outer join ship_mode on (word_ship_mode_id = sm_ship_mode_id), s_web_order_lineitem_m left outer join date_dim d2 on (to_date(wlin_ship_date,'YYYY-MM-DD') = d2.d_date) left outer join item on (wlin_item_id = i_item_id) left outer join web_page on (wlin_web_page_id = wp_web_page_id) left outer join warehouse on (wlin_warehouse_id = w_warehouse_id) left outer join promotion on (wlin_promotion_id = p_promo_id) where word_order_id = wlin_order_id and i_rec_end_date is NULL and web_rec_end_date is null and wp_rec_end_date is null; select count(*) from wsv where ws_item_sk is null; select count(*) from s_web_order_m,s_web_order_lineitem_m where word_order_id = wlin_order_id; select count(*) from wsv; ]
2018-08-14 14:30:03: Generating execution metrics for [promv_up.sql]..
2018-08-14 14:30:03: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_promotion; create table s_promotion as (select P_PROMO_ID PROM_PROMOTION_ID ,d1.d_date PROM_START_DATE ,d2.d_date PROM_END_DATE ,P_COST PROM_COST ,P_RESPONSE_TARGET PROM_RESPONSE_TARGET ,P_PROMO_NAME PROM_PROMO_NAME ,P_CHANNEL_DMAIL PROM_CHANNEL_DMAIL ,P_CHANNEL_EMAIL PROM_CHANNEL_EMAIL ,P_CHANNEL_CATALOG PROM_CHANNEL_CATALOG ,P_CHANNEL_TV PROM_CHANNEL_TV ,P_CHANNEL_RADIO PROM_CHANNEL_RADIO ,P_CHANNEL_PRESS PROM_CHANNEL_PRESS ,P_CHANNEL_EVENT PROM_CHANNEL_EVENT ,P_CHANNEL_DEMO PROM_CHANNEL_DEMO ,P_CHANNEL_DETAILS PROM_CHANNEL_DETAILS ,P_PURPOSE PROM_PURPOSE ,P_DISCOUNT_ACTIVE PROM_DISCOUNT_ACTIVE from promotion left outer join date_dim d1 on P_START_DATE_SK = d1.d_date_sk left outer join date_dim d2 on P_END_DATE_SK = d2.d_date_sk where rownum < 100 ); ]
2018-08-14 14:30:04: Generating execution metrics for [storv_up.sql]..
2018-08-14 14:30:04: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_store; create table s_store as select * from (select s_store_id stor_store_id --,stor_address_id --,stor_divison_id --,stor_opened_date ,d1.d_date stor_closed_date ,s_store_name stor_name --,stor_store_class ,s_number_employees stor_employees ,s_floor_space stor_floor_space ,s_hours stor_hours ,s_market_manager stor_market_manager ,s_manager stor_store_manager ,s_market_id stor_market_id ,s_geography_class stor_geography_class ,s_tax_precentage stor_tax_percentage from store ,date_dim d1 where d_date_sk = s_closed_date_sk and s_rec_end_date is null) where rownum < 4; ]
2018-08-14 14:30:04: Generating execution metrics for [websv_up.sql]..
2018-08-14 14:30:04: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_web_site; create table s_web_site as select * from (select web_site_id wsit_web_site_id ,d1.d_date wsit_open_date ,d2.d_date wsit_closed_date ,web_name wsit_site_name ,web_class wsit_site_class ,web_manager wsit_site_manager ,web_tax_percentage wsit_tax_percentage from web_site ,date_dim d1 ,date_dim d2 where web_open_date_sk = d1.d_date_sk and web_close_date_sk = d2.d_date_sk and web_rec_end_date is null) where rownum < 6; ]
2018-08-14 14:30:04: Generating execution metrics for [webv_up.sql]..
2018-08-14 14:30:04: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_web_page; create table s_web_page as (select WP_WEB_PAGE_ID WPAG_WEB_PAGE_ID ,d1.d_date WPAG_CREATE_DATE ,d2.d_date WPAG_ACCESS_DATE ,WP_AUTOGEN_FLAG WPAG_AUTOGEN_FLAG ,WP_URL WPAG_URL ,WP_TYPE WPAG_TYPE ,WP_CHAR_COUNT WPAG_CHAR_COUNT ,WP_LINK_COUNT WPAG_LINK_COUNT ,WP_IMAGE_COUNT WPAG_IMAGE_COUNT ,WP_MAX_AD_COUNT WPAG_MAX_AD_COUNT from web_page left outer join date_dim d1 on wp_creation_date_sk = d1.d_date_sk left outer join date_dim d2 on wp_access_date_sk = d2.d_date_sk where wp_rec_end_date is null -- need this to eliminate duplicates and rownum < 10 ); ]
2018-08-14 14:30:04: Generating execution metrics for [wrhsv_up.sql]..
2018-08-14 14:30:04: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ drop /*ICS5200_MONITOR_HINT*/ table s_warehouse; create table s_warehouse as (select W_WAREHOUSE_ID WRHS_WAREHOUSE_ID ,W_WAREHOUSE_name WRHS_WAREHOUSE_DESC ,W_WAREHOUSE_SQ_FT WRHS_WAREHOUSE_SQ_FT from warehouse where rownum < 10); ]
2018-08-14 14:30:04: Executed iteration [1] of gathered stats benchmark
2018-08-14 17:34:52: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:34:52: Connection pool instantiated with [1] connections
2018-08-14 17:35:10: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:35:10: Connection pool instantiated with [1] connections
2018-08-14 17:36:28: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:36:28: Connection pool instantiated with [1] connections
2018-08-14 17:36:30: ('spark.cores.max', '20')
2018-08-14 17:36:30: ('spark.executor.memory', '2g')
2018-08-14 17:36:30: ('spark.app.id', 'app-20180814173630-0000')
2018-08-14 17:36:30: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 17:36:30: ('spark.executor.id', 'driver')
2018-08-14 17:36:30: ('spark.python.worker.reuse', 'True')
2018-08-14 17:36:30: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:36:30: ('spark.default.parallelism', '80')
2018-08-14 17:36:30: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:36:30: ('spark.executor.instances', '20')
2018-08-14 17:36:30: ('spark.driver.port', '27479')
2018-08-14 17:36:30: ('spark.logConf', 'False')
2018-08-14 17:36:30: ('spark.rdd.compress', 'True')
2018-08-14 17:36:30: ('spark.driver.memory', '2g')
2018-08-14 17:36:30: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:36:30: ('spark.executor.cores', '1')
2018-08-14 17:36:30: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:36:30: ('spark.submit.deployMode', 'client')
2018-08-14 17:36:30: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:36:30: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:36:30: ('spark.app.name', 'ICS5200')
2018-08-14 17:36:30: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 17:36:30: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 17:36:30: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 17:36:30: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 17:36:30: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 17:36:30: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 17:36:30: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 17:36:30: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 17:36:31: Successfully finished migrating DML scripts!
2018-08-14 17:36:31: Starting TPC-DS sql splitting
2018-08-14 17:36:31: Generated query_1.sql
2018-08-14 17:36:31: Generated query_2.sql
2018-08-14 17:36:31: Generated query_3.sql
2018-08-14 17:36:31: Generated query_4.sql
2018-08-14 17:36:31: Generated query_5.sql
2018-08-14 17:36:31: Generated query_6.sql
2018-08-14 17:36:31: Generated query_7.sql
2018-08-14 17:36:31: Generated query_8.sql
2018-08-14 17:36:31: Generated query_9.sql
2018-08-14 17:36:31: Generated query_10.sql
2018-08-14 17:36:31: Generated query_11.sql
2018-08-14 17:36:31: Generated query_12.sql
2018-08-14 17:36:31: Generated query_13.sql
2018-08-14 17:36:31: Generated query_14.sql
2018-08-14 17:36:31: Generated query_15.sql
2018-08-14 17:36:31: Generated query_16.sql
2018-08-14 17:36:31: Generated query_17.sql
2018-08-14 17:36:31: Generated query_18.sql
2018-08-14 17:36:31: Generated query_19.sql
2018-08-14 17:36:31: Generated query_20.sql
2018-08-14 17:36:31: Generated query_21.sql
2018-08-14 17:36:31: Generated query_22.sql
2018-08-14 17:36:31: Generated query_23.sql
2018-08-14 17:36:31: Generated query_24.sql
2018-08-14 17:36:31: Generated query_25.sql
2018-08-14 17:36:31: Generated query_26.sql
2018-08-14 17:36:31: Generated query_27.sql
2018-08-14 17:36:31: Generated query_28.sql
2018-08-14 17:36:31: Generated query_29.sql
2018-08-14 17:36:31: Generated query_30.sql
2018-08-14 17:36:31: Generated query_31.sql
2018-08-14 17:36:31: Generated query_32.sql
2018-08-14 17:36:31: Generated query_33.sql
2018-08-14 17:36:31: Generated query_34.sql
2018-08-14 17:36:31: Generated query_35.sql
2018-08-14 17:36:31: Generated query_36.sql
2018-08-14 17:36:31: Generated query_37.sql
2018-08-14 17:36:31: Generated query_38.sql
2018-08-14 17:36:31: Generated query_39.sql
2018-08-14 17:36:31: Generated query_40.sql
2018-08-14 17:36:31: Generated query_41.sql
2018-08-14 17:36:31: Generated query_42.sql
2018-08-14 17:36:31: Generated query_43.sql
2018-08-14 17:36:31: Generated query_44.sql
2018-08-14 17:36:31: Generated query_45.sql
2018-08-14 17:36:31: Generated query_46.sql
2018-08-14 17:36:31: Generated query_47.sql
2018-08-14 17:36:31: Generated query_48.sql
2018-08-14 17:36:31: Generated query_49.sql
2018-08-14 17:36:31: Generated query_50.sql
2018-08-14 17:36:31: Generated query_51.sql
2018-08-14 17:36:31: Generated query_52.sql
2018-08-14 17:36:31: Generated query_53.sql
2018-08-14 17:36:31: Generated query_54.sql
2018-08-14 17:36:31: Generated query_55.sql
2018-08-14 17:36:31: Generated query_56.sql
2018-08-14 17:36:31: Generated query_57.sql
2018-08-14 17:36:31: Generated query_58.sql
2018-08-14 17:36:31: Generated query_59.sql
2018-08-14 17:36:31: Generated query_60.sql
2018-08-14 17:36:31: Generated query_61.sql
2018-08-14 17:36:31: Generated query_62.sql
2018-08-14 17:36:31: Generated query_63.sql
2018-08-14 17:36:31: Generated query_64.sql
2018-08-14 17:36:31: Generated query_65.sql
2018-08-14 17:36:31: Generated query_66.sql
2018-08-14 17:36:31: Generated query_67.sql
2018-08-14 17:36:31: Generated query_68.sql
2018-08-14 17:36:31: Generated query_69.sql
2018-08-14 17:36:31: Generated query_70.sql
2018-08-14 17:36:31: Generated query_71.sql
2018-08-14 17:36:31: Generated query_72.sql
2018-08-14 17:36:31: Generated query_73.sql
2018-08-14 17:36:31: Generated query_74.sql
2018-08-14 17:36:31: Generated query_75.sql
2018-08-14 17:36:31: Generated query_76.sql
2018-08-14 17:36:31: Generated query_77.sql
2018-08-14 17:36:31: Generated query_78.sql
2018-08-14 17:36:31: Generated query_79.sql
2018-08-14 17:36:31: Generated query_80.sql
2018-08-14 17:36:31: Generated query_81.sql
2018-08-14 17:36:31: Generated query_82.sql
2018-08-14 17:36:31: Generated query_83.sql
2018-08-14 17:36:31: Generated query_84.sql
2018-08-14 17:36:31: Generated query_85.sql
2018-08-14 17:36:31: Generated query_86.sql
2018-08-14 17:36:31: Generated query_87.sql
2018-08-14 17:36:31: Generated query_88.sql
2018-08-14 17:36:31: Generated query_89.sql
2018-08-14 17:36:31: Generated query_90.sql
2018-08-14 17:36:31: Generated query_91.sql
2018-08-14 17:36:31: Generated query_92.sql
2018-08-14 17:36:31: Generated query_93.sql
2018-08-14 17:36:31: Generated query_94.sql
2018-08-14 17:36:31: Generated query_95.sql
2018-08-14 17:36:31: Generated query_96.sql
2018-08-14 17:36:31: Generated query_97.sql
2018-08-14 17:36:31: Generated query_98.sql
2018-08-14 17:36:31: Generated query_99.sql
2018-08-14 17:36:31: Generated query_100.sql
2018-08-14 17:36:31: Generated query_101.sql
2018-08-14 17:36:31: Generated query_102.sql
2018-08-14 17:36:31: Generated query_103.sql
2018-08-14 17:36:31: Generated query_104.sql
2018-08-14 17:36:31: Script Complete!
-------------------------------------
2018-08-14 17:36:50: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:36:50: Connection pool instantiated with [1] connections
2018-08-14 17:36:52: ('spark.cores.max', '20')
2018-08-14 17:36:52: ('spark.executor.memory', '2g')
2018-08-14 17:36:52: ('spark.driver.port', '11822')
2018-08-14 17:36:52: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 17:36:52: ('spark.app.id', 'app-20180814173652-0001')
2018-08-14 17:36:52: ('spark.executor.id', 'driver')
2018-08-14 17:36:52: ('spark.python.worker.reuse', 'True')
2018-08-14 17:36:52: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:36:52: ('spark.default.parallelism', '80')
2018-08-14 17:36:52: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:36:52: ('spark.executor.instances', '20')
2018-08-14 17:36:52: ('spark.logConf', 'False')
2018-08-14 17:36:52: ('spark.rdd.compress', 'True')
2018-08-14 17:36:52: ('spark.driver.memory', '2g')
2018-08-14 17:36:52: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:36:52: ('spark.executor.cores', '1')
2018-08-14 17:36:52: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:36:52: ('spark.submit.deployMode', 'client')
2018-08-14 17:36:52: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:36:52: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:36:52: ('spark.app.name', 'ICS5200')
2018-08-14 17:36:53: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 17:36:53: Generating execution metrics for [query_1.sql]..
2018-08-14 17:36:53: Generating execution metrics for [query_2.sql]..
2018-08-14 17:36:53: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 17:36:53: Generating execution metrics for [query_3.sql]..
2018-08-14 17:36:54: Generating execution metrics for [query_4.sql]..
2018-08-14 17:37:00: Generating execution metrics for [query_5.sql]..
2018-08-14 17:37:03: Generating execution metrics for [query_6.sql]..
2018-08-14 17:37:03: Generating execution metrics for [query_7.sql]..
2018-08-14 17:37:04: Generating execution metrics for [query_8.sql]..
2018-08-14 17:37:04: Generating execution metrics for [query_9.sql]..
2018-08-14 17:37:06: Generating execution metrics for [query_10.sql]..
2018-08-14 17:37:07: Generating execution metrics for [query_11.sql]..
2018-08-14 17:37:09: Generating execution metrics for [query_12.sql]..
2018-08-14 17:37:09: Generating execution metrics for [query_13.sql]..
2018-08-14 17:37:12: Generating execution metrics for [query_14.sql]..
2018-08-14 17:37:16: Generating execution metrics for [query_15.sql]..
2018-08-14 17:37:16: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 17:37:16: Generating execution metrics for [query_16.sql]..
2018-08-14 17:37:16: Generating execution metrics for [query_17.sql]..
2018-08-14 17:37:16: Generating execution metrics for [query_18.sql]..
2018-08-14 17:37:17: Generating execution metrics for [query_19.sql]..
2018-08-14 17:37:17: Generating execution metrics for [query_20.sql]..
2018-08-14 17:37:17: Generating execution metrics for [query_21.sql]..
2018-08-14 17:37:17: Generating execution metrics for [query_22.sql]..
2018-08-14 17:37:17: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_char(to_date(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_char(to_date(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 17:37:17: Generating execution metrics for [query_23.sql]..
2018-08-14 17:37:22: Generating execution metrics for [query_24.sql]..
2018-08-14 17:37:29: Generating execution metrics for [query_25.sql]..
2018-08-14 17:37:35: Generating execution metrics for [query_26.sql]..
2018-08-14 17:37:35: Generating execution metrics for [query_27.sql]..
2018-08-14 17:37:35: Generating execution metrics for [query_28.sql]..
2018-08-14 17:37:35: Generating execution metrics for [query_29.sql]..
2018-08-14 17:37:36: Generating execution metrics for [query_30.sql]..
2018-08-14 17:37:36: Generating execution metrics for [query_31.sql]..
2018-08-14 17:37:38: Generating execution metrics for [query_32.sql]..
2018-08-14 17:37:38: Generating execution metrics for [query_33.sql]..
2018-08-14 17:37:38: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 17:37:38: Generating execution metrics for [query_34.sql]..
2018-08-14 17:37:39: Generating execution metrics for [query_35.sql]..
2018-08-14 17:37:40: Generating execution metrics for [query_36.sql]..
2018-08-14 17:37:40: Generating execution metrics for [query_37.sql]..
2018-08-14 17:37:40: Generating execution metrics for [query_38.sql]..
2018-08-14 17:38:23: Generating execution metrics for [query_39.sql]..
2018-08-14 17:38:23: Generating execution metrics for [query_40.sql]..
2018-08-14 17:38:24: Generating execution metrics for [query_41.sql]..
2018-08-14 17:38:24: Generating execution metrics for [query_42.sql]..
2018-08-14 17:38:27: Generating execution metrics for [query_43.sql]..
2018-08-14 17:38:30: Generating execution metrics for [query_44.sql]..
2018-08-14 17:38:30: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (to_char(to_date(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (to_char(to_date(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (to_char(to_date('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 17:38:31: Generating execution metrics for [query_45.sql]..
2018-08-14 17:38:31: Generating execution metrics for [query_46.sql]..
2018-08-14 17:38:31: Generating execution metrics for [query_47.sql]..
2018-08-14 17:38:31: Generating execution metrics for [query_48.sql]..
2018-08-14 17:38:32: Generating execution metrics for [query_49.sql]..
2018-08-14 17:38:33: Generating execution metrics for [query_50.sql]..
2018-08-14 17:38:34: Generating execution metrics for [query_51.sql]..
2018-08-14 17:38:36: Generating execution metrics for [query_52.sql]..
2018-08-14 17:49:35: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:49:35: Connection pool instantiated with [1] connections
2018-08-14 17:49:37: ('spark.cores.max', '20')
2018-08-14 17:49:37: ('spark.executor.memory', '2g')
2018-08-14 17:49:37: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 17:49:37: ('spark.executor.id', 'driver')
2018-08-14 17:49:37: ('spark.python.worker.reuse', 'True')
2018-08-14 17:49:37: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:49:37: ('spark.default.parallelism', '80')
2018-08-14 17:49:37: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:49:37: ('spark.executor.instances', '20')
2018-08-14 17:49:37: ('spark.app.id', 'app-20180814174937-0002')
2018-08-14 17:49:37: ('spark.logConf', 'False')
2018-08-14 17:49:37: ('spark.driver.port', '17254')
2018-08-14 17:49:37: ('spark.rdd.compress', 'True')
2018-08-14 17:49:37: ('spark.driver.memory', '2g')
2018-08-14 17:49:37: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:49:37: ('spark.executor.cores', '1')
2018-08-14 17:49:37: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:49:37: ('spark.submit.deployMode', 'client')
2018-08-14 17:49:37: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:49:37: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:49:37: ('spark.app.name', 'ICS5200')
2018-08-14 17:49:38: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 17:49:38: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 17:49:38: Successfully finished migrating DML scripts!
2018-08-14 17:49:38: Starting TPC-DS sql splitting
2018-08-14 17:49:38: Generated query_1.sql
2018-08-14 17:49:38: Generated query_2.sql
2018-08-14 17:49:38: Generated query_3.sql
2018-08-14 17:49:38: Generated query_4.sql
2018-08-14 17:49:38: Generated query_5.sql
2018-08-14 17:49:38: Generated query_6.sql
2018-08-14 17:49:38: Generated query_7.sql
2018-08-14 17:49:38: Generated query_8.sql
2018-08-14 17:49:38: Generated query_9.sql
2018-08-14 17:49:38: Generated query_10.sql
2018-08-14 17:49:38: Generated query_11.sql
2018-08-14 17:49:38: Generated query_12.sql
2018-08-14 17:49:38: Generated query_13.sql
2018-08-14 17:49:38: Generated query_14.sql
2018-08-14 17:49:38: Generated query_15.sql
2018-08-14 17:49:38: Generated query_16.sql
2018-08-14 17:49:38: Generated query_17.sql
2018-08-14 17:49:38: Generated query_18.sql
2018-08-14 17:49:38: Generated query_19.sql
2018-08-14 17:49:38: Generated query_20.sql
2018-08-14 17:49:38: Generated query_21.sql
2018-08-14 17:49:38: Generated query_22.sql
2018-08-14 17:49:38: Generated query_23.sql
2018-08-14 17:49:38: Generated query_24.sql
2018-08-14 17:49:38: Generated query_25.sql
2018-08-14 17:49:38: Generated query_26.sql
2018-08-14 17:49:38: Generated query_27.sql
2018-08-14 17:49:38: Generated query_28.sql
2018-08-14 17:49:38: Generated query_29.sql
2018-08-14 17:49:38: Generated query_30.sql
2018-08-14 17:49:38: Generated query_31.sql
2018-08-14 17:49:38: Generated query_32.sql
2018-08-14 17:49:38: Generated query_33.sql
2018-08-14 17:49:38: Generated query_34.sql
2018-08-14 17:49:38: Generated query_35.sql
2018-08-14 17:49:38: Generated query_36.sql
2018-08-14 17:49:38: Generated query_37.sql
2018-08-14 17:49:38: Generated query_38.sql
2018-08-14 17:49:38: Generated query_39.sql
2018-08-14 17:49:38: Generated query_40.sql
2018-08-14 17:49:38: Generated query_41.sql
2018-08-14 17:49:38: Generated query_42.sql
2018-08-14 17:49:38: Generated query_43.sql
2018-08-14 17:49:38: Generated query_44.sql
2018-08-14 17:49:38: Generated query_45.sql
2018-08-14 17:49:38: Generated query_46.sql
2018-08-14 17:49:38: Generated query_47.sql
2018-08-14 17:49:38: Generated query_48.sql
2018-08-14 17:49:38: Generated query_49.sql
2018-08-14 17:49:38: Generated query_50.sql
2018-08-14 17:49:38: Generated query_51.sql
2018-08-14 17:49:38: Generated query_52.sql
2018-08-14 17:49:38: Generated query_53.sql
2018-08-14 17:49:38: Generated query_54.sql
2018-08-14 17:49:38: Generated query_55.sql
2018-08-14 17:49:38: Generated query_56.sql
2018-08-14 17:49:38: Generated query_57.sql
2018-08-14 17:49:38: Generated query_58.sql
2018-08-14 17:49:38: Generated query_59.sql
2018-08-14 17:49:38: Generated query_60.sql
2018-08-14 17:49:38: Generated query_61.sql
2018-08-14 17:49:38: Generated query_62.sql
2018-08-14 17:49:38: Generated query_63.sql
2018-08-14 17:49:38: Generated query_64.sql
2018-08-14 17:49:38: Generated query_65.sql
2018-08-14 17:49:38: Generated query_66.sql
2018-08-14 17:49:38: Generated query_67.sql
2018-08-14 17:49:38: Generated query_68.sql
2018-08-14 17:49:38: Generated query_69.sql
2018-08-14 17:49:38: Generated query_70.sql
2018-08-14 17:49:38: Generated query_71.sql
2018-08-14 17:49:38: Generated query_72.sql
2018-08-14 17:49:38: Generated query_73.sql
2018-08-14 17:49:38: Generated query_74.sql
2018-08-14 17:49:38: Generated query_75.sql
2018-08-14 17:49:38: Generated query_76.sql
2018-08-14 17:49:38: Generated query_77.sql
2018-08-14 17:49:38: Generated query_78.sql
2018-08-14 17:49:38: Generated query_79.sql
2018-08-14 17:49:38: Generated query_80.sql
2018-08-14 17:49:38: Generated query_81.sql
2018-08-14 17:49:38: Generated query_82.sql
2018-08-14 17:49:38: Generated query_83.sql
2018-08-14 17:49:38: Generated query_84.sql
2018-08-14 17:49:38: Generated query_85.sql
2018-08-14 17:49:38: Generated query_86.sql
2018-08-14 17:49:38: Generated query_87.sql
2018-08-14 17:49:38: Generated query_88.sql
2018-08-14 17:49:38: Generated query_89.sql
2018-08-14 17:49:38: Generated query_90.sql
2018-08-14 17:49:38: Generated query_91.sql
2018-08-14 17:49:38: Generated query_92.sql
2018-08-14 17:49:38: Generated query_93.sql
2018-08-14 17:49:38: Generated query_94.sql
2018-08-14 17:49:38: Generated query_95.sql
2018-08-14 17:49:38: Generated query_96.sql
2018-08-14 17:49:38: Generated query_97.sql
2018-08-14 17:49:38: Generated query_98.sql
2018-08-14 17:49:38: Generated query_99.sql
2018-08-14 17:49:38: Generated query_100.sql
2018-08-14 17:49:38: Generated query_101.sql
2018-08-14 17:49:38: Generated query_102.sql
2018-08-14 17:49:38: Generated query_103.sql
2018-08-14 17:49:38: Generated query_104.sql
2018-08-14 17:49:38: Script Complete!
-------------------------------------
2018-08-14 17:49:42: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:49:42: Connection pool instantiated with [1] connections
2018-08-14 17:49:44: ('spark.cores.max', '20')
2018-08-14 17:49:44: ('spark.executor.memory', '2g')
2018-08-14 17:49:44: ('spark.executor.id', 'driver')
2018-08-14 17:49:44: ('spark.python.worker.reuse', 'True')
2018-08-14 17:49:44: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:49:44: ('spark.default.parallelism', '80')
2018-08-14 17:49:44: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:49:44: ('spark.driver.port', '33237')
2018-08-14 17:49:44: ('spark.executor.instances', '20')
2018-08-14 17:49:44: ('spark.app.id', 'app-20180814174944-0003')
2018-08-14 17:49:44: ('spark.logConf', 'False')
2018-08-14 17:49:44: ('spark.rdd.compress', 'True')
2018-08-14 17:49:44: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 17:49:44: ('spark.driver.memory', '2g')
2018-08-14 17:49:44: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:49:44: ('spark.executor.cores', '1')
2018-08-14 17:49:44: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:49:44: ('spark.submit.deployMode', 'client')
2018-08-14 17:49:44: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:49:44: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:49:44: ('spark.app.name', 'ICS5200')
2018-08-14 17:49:45: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 17:49:45: Generating execution metrics for [query_2.sql]..
2018-08-14 17:49:45: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 17:49:45: Generating execution metrics for [query_3.sql]..
2018-08-14 17:49:45: Generating execution metrics for [query_4.sql]..
2018-08-14 17:49:52: Generating execution metrics for [query_5.sql]..
2018-08-14 17:49:55: Generating execution metrics for [query_6.sql]..
2018-08-14 17:49:55: Generating execution metrics for [query_7.sql]..
2018-08-14 17:49:55: Generating execution metrics for [query_8.sql]..
2018-08-14 17:49:56: Generating execution metrics for [query_9.sql]..
2018-08-14 17:49:58: Generating execution metrics for [query_10.sql]..
2018-08-14 17:49:58: Generating execution metrics for [query_11.sql]..
2018-08-14 17:50:00: Generating execution metrics for [query_12.sql]..
2018-08-14 17:50:01: Generating execution metrics for [query_13.sql]..
2018-08-14 17:50:04: Generating execution metrics for [query_14.sql]..
2018-08-14 17:50:07: Generating execution metrics for [query_15.sql]..
2018-08-14 17:50:07: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 17:50:07: Generating execution metrics for [query_16.sql]..
2018-08-14 17:50:07: Generating execution metrics for [query_17.sql]..
2018-08-14 17:50:07: Generating execution metrics for [query_18.sql]..
2018-08-14 17:50:08: Generating execution metrics for [query_19.sql]..
2018-08-14 17:50:08: Generating execution metrics for [query_20.sql]..
2018-08-14 17:50:09: Generating execution metrics for [query_21.sql]..
2018-08-14 17:50:09: Generating execution metrics for [query_22.sql]..
2018-08-14 17:50:09: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd)' < to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd)' >= to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 17:50:09: Generating execution metrics for [query_23.sql]..
2018-08-14 17:50:14: Generating execution metrics for [query_24.sql]..
2018-08-14 17:50:20: Generating execution metrics for [query_25.sql]..
2018-08-14 17:50:25: Generating execution metrics for [query_26.sql]..
2018-08-14 17:50:26: Generating execution metrics for [query_27.sql]..
2018-08-14 17:50:26: Generating execution metrics for [query_28.sql]..
2018-08-14 17:50:26: Generating execution metrics for [query_29.sql]..
2018-08-14 17:50:26: Generating execution metrics for [query_30.sql]..
2018-08-14 17:50:27: Generating execution metrics for [query_31.sql]..
2018-08-14 17:50:28: Generating execution metrics for [query_32.sql]..
2018-08-14 17:50:29: Generating execution metrics for [query_33.sql]..
2018-08-14 17:50:29: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 17:50:29: Generating execution metrics for [query_34.sql]..
2018-08-14 17:50:30: Generating execution metrics for [query_35.sql]..
2018-08-14 17:50:30: Generating execution metrics for [query_36.sql]..
2018-08-14 17:50:30: Generating execution metrics for [query_37.sql]..
2018-08-14 17:50:31: Generating execution metrics for [query_38.sql]..
2018-08-14 17:51:14: Generating execution metrics for [query_39.sql]..
2018-08-14 17:51:15: Generating execution metrics for [query_40.sql]..
2018-08-14 17:51:15: Generating execution metrics for [query_41.sql]..
2018-08-14 17:51:15: Generating execution metrics for [query_42.sql]..
2018-08-14 17:51:18: Generating execution metrics for [query_43.sql]..
2018-08-14 17:51:21: Generating execution metrics for [query_44.sql]..
2018-08-14 17:51:21: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd)' < to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd)' >= to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (to_char(to_date('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 17:51:21: Generating execution metrics for [query_45.sql]..
2018-08-14 17:51:22: Generating execution metrics for [query_46.sql]..
2018-08-14 17:51:22: Generating execution metrics for [query_47.sql]..
2018-08-14 17:51:22: Generating execution metrics for [query_48.sql]..
2018-08-14 17:51:23: Generating execution metrics for [query_49.sql]..
2018-08-14 17:51:23: Generating execution metrics for [query_50.sql]..
2018-08-14 17:51:25: Generating execution metrics for [query_51.sql]..
2018-08-14 17:53:12: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:53:12: Connection pool instantiated with [1] connections
2018-08-14 17:53:15: ('spark.cores.max', '20')
2018-08-14 17:53:15: ('spark.driver.port', '10105')
2018-08-14 17:53:15: ('spark.executor.memory', '2g')
2018-08-14 17:53:15: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 17:53:15: ('spark.app.id', 'app-20180814175315-0004')
2018-08-14 17:53:15: ('spark.executor.id', 'driver')
2018-08-14 17:53:15: ('spark.python.worker.reuse', 'True')
2018-08-14 17:53:15: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:53:15: ('spark.default.parallelism', '80')
2018-08-14 17:53:15: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:53:15: ('spark.executor.instances', '20')
2018-08-14 17:53:15: ('spark.logConf', 'False')
2018-08-14 17:53:15: ('spark.rdd.compress', 'True')
2018-08-14 17:53:15: ('spark.driver.memory', '2g')
2018-08-14 17:53:15: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:53:15: ('spark.executor.cores', '1')
2018-08-14 17:53:15: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:53:15: ('spark.submit.deployMode', 'client')
2018-08-14 17:53:15: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:53:15: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:53:15: ('spark.app.name', 'ICS5200')
2018-08-14 17:53:15: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 17:53:15: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 17:53:15: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 17:53:16: Successfully finished migrating DML scripts!
2018-08-14 17:53:16: Starting TPC-DS sql splitting
2018-08-14 17:53:16: Generated query_1.sql
2018-08-14 17:53:16: Generated query_2.sql
2018-08-14 17:53:16: Generated query_3.sql
2018-08-14 17:53:16: Generated query_4.sql
2018-08-14 17:53:16: Generated query_5.sql
2018-08-14 17:53:16: Generated query_6.sql
2018-08-14 17:53:16: Generated query_7.sql
2018-08-14 17:53:16: Generated query_8.sql
2018-08-14 17:53:16: Generated query_9.sql
2018-08-14 17:53:16: Generated query_10.sql
2018-08-14 17:53:16: Generated query_11.sql
2018-08-14 17:53:16: Generated query_12.sql
2018-08-14 17:53:16: Generated query_13.sql
2018-08-14 17:53:16: Generated query_14.sql
2018-08-14 17:53:16: Generated query_15.sql
2018-08-14 17:53:16: Generated query_16.sql
2018-08-14 17:53:16: Generated query_17.sql
2018-08-14 17:53:16: Generated query_18.sql
2018-08-14 17:53:16: Generated query_19.sql
2018-08-14 17:53:16: Generated query_20.sql
2018-08-14 17:53:16: Generated query_21.sql
2018-08-14 17:53:16: Generated query_22.sql
2018-08-14 17:53:16: Generated query_23.sql
2018-08-14 17:53:16: Generated query_24.sql
2018-08-14 17:53:16: Generated query_25.sql
2018-08-14 17:53:16: Generated query_26.sql
2018-08-14 17:53:16: Generated query_27.sql
2018-08-14 17:53:16: Generated query_28.sql
2018-08-14 17:53:16: Generated query_29.sql
2018-08-14 17:53:16: Generated query_30.sql
2018-08-14 17:53:16: Generated query_31.sql
2018-08-14 17:53:16: Generated query_32.sql
2018-08-14 17:53:16: Generated query_33.sql
2018-08-14 17:53:16: Generated query_34.sql
2018-08-14 17:53:16: Generated query_35.sql
2018-08-14 17:53:16: Generated query_36.sql
2018-08-14 17:53:16: Generated query_37.sql
2018-08-14 17:53:16: Generated query_38.sql
2018-08-14 17:53:16: Generated query_39.sql
2018-08-14 17:53:16: Generated query_40.sql
2018-08-14 17:53:16: Generated query_41.sql
2018-08-14 17:53:16: Generated query_42.sql
2018-08-14 17:53:16: Generated query_43.sql
2018-08-14 17:53:16: Generated query_44.sql
2018-08-14 17:53:16: Generated query_45.sql
2018-08-14 17:53:16: Generated query_46.sql
2018-08-14 17:53:16: Generated query_47.sql
2018-08-14 17:53:16: Generated query_48.sql
2018-08-14 17:53:16: Generated query_49.sql
2018-08-14 17:53:16: Generated query_50.sql
2018-08-14 17:53:16: Generated query_51.sql
2018-08-14 17:53:16: Generated query_52.sql
2018-08-14 17:53:16: Generated query_53.sql
2018-08-14 17:53:16: Generated query_54.sql
2018-08-14 17:53:16: Generated query_55.sql
2018-08-14 17:53:16: Generated query_56.sql
2018-08-14 17:53:16: Generated query_57.sql
2018-08-14 17:53:16: Generated query_58.sql
2018-08-14 17:53:16: Generated query_59.sql
2018-08-14 17:53:16: Generated query_60.sql
2018-08-14 17:53:16: Generated query_61.sql
2018-08-14 17:53:16: Generated query_62.sql
2018-08-14 17:53:16: Generated query_63.sql
2018-08-14 17:53:16: Generated query_64.sql
2018-08-14 17:53:16: Generated query_65.sql
2018-08-14 17:53:16: Generated query_66.sql
2018-08-14 17:53:16: Generated query_67.sql
2018-08-14 17:53:16: Generated query_68.sql
2018-08-14 17:53:16: Generated query_69.sql
2018-08-14 17:53:16: Generated query_70.sql
2018-08-14 17:53:16: Generated query_71.sql
2018-08-14 17:53:16: Generated query_72.sql
2018-08-14 17:53:16: Generated query_73.sql
2018-08-14 17:53:16: Generated query_74.sql
2018-08-14 17:53:16: Generated query_75.sql
2018-08-14 17:53:16: Generated query_76.sql
2018-08-14 17:53:16: Generated query_77.sql
2018-08-14 17:53:16: Generated query_78.sql
2018-08-14 17:53:16: Generated query_79.sql
2018-08-14 17:53:16: Generated query_80.sql
2018-08-14 17:53:16: Generated query_81.sql
2018-08-14 17:53:16: Generated query_82.sql
2018-08-14 17:53:16: Generated query_83.sql
2018-08-14 17:53:16: Generated query_84.sql
2018-08-14 17:53:16: Generated query_85.sql
2018-08-14 17:53:16: Generated query_86.sql
2018-08-14 17:53:16: Generated query_87.sql
2018-08-14 17:53:16: Generated query_88.sql
2018-08-14 17:53:16: Generated query_89.sql
2018-08-14 17:53:16: Generated query_90.sql
2018-08-14 17:53:16: Generated query_91.sql
2018-08-14 17:53:16: Generated query_92.sql
2018-08-14 17:53:16: Generated query_93.sql
2018-08-14 17:53:16: Generated query_94.sql
2018-08-14 17:53:16: Generated query_95.sql
2018-08-14 17:53:16: Generated query_96.sql
2018-08-14 17:53:16: Generated query_97.sql
2018-08-14 17:53:16: Generated query_98.sql
2018-08-14 17:53:16: Generated query_99.sql
2018-08-14 17:53:16: Generated query_100.sql
2018-08-14 17:53:16: Generated query_101.sql
2018-08-14 17:53:16: Generated query_102.sql
2018-08-14 17:53:16: Generated query_103.sql
2018-08-14 17:53:16: Generated query_104.sql
2018-08-14 17:53:16: Script Complete!
-------------------------------------
2018-08-14 17:53:18: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:53:18: Connection pool instantiated with [1] connections
2018-08-14 17:53:21: ('spark.cores.max', '20')
2018-08-14 17:53:21: ('spark.executor.memory', '2g')
2018-08-14 17:53:21: ('spark.app.id', 'app-20180814175320-0005')
2018-08-14 17:53:21: ('spark.driver.port', '34272')
2018-08-14 17:53:21: ('spark.executor.id', 'driver')
2018-08-14 17:53:21: ('spark.python.worker.reuse', 'True')
2018-08-14 17:53:21: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:53:21: ('spark.default.parallelism', '80')
2018-08-14 17:53:21: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:53:21: ('spark.executor.instances', '20')
2018-08-14 17:53:21: ('spark.logConf', 'False')
2018-08-14 17:53:21: ('spark.rdd.compress', 'True')
2018-08-14 17:53:21: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 17:53:21: ('spark.driver.memory', '2g')
2018-08-14 17:53:21: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:53:21: ('spark.executor.cores', '1')
2018-08-14 17:53:21: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:53:21: ('spark.submit.deployMode', 'client')
2018-08-14 17:53:21: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:53:21: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:53:21: ('spark.app.name', 'ICS5200')
2018-08-14 17:53:21: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 17:53:21: Generating execution metrics for [query_2.sql]..
2018-08-14 17:53:21: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 17:53:21: Generating execution metrics for [query_3.sql]..
2018-08-14 17:53:21: Generating execution metrics for [query_4.sql]..
2018-08-14 17:53:28: Generating execution metrics for [query_5.sql]..
2018-08-14 17:53:31: Generating execution metrics for [query_6.sql]..
2018-08-14 17:53:32: Generating execution metrics for [query_7.sql]..
2018-08-14 17:53:32: Generating execution metrics for [query_8.sql]..
2018-08-14 17:53:32: Generating execution metrics for [query_9.sql]..
2018-08-14 17:53:34: Generating execution metrics for [query_10.sql]..
2018-08-14 17:53:35: Generating execution metrics for [query_11.sql]..
2018-08-14 17:53:37: Generating execution metrics for [query_12.sql]..
2018-08-14 17:53:37: Generating execution metrics for [query_13.sql]..
2018-08-14 17:53:40: Generating execution metrics for [query_14.sql]..
2018-08-14 17:53:43: Generating execution metrics for [query_15.sql]..
2018-08-14 17:53:43: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 17:53:43: Generating execution metrics for [query_16.sql]..
2018-08-14 17:53:44: Generating execution metrics for [query_17.sql]..
2018-08-14 17:53:44: Generating execution metrics for [query_18.sql]..
2018-08-14 17:53:44: Generating execution metrics for [query_19.sql]..
2018-08-14 17:53:45: Generating execution metrics for [query_20.sql]..
2018-08-14 17:53:45: Generating execution metrics for [query_21.sql]..
2018-08-14 17:53:45: Generating execution metrics for [query_22.sql]..
2018-08-14 17:53:45: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 17:53:45: Generating execution metrics for [query_23.sql]..
2018-08-14 17:53:50: Generating execution metrics for [query_24.sql]..
2018-08-14 17:53:56: Generating execution metrics for [query_25.sql]..
2018-08-14 17:54:02: Generating execution metrics for [query_26.sql]..
2018-08-14 17:54:02: Generating execution metrics for [query_27.sql]..
2018-08-14 17:54:02: Generating execution metrics for [query_28.sql]..
2018-08-14 17:54:03: Generating execution metrics for [query_29.sql]..
2018-08-14 17:54:03: Generating execution metrics for [query_30.sql]..
2018-08-14 17:54:03: Generating execution metrics for [query_31.sql]..
2018-08-14 17:54:05: Generating execution metrics for [query_32.sql]..
2018-08-14 17:54:05: Generating execution metrics for [query_33.sql]..
2018-08-14 17:54:05: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 17:54:05: Generating execution metrics for [query_34.sql]..
2018-08-14 17:54:06: Generating execution metrics for [query_35.sql]..
2018-08-14 17:54:06: Generating execution metrics for [query_36.sql]..
2018-08-14 17:54:07: Generating execution metrics for [query_37.sql]..
2018-08-14 17:54:07: Generating execution metrics for [query_38.sql]..
2018-08-14 17:54:49: Generating execution metrics for [query_39.sql]..
2018-08-14 17:54:50: Generating execution metrics for [query_40.sql]..
2018-08-14 17:54:50: Generating execution metrics for [query_41.sql]..
2018-08-14 17:54:51: Generating execution metrics for [query_42.sql]..
2018-08-14 17:54:54: Generating execution metrics for [query_43.sql]..
2018-08-14 17:54:57: Generating execution metrics for [query_44.sql]..
2018-08-14 17:54:57: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd') - 30),'yyyy-mm-dd') and (to_char(to_date('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 17:54:57: Generating execution metrics for [query_45.sql]..
2018-08-14 17:54:57: Generating execution metrics for [query_46.sql]..
2018-08-14 17:54:57: Generating execution metrics for [query_47.sql]..
2018-08-14 17:54:58: Generating execution metrics for [query_48.sql]..
2018-08-14 17:54:59: Generating execution metrics for [query_49.sql]..
2018-08-14 17:54:59: Generating execution metrics for [query_50.sql]..
2018-08-14 17:55:00: Generating execution metrics for [query_51.sql]..
2018-08-14 17:57:14: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:57:14: Connection pool instantiated with [1] connections
2018-08-14 17:57:16: ('spark.cores.max', '20')
2018-08-14 17:57:16: ('spark.executor.memory', '2g')
2018-08-14 17:57:16: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 17:57:16: ('spark.app.id', 'app-20180814175716-0006')
2018-08-14 17:57:16: ('spark.driver.port', '11546')
2018-08-14 17:57:16: ('spark.executor.id', 'driver')
2018-08-14 17:57:16: ('spark.python.worker.reuse', 'True')
2018-08-14 17:57:16: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:57:16: ('spark.default.parallelism', '80')
2018-08-14 17:57:16: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:57:16: ('spark.executor.instances', '20')
2018-08-14 17:57:16: ('spark.logConf', 'False')
2018-08-14 17:57:16: ('spark.rdd.compress', 'True')
2018-08-14 17:57:16: ('spark.driver.memory', '2g')
2018-08-14 17:57:16: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:57:16: ('spark.executor.cores', '1')
2018-08-14 17:57:16: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:57:16: ('spark.submit.deployMode', 'client')
2018-08-14 17:57:16: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:57:16: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:57:16: ('spark.app.name', 'ICS5200')
2018-08-14 17:57:17: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 17:57:17: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 17:57:17: Successfully finished migrating DML scripts!
2018-08-14 17:57:17: Starting TPC-DS sql splitting
2018-08-14 17:57:17: Generated query_1.sql
2018-08-14 17:57:17: Generated query_2.sql
2018-08-14 17:57:17: Generated query_3.sql
2018-08-14 17:57:17: Generated query_4.sql
2018-08-14 17:57:17: Generated query_5.sql
2018-08-14 17:57:17: Generated query_6.sql
2018-08-14 17:57:17: Generated query_7.sql
2018-08-14 17:57:17: Generated query_8.sql
2018-08-14 17:57:17: Generated query_9.sql
2018-08-14 17:57:17: Generated query_10.sql
2018-08-14 17:57:17: Generated query_11.sql
2018-08-14 17:57:17: Generated query_12.sql
2018-08-14 17:57:17: Generated query_13.sql
2018-08-14 17:57:17: Generated query_14.sql
2018-08-14 17:57:17: Generated query_15.sql
2018-08-14 17:57:17: Generated query_16.sql
2018-08-14 17:57:17: Generated query_17.sql
2018-08-14 17:57:17: Generated query_18.sql
2018-08-14 17:57:17: Generated query_19.sql
2018-08-14 17:57:17: Generated query_20.sql
2018-08-14 17:57:17: Generated query_21.sql
2018-08-14 17:57:17: Generated query_22.sql
2018-08-14 17:57:17: Generated query_23.sql
2018-08-14 17:57:17: Generated query_24.sql
2018-08-14 17:57:17: Generated query_25.sql
2018-08-14 17:57:17: Generated query_26.sql
2018-08-14 17:57:17: Generated query_27.sql
2018-08-14 17:57:17: Generated query_28.sql
2018-08-14 17:57:17: Generated query_29.sql
2018-08-14 17:57:17: Generated query_30.sql
2018-08-14 17:57:17: Generated query_31.sql
2018-08-14 17:57:17: Generated query_32.sql
2018-08-14 17:57:17: Generated query_33.sql
2018-08-14 17:57:17: Generated query_34.sql
2018-08-14 17:57:17: Generated query_35.sql
2018-08-14 17:57:17: Generated query_36.sql
2018-08-14 17:57:17: Generated query_37.sql
2018-08-14 17:57:17: Generated query_38.sql
2018-08-14 17:57:17: Generated query_39.sql
2018-08-14 17:57:17: Generated query_40.sql
2018-08-14 17:57:17: Generated query_41.sql
2018-08-14 17:57:17: Generated query_42.sql
2018-08-14 17:57:17: Generated query_43.sql
2018-08-14 17:57:17: Generated query_44.sql
2018-08-14 17:57:17: Generated query_45.sql
2018-08-14 17:57:17: Generated query_46.sql
2018-08-14 17:57:17: Generated query_47.sql
2018-08-14 17:57:17: Generated query_48.sql
2018-08-14 17:57:17: Generated query_49.sql
2018-08-14 17:57:17: Generated query_50.sql
2018-08-14 17:57:17: Generated query_51.sql
2018-08-14 17:57:17: Generated query_52.sql
2018-08-14 17:57:17: Generated query_53.sql
2018-08-14 17:57:17: Generated query_54.sql
2018-08-14 17:57:17: Generated query_55.sql
2018-08-14 17:57:17: Generated query_56.sql
2018-08-14 17:57:17: Generated query_57.sql
2018-08-14 17:57:17: Generated query_58.sql
2018-08-14 17:57:17: Generated query_59.sql
2018-08-14 17:57:17: Generated query_60.sql
2018-08-14 17:57:17: Generated query_61.sql
2018-08-14 17:57:17: Generated query_62.sql
2018-08-14 17:57:17: Generated query_63.sql
2018-08-14 17:57:17: Generated query_64.sql
2018-08-14 17:57:17: Generated query_65.sql
2018-08-14 17:57:17: Generated query_66.sql
2018-08-14 17:57:17: Generated query_67.sql
2018-08-14 17:57:17: Generated query_68.sql
2018-08-14 17:57:17: Generated query_69.sql
2018-08-14 17:57:17: Generated query_70.sql
2018-08-14 17:57:17: Generated query_71.sql
2018-08-14 17:57:17: Generated query_72.sql
2018-08-14 17:57:17: Generated query_73.sql
2018-08-14 17:57:17: Generated query_74.sql
2018-08-14 17:57:17: Generated query_75.sql
2018-08-14 17:57:17: Generated query_76.sql
2018-08-14 17:57:17: Generated query_77.sql
2018-08-14 17:57:17: Generated query_78.sql
2018-08-14 17:57:17: Generated query_79.sql
2018-08-14 17:57:17: Generated query_80.sql
2018-08-14 17:57:17: Generated query_81.sql
2018-08-14 17:57:17: Generated query_82.sql
2018-08-14 17:57:17: Generated query_83.sql
2018-08-14 17:57:17: Generated query_84.sql
2018-08-14 17:57:17: Generated query_85.sql
2018-08-14 17:57:17: Generated query_86.sql
2018-08-14 17:57:17: Generated query_87.sql
2018-08-14 17:57:17: Generated query_88.sql
2018-08-14 17:57:17: Generated query_89.sql
2018-08-14 17:57:17: Generated query_90.sql
2018-08-14 17:57:17: Generated query_91.sql
2018-08-14 17:57:17: Generated query_92.sql
2018-08-14 17:57:17: Generated query_93.sql
2018-08-14 17:57:17: Generated query_94.sql
2018-08-14 17:57:17: Generated query_95.sql
2018-08-14 17:57:17: Generated query_96.sql
2018-08-14 17:57:17: Generated query_97.sql
2018-08-14 17:57:17: Generated query_98.sql
2018-08-14 17:57:17: Generated query_99.sql
2018-08-14 17:57:17: Generated query_100.sql
2018-08-14 17:57:17: Generated query_101.sql
2018-08-14 17:57:17: Generated query_102.sql
2018-08-14 17:57:17: Generated query_103.sql
2018-08-14 17:57:17: Generated query_104.sql
2018-08-14 17:57:17: Script Complete!
-------------------------------------
2018-08-14 17:57:21: Connected to database [gabsam] with user [tpcds1]
2018-08-14 17:57:21: Connection pool instantiated with [1] connections
2018-08-14 17:57:24: ('spark.cores.max', '20')
2018-08-14 17:57:24: ('spark.app.id', 'app-20180814175724-0007')
2018-08-14 17:57:24: ('spark.executor.memory', '2g')
2018-08-14 17:57:24: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 17:57:24: ('spark.driver.port', '18180')
2018-08-14 17:57:24: ('spark.executor.id', 'driver')
2018-08-14 17:57:24: ('spark.python.worker.reuse', 'True')
2018-08-14 17:57:24: ('spark.driver.maxResultSize', '1g')
2018-08-14 17:57:24: ('spark.default.parallelism', '80')
2018-08-14 17:57:24: ('spark.sql.shuffle.partitions', '80')
2018-08-14 17:57:24: ('spark.executor.instances', '20')
2018-08-14 17:57:24: ('spark.logConf', 'False')
2018-08-14 17:57:24: ('spark.rdd.compress', 'True')
2018-08-14 17:57:24: ('spark.driver.memory', '2g')
2018-08-14 17:57:24: ('spark.serializer.objectStreamReset', '100')
2018-08-14 17:57:24: ('spark.executor.cores', '1')
2018-08-14 17:57:24: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 17:57:24: ('spark.submit.deployMode', 'client')
2018-08-14 17:57:24: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 17:57:24: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 17:57:24: ('spark.app.name', 'ICS5200')
2018-08-14 17:57:24: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 17:57:24: Generating execution metrics for [query_2.sql]..
2018-08-14 17:57:24: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 17:57:25: Generating execution metrics for [query_3.sql]..
2018-08-14 17:57:25: Generating execution metrics for [query_4.sql]..
2018-08-14 17:57:31: Generating execution metrics for [query_5.sql]..
2018-08-14 17:57:35: Generating execution metrics for [query_6.sql]..
2018-08-14 17:57:35: Generating execution metrics for [query_7.sql]..
2018-08-14 17:57:35: Generating execution metrics for [query_8.sql]..
2018-08-14 17:57:35: Generating execution metrics for [query_9.sql]..
2018-08-14 17:57:38: Generating execution metrics for [query_10.sql]..
2018-08-14 17:57:38: Generating execution metrics for [query_11.sql]..
2018-08-14 17:57:40: Generating execution metrics for [query_12.sql]..
2018-08-14 17:57:40: Generating execution metrics for [query_13.sql]..
2018-08-14 17:57:43: Generating execution metrics for [query_14.sql]..
2018-08-14 17:57:46: Generating execution metrics for [query_15.sql]..
2018-08-14 17:57:46: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 17:57:47: Generating execution metrics for [query_16.sql]..
2018-08-14 17:57:47: Generating execution metrics for [query_17.sql]..
2018-08-14 17:57:47: Generating execution metrics for [query_18.sql]..
2018-08-14 17:57:47: Generating execution metrics for [query_19.sql]..
2018-08-14 17:57:48: Generating execution metrics for [query_20.sql]..
2018-08-14 17:57:48: Generating execution metrics for [query_21.sql]..
2018-08-14 17:57:48: Generating execution metrics for [query_22.sql]..
2018-08-14 17:57:48: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') - 30),'yyyy-mm-dd') and (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 17:57:48: Generating execution metrics for [query_23.sql]..
2018-08-14 17:57:53: Generating execution metrics for [query_24.sql]..
2018-08-14 17:57:59: Generating execution metrics for [query_25.sql]..
2018-08-14 17:58:05: Generating execution metrics for [query_26.sql]..
2018-08-14 17:58:05: Generating execution metrics for [query_27.sql]..
2018-08-14 17:58:05: Generating execution metrics for [query_28.sql]..
2018-08-14 17:58:06: Generating execution metrics for [query_29.sql]..
2018-08-14 17:58:06: Generating execution metrics for [query_30.sql]..
2018-08-14 17:58:06: Generating execution metrics for [query_31.sql]..
2018-08-14 17:58:08: Generating execution metrics for [query_32.sql]..
2018-08-14 17:58:08: Generating execution metrics for [query_33.sql]..
2018-08-14 17:58:08: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 17:58:08: Generating execution metrics for [query_34.sql]..
2018-08-14 17:58:10: Generating execution metrics for [query_35.sql]..
2018-08-14 17:58:10: Generating execution metrics for [query_36.sql]..
2018-08-14 17:58:10: Generating execution metrics for [query_37.sql]..
2018-08-14 17:58:10: Generating execution metrics for [query_38.sql]..
2018-08-14 17:58:53: Generating execution metrics for [query_39.sql]..
2018-08-14 17:58:54: Generating execution metrics for [query_40.sql]..
2018-08-14 17:58:54: Generating execution metrics for [query_41.sql]..
2018-08-14 17:58:54: Generating execution metrics for [query_42.sql]..
2018-08-14 17:58:58: Generating execution metrics for [query_43.sql]..
2018-08-14 17:59:01: Generating execution metrics for [query_44.sql]..
2018-08-14 17:59:01: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('2001-05-02' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (to_char(to_date('2001-05-02' ,'yyyy/mm/dd') - 30),'yyyy-mm-dd') and (to_char(to_date('2001-05-02' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 17:59:01: Generating execution metrics for [query_45.sql]..
2018-08-14 17:59:01: Generating execution metrics for [query_46.sql]..
2018-08-14 17:59:01: Generating execution metrics for [query_47.sql]..
2018-08-14 17:59:02: Generating execution metrics for [query_48.sql]..
2018-08-14 17:59:03: Generating execution metrics for [query_49.sql]..
2018-08-14 17:59:03: Generating execution metrics for [query_50.sql]..
2018-08-14 17:59:04: Generating execution metrics for [query_51.sql]..
2018-08-14 17:59:06: Generating execution metrics for [query_52.sql]..
2018-08-14 18:15:04: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:15:04: Connection pool instantiated with [1] connections
2018-08-14 18:15:07: ('spark.cores.max', '20')
2018-08-14 18:15:07: ('spark.executor.memory', '2g')
2018-08-14 18:15:07: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 18:15:07: ('spark.driver.port', '10929')
2018-08-14 18:15:07: ('spark.executor.id', 'driver')
2018-08-14 18:15:07: ('spark.python.worker.reuse', 'True')
2018-08-14 18:15:07: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:15:07: ('spark.default.parallelism', '80')
2018-08-14 18:15:07: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:15:07: ('spark.executor.instances', '20')
2018-08-14 18:15:07: ('spark.app.id', 'app-20180814181506-0008')
2018-08-14 18:15:07: ('spark.logConf', 'False')
2018-08-14 18:15:07: ('spark.rdd.compress', 'True')
2018-08-14 18:15:07: ('spark.driver.memory', '2g')
2018-08-14 18:15:07: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:15:07: ('spark.executor.cores', '1')
2018-08-14 18:15:07: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:15:07: ('spark.submit.deployMode', 'client')
2018-08-14 18:15:07: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:15:07: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:15:07: ('spark.app.name', 'ICS5200')
2018-08-14 18:15:07: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:15:07: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:15:07: Successfully finished migrating DML scripts!
2018-08-14 18:15:07: Starting TPC-DS sql splitting
2018-08-14 18:15:07: Generated query_1.sql
2018-08-14 18:15:07: Generated query_2.sql
2018-08-14 18:15:07: Generated query_3.sql
2018-08-14 18:15:07: Generated query_4.sql
2018-08-14 18:15:07: Generated query_5.sql
2018-08-14 18:15:07: Generated query_6.sql
2018-08-14 18:15:07: Generated query_7.sql
2018-08-14 18:15:07: Generated query_8.sql
2018-08-14 18:15:07: Generated query_9.sql
2018-08-14 18:15:07: Generated query_10.sql
2018-08-14 18:15:07: Generated query_11.sql
2018-08-14 18:15:07: Generated query_12.sql
2018-08-14 18:15:07: Generated query_13.sql
2018-08-14 18:15:07: Generated query_14.sql
2018-08-14 18:15:07: Generated query_15.sql
2018-08-14 18:15:07: Generated query_16.sql
2018-08-14 18:15:07: Generated query_17.sql
2018-08-14 18:15:07: Generated query_18.sql
2018-08-14 18:15:07: Generated query_19.sql
2018-08-14 18:15:07: Generated query_20.sql
2018-08-14 18:15:07: Generated query_21.sql
2018-08-14 18:15:07: Generated query_22.sql
2018-08-14 18:15:07: Generated query_23.sql
2018-08-14 18:15:07: Generated query_24.sql
2018-08-14 18:15:07: Generated query_25.sql
2018-08-14 18:15:07: Generated query_26.sql
2018-08-14 18:15:07: Generated query_27.sql
2018-08-14 18:15:07: Generated query_28.sql
2018-08-14 18:15:07: Generated query_29.sql
2018-08-14 18:15:07: Generated query_30.sql
2018-08-14 18:15:07: Generated query_31.sql
2018-08-14 18:15:07: Generated query_32.sql
2018-08-14 18:15:07: Generated query_33.sql
2018-08-14 18:15:07: Generated query_34.sql
2018-08-14 18:15:07: Generated query_35.sql
2018-08-14 18:15:07: Generated query_36.sql
2018-08-14 18:15:07: Generated query_37.sql
2018-08-14 18:15:07: Generated query_38.sql
2018-08-14 18:15:07: Generated query_39.sql
2018-08-14 18:15:07: Generated query_40.sql
2018-08-14 18:15:07: Generated query_41.sql
2018-08-14 18:15:07: Generated query_42.sql
2018-08-14 18:15:07: Generated query_43.sql
2018-08-14 18:15:07: Generated query_44.sql
2018-08-14 18:15:07: Generated query_45.sql
2018-08-14 18:15:07: Generated query_46.sql
2018-08-14 18:15:07: Generated query_47.sql
2018-08-14 18:15:07: Generated query_48.sql
2018-08-14 18:15:07: Generated query_49.sql
2018-08-14 18:15:07: Generated query_50.sql
2018-08-14 18:15:07: Generated query_51.sql
2018-08-14 18:15:07: Generated query_52.sql
2018-08-14 18:15:07: Generated query_53.sql
2018-08-14 18:15:07: Generated query_54.sql
2018-08-14 18:15:07: Generated query_55.sql
2018-08-14 18:15:07: Generated query_56.sql
2018-08-14 18:15:07: Generated query_57.sql
2018-08-14 18:15:07: Generated query_58.sql
2018-08-14 18:15:07: Generated query_59.sql
2018-08-14 18:15:07: Generated query_60.sql
2018-08-14 18:15:07: Generated query_61.sql
2018-08-14 18:15:07: Generated query_62.sql
2018-08-14 18:15:07: Generated query_63.sql
2018-08-14 18:15:07: Generated query_64.sql
2018-08-14 18:15:07: Generated query_65.sql
2018-08-14 18:15:07: Generated query_66.sql
2018-08-14 18:15:07: Generated query_67.sql
2018-08-14 18:15:07: Generated query_68.sql
2018-08-14 18:15:07: Generated query_69.sql
2018-08-14 18:15:07: Generated query_70.sql
2018-08-14 18:15:07: Generated query_71.sql
2018-08-14 18:15:07: Generated query_72.sql
2018-08-14 18:15:07: Generated query_73.sql
2018-08-14 18:15:07: Generated query_74.sql
2018-08-14 18:15:07: Generated query_75.sql
2018-08-14 18:15:07: Generated query_76.sql
2018-08-14 18:15:07: Generated query_77.sql
2018-08-14 18:15:07: Generated query_78.sql
2018-08-14 18:15:07: Generated query_79.sql
2018-08-14 18:15:07: Generated query_80.sql
2018-08-14 18:15:07: Generated query_81.sql
2018-08-14 18:15:07: Generated query_82.sql
2018-08-14 18:15:07: Generated query_83.sql
2018-08-14 18:15:07: Generated query_84.sql
2018-08-14 18:15:07: Generated query_85.sql
2018-08-14 18:15:07: Generated query_86.sql
2018-08-14 18:15:07: Generated query_87.sql
2018-08-14 18:15:07: Generated query_88.sql
2018-08-14 18:15:07: Generated query_89.sql
2018-08-14 18:15:07: Generated query_90.sql
2018-08-14 18:15:07: Generated query_91.sql
2018-08-14 18:15:07: Generated query_92.sql
2018-08-14 18:15:07: Generated query_93.sql
2018-08-14 18:15:07: Generated query_94.sql
2018-08-14 18:15:07: Generated query_95.sql
2018-08-14 18:15:07: Generated query_96.sql
2018-08-14 18:15:07: Generated query_97.sql
2018-08-14 18:15:07: Generated query_98.sql
2018-08-14 18:15:07: Generated query_99.sql
2018-08-14 18:15:07: Generated query_100.sql
2018-08-14 18:15:08: Generated query_101.sql
2018-08-14 18:15:08: Generated query_102.sql
2018-08-14 18:15:08: Generated query_103.sql
2018-08-14 18:15:08: Generated query_104.sql
2018-08-14 18:15:08: Script Complete!
-------------------------------------
2018-08-14 18:15:11: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:15:11: Connection pool instantiated with [1] connections
2018-08-14 18:15:13: ('spark.cores.max', '20')
2018-08-14 18:15:13: ('spark.executor.memory', '2g')
2018-08-14 18:15:13: ('spark.executor.id', 'driver')
2018-08-14 18:15:13: ('spark.python.worker.reuse', 'True')
2018-08-14 18:15:13: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:15:13: ('spark.default.parallelism', '80')
2018-08-14 18:15:13: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:15:13: ('spark.executor.instances', '20')
2018-08-14 18:15:13: ('spark.logConf', 'False')
2018-08-14 18:15:13: ('spark.rdd.compress', 'True')
2018-08-14 18:15:13: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:15:13: ('spark.app.id', 'app-20180814181513-0009')
2018-08-14 18:15:13: ('spark.driver.memory', '2g')
2018-08-14 18:15:13: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:15:13: ('spark.executor.cores', '1')
2018-08-14 18:15:13: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:15:13: ('spark.submit.deployMode', 'client')
2018-08-14 18:15:13: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:15:13: ('spark.driver.port', '35812')
2018-08-14 18:15:13: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:15:13: ('spark.app.name', 'ICS5200')
2018-08-14 18:15:14: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:15:14: Generating execution metrics for [query_2.sql]..
2018-08-14 18:15:14: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 18:15:14: Generating execution metrics for [query_3.sql]..
2018-08-14 18:15:14: Generating execution metrics for [query_4.sql]..
2018-08-14 18:15:21: Generating execution metrics for [query_5.sql]..
2018-08-14 18:15:24: Generating execution metrics for [query_6.sql]..
2018-08-14 18:15:24: Generating execution metrics for [query_7.sql]..
2018-08-14 18:15:24: Generating execution metrics for [query_8.sql]..
2018-08-14 18:15:25: Generating execution metrics for [query_9.sql]..
2018-08-14 18:15:27: Generating execution metrics for [query_10.sql]..
2018-08-14 18:15:28: Generating execution metrics for [query_11.sql]..
2018-08-14 18:15:30: Generating execution metrics for [query_12.sql]..
2018-08-14 18:15:30: Generating execution metrics for [query_13.sql]..
2018-08-14 18:15:34: Generating execution metrics for [query_14.sql]..
2018-08-14 18:15:37: Generating execution metrics for [query_15.sql]..
2018-08-14 18:15:37: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 18:15:37: Generating execution metrics for [query_16.sql]..
2018-08-14 18:15:37: Generating execution metrics for [query_17.sql]..
2018-08-14 18:15:37: Generating execution metrics for [query_18.sql]..
2018-08-14 18:15:38: Generating execution metrics for [query_19.sql]..
2018-08-14 18:15:50: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:15:50: Connection pool instantiated with [1] connections
2018-08-14 18:15:53: ('spark.cores.max', '20')
2018-08-14 18:15:53: ('spark.executor.memory', '2g')
2018-08-14 18:15:53: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 18:15:53: ('spark.executor.id', 'driver')
2018-08-14 18:15:53: ('spark.python.worker.reuse', 'True')
2018-08-14 18:15:53: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:15:53: ('spark.default.parallelism', '80')
2018-08-14 18:15:53: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:15:53: ('spark.driver.port', '31408')
2018-08-14 18:15:53: ('spark.executor.instances', '20')
2018-08-14 18:15:53: ('spark.app.id', 'app-20180814181553-0010')
2018-08-14 18:15:53: ('spark.logConf', 'False')
2018-08-14 18:15:53: ('spark.rdd.compress', 'True')
2018-08-14 18:15:53: ('spark.driver.memory', '2g')
2018-08-14 18:15:53: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:15:53: ('spark.executor.cores', '1')
2018-08-14 18:15:53: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:15:53: ('spark.submit.deployMode', 'client')
2018-08-14 18:15:53: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:15:53: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:15:53: ('spark.app.name', 'ICS5200')
2018-08-14 18:15:53: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:15:53: Generating execution metrics for [query_2.sql]..
2018-08-14 18:15:53: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 18:15:53: Generating execution metrics for [query_3.sql]..
2018-08-14 18:15:54: Generating execution metrics for [query_4.sql]..
2018-08-14 18:16:01: Generating execution metrics for [query_5.sql]..
2018-08-14 18:16:04: Generating execution metrics for [query_6.sql]..
2018-08-14 18:16:04: Generating execution metrics for [query_7.sql]..
2018-08-14 18:16:04: Generating execution metrics for [query_8.sql]..
2018-08-14 18:16:05: Generating execution metrics for [query_9.sql]..
2018-08-14 18:16:07: Generating execution metrics for [query_10.sql]..
2018-08-14 18:16:08: Generating execution metrics for [query_11.sql]..
2018-08-14 18:16:10: Generating execution metrics for [query_12.sql]..
2018-08-14 18:16:10: Generating execution metrics for [query_13.sql]..
2018-08-14 18:16:13: Generating execution metrics for [query_14.sql]..
2018-08-14 18:16:17: Generating execution metrics for [query_15.sql]..
2018-08-14 18:16:17: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 18:16:17: Generating execution metrics for [query_16.sql]..
2018-08-14 18:16:17: Generating execution metrics for [query_17.sql]..
2018-08-14 18:16:17: Generating execution metrics for [query_18.sql]..
2018-08-14 18:16:18: Generating execution metrics for [query_19.sql]..
2018-08-14 18:16:18: Generating execution metrics for [query_20.sql]..
2018-08-14 18:16:18: Generating execution metrics for [query_21.sql]..
2018-08-14 18:16:18: Generating execution metrics for [query_22.sql]..
2018-08-14 18:16:18: Skipped DML instruction due to following exception: [ORA-00905: missing keyword] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') - 30),'yyyy-mm-dd') and (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 18:16:19: Generating execution metrics for [query_23.sql]..
2018-08-14 18:16:24: Generating execution metrics for [query_24.sql]..
2018-08-14 18:19:30: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:19:30: Connection pool instantiated with [1] connections
2018-08-14 18:19:32: ('spark.cores.max', '20')
2018-08-14 18:19:32: ('spark.executor.memory', '2g')
2018-08-14 18:19:32: ('spark.app.id', 'app-20180814181932-0011')
2018-08-14 18:19:32: ('spark.executor.id', 'driver')
2018-08-14 18:19:32: ('spark.python.worker.reuse', 'True')
2018-08-14 18:19:32: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:19:32: ('spark.default.parallelism', '80')
2018-08-14 18:19:32: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:19:32: ('spark.executor.instances', '20')
2018-08-14 18:19:32: ('spark.logConf', 'False')
2018-08-14 18:19:32: ('spark.rdd.compress', 'True')
2018-08-14 18:19:32: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:19:32: ('spark.driver.memory', '2g')
2018-08-14 18:19:32: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:19:32: ('spark.executor.cores', '1')
2018-08-14 18:19:32: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:19:32: ('spark.submit.deployMode', 'client')
2018-08-14 18:19:32: ('spark.driver.port', '10261')
2018-08-14 18:19:32: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:19:32: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:19:32: ('spark.app.name', 'ICS5200')
2018-08-14 18:19:32: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:19:32: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:19:32: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:19:32: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:19:33: Successfully finished migrating DML scripts!
2018-08-14 18:19:33: Starting TPC-DS sql splitting
2018-08-14 18:19:33: Generated query_1.sql
2018-08-14 18:19:33: Generated query_2.sql
2018-08-14 18:19:33: Generated query_3.sql
2018-08-14 18:19:33: Generated query_4.sql
2018-08-14 18:19:33: Generated query_5.sql
2018-08-14 18:19:33: Generated query_6.sql
2018-08-14 18:19:33: Generated query_7.sql
2018-08-14 18:19:33: Generated query_8.sql
2018-08-14 18:19:33: Generated query_9.sql
2018-08-14 18:19:33: Generated query_10.sql
2018-08-14 18:19:33: Generated query_11.sql
2018-08-14 18:19:33: Generated query_12.sql
2018-08-14 18:19:33: Generated query_13.sql
2018-08-14 18:19:33: Generated query_14.sql
2018-08-14 18:19:33: Generated query_15.sql
2018-08-14 18:19:33: Generated query_16.sql
2018-08-14 18:19:33: Generated query_17.sql
2018-08-14 18:19:33: Generated query_18.sql
2018-08-14 18:19:33: Generated query_19.sql
2018-08-14 18:19:33: Generated query_20.sql
2018-08-14 18:19:33: Generated query_21.sql
2018-08-14 18:19:33: Generated query_22.sql
2018-08-14 18:19:33: Generated query_23.sql
2018-08-14 18:19:33: Generated query_24.sql
2018-08-14 18:19:33: Generated query_25.sql
2018-08-14 18:19:33: Generated query_26.sql
2018-08-14 18:19:33: Generated query_27.sql
2018-08-14 18:19:33: Generated query_28.sql
2018-08-14 18:19:33: Generated query_29.sql
2018-08-14 18:19:33: Generated query_30.sql
2018-08-14 18:19:33: Generated query_31.sql
2018-08-14 18:19:33: Generated query_32.sql
2018-08-14 18:19:33: Generated query_33.sql
2018-08-14 18:19:33: Generated query_34.sql
2018-08-14 18:19:33: Generated query_35.sql
2018-08-14 18:19:33: Generated query_36.sql
2018-08-14 18:19:33: Generated query_37.sql
2018-08-14 18:19:33: Generated query_38.sql
2018-08-14 18:19:33: Generated query_39.sql
2018-08-14 18:19:33: Generated query_40.sql
2018-08-14 18:19:33: Generated query_41.sql
2018-08-14 18:19:33: Generated query_42.sql
2018-08-14 18:19:33: Generated query_43.sql
2018-08-14 18:19:33: Generated query_44.sql
2018-08-14 18:19:33: Generated query_45.sql
2018-08-14 18:19:33: Generated query_46.sql
2018-08-14 18:19:33: Generated query_47.sql
2018-08-14 18:19:33: Generated query_48.sql
2018-08-14 18:19:33: Generated query_49.sql
2018-08-14 18:19:33: Generated query_50.sql
2018-08-14 18:19:33: Generated query_51.sql
2018-08-14 18:19:33: Generated query_52.sql
2018-08-14 18:19:33: Generated query_53.sql
2018-08-14 18:19:33: Generated query_54.sql
2018-08-14 18:19:33: Generated query_55.sql
2018-08-14 18:19:33: Generated query_56.sql
2018-08-14 18:19:33: Generated query_57.sql
2018-08-14 18:19:33: Generated query_58.sql
2018-08-14 18:19:33: Generated query_59.sql
2018-08-14 18:19:33: Generated query_60.sql
2018-08-14 18:19:33: Generated query_61.sql
2018-08-14 18:19:33: Generated query_62.sql
2018-08-14 18:19:33: Generated query_63.sql
2018-08-14 18:19:33: Generated query_64.sql
2018-08-14 18:19:33: Generated query_65.sql
2018-08-14 18:19:33: Generated query_66.sql
2018-08-14 18:19:33: Generated query_67.sql
2018-08-14 18:19:33: Generated query_68.sql
2018-08-14 18:19:33: Generated query_69.sql
2018-08-14 18:19:33: Generated query_70.sql
2018-08-14 18:19:33: Generated query_71.sql
2018-08-14 18:19:33: Generated query_72.sql
2018-08-14 18:19:33: Generated query_73.sql
2018-08-14 18:19:33: Generated query_74.sql
2018-08-14 18:19:33: Generated query_75.sql
2018-08-14 18:19:33: Generated query_76.sql
2018-08-14 18:19:33: Generated query_77.sql
2018-08-14 18:19:33: Generated query_78.sql
2018-08-14 18:19:33: Generated query_79.sql
2018-08-14 18:19:33: Generated query_80.sql
2018-08-14 18:19:33: Generated query_81.sql
2018-08-14 18:19:33: Generated query_82.sql
2018-08-14 18:19:33: Generated query_83.sql
2018-08-14 18:19:33: Generated query_84.sql
2018-08-14 18:19:33: Generated query_85.sql
2018-08-14 18:19:33: Generated query_86.sql
2018-08-14 18:19:33: Generated query_87.sql
2018-08-14 18:19:33: Generated query_88.sql
2018-08-14 18:19:33: Generated query_89.sql
2018-08-14 18:19:33: Generated query_90.sql
2018-08-14 18:19:33: Generated query_91.sql
2018-08-14 18:19:33: Generated query_92.sql
2018-08-14 18:19:33: Generated query_93.sql
2018-08-14 18:19:33: Generated query_94.sql
2018-08-14 18:19:33: Generated query_95.sql
2018-08-14 18:19:33: Generated query_96.sql
2018-08-14 18:19:33: Generated query_97.sql
2018-08-14 18:19:33: Generated query_98.sql
2018-08-14 18:19:33: Generated query_99.sql
2018-08-14 18:19:33: Generated query_100.sql
2018-08-14 18:19:33: Generated query_101.sql
2018-08-14 18:19:33: Generated query_102.sql
2018-08-14 18:19:33: Generated query_103.sql
2018-08-14 18:19:33: Generated query_104.sql
2018-08-14 18:19:33: Script Complete!
-------------------------------------
2018-08-14 18:19:36: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:19:36: Connection pool instantiated with [1] connections
2018-08-14 18:19:39: ('spark.cores.max', '20')
2018-08-14 18:19:39: ('spark.executor.memory', '2g')
2018-08-14 18:19:39: ('spark.executor.id', 'driver')
2018-08-14 18:19:39: ('spark.python.worker.reuse', 'True')
2018-08-14 18:19:39: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:19:39: ('spark.default.parallelism', '80')
2018-08-14 18:19:39: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:19:39: ('spark.executor.instances', '20')
2018-08-14 18:19:39: ('spark.logConf', 'False')
2018-08-14 18:19:39: ('spark.rdd.compress', 'True')
2018-08-14 18:19:39: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:19:39: ('spark.driver.memory', '2g')
2018-08-14 18:19:39: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:19:39: ('spark.driver.port', '29867')
2018-08-14 18:19:39: ('spark.executor.cores', '1')
2018-08-14 18:19:39: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:19:39: ('spark.submit.deployMode', 'client')
2018-08-14 18:19:39: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:19:39: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:19:39: ('spark.app.name', 'ICS5200')
2018-08-14 18:19:39: ('spark.app.id', 'app-20180814181939-0012')
2018-08-14 18:19:39: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:19:39: Generating execution metrics for [query_2.sql]..
2018-08-14 18:19:39: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 18:19:39: Generating execution metrics for [query_3.sql]..
2018-08-14 18:19:40: Generating execution metrics for [query_4.sql]..
2018-08-14 18:19:47: Generating execution metrics for [query_5.sql]..
2018-08-14 18:19:50: Generating execution metrics for [query_6.sql]..
2018-08-14 18:19:50: Generating execution metrics for [query_7.sql]..
2018-08-14 18:19:50: Generating execution metrics for [query_8.sql]..
2018-08-14 18:19:51: Generating execution metrics for [query_9.sql]..
2018-08-14 18:19:53: Generating execution metrics for [query_10.sql]..
2018-08-14 18:19:53: Generating execution metrics for [query_11.sql]..
2018-08-14 18:19:55: Generating execution metrics for [query_12.sql]..
2018-08-14 18:19:55: Generating execution metrics for [query_13.sql]..
2018-08-14 18:19:59: Generating execution metrics for [query_14.sql]..
2018-08-14 18:20:02: Generating execution metrics for [query_15.sql]..
2018-08-14 18:20:02: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 18:20:02: Generating execution metrics for [query_16.sql]..
2018-08-14 18:20:03: Generating execution metrics for [query_17.sql]..
2018-08-14 18:20:03: Generating execution metrics for [query_18.sql]..
2018-08-14 18:20:03: Generating execution metrics for [query_19.sql]..
2018-08-14 18:20:04: Generating execution metrics for [query_20.sql]..
2018-08-14 18:20:04: Generating execution metrics for [query_21.sql]..
2018-08-14 18:20:04: Generating execution metrics for [query_22.sql]..
2018-08-14 18:20:04: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_char(to_date(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_char(to_date(d_date ,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('1999-06-22' ,'yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') - 30),'yyyy-mm-dd') and (to_char(to_date('1999-06-22' ,'yyyy/mm/dd') + 30),'yyyy-mm-dd') group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 18:20:04: Generating execution metrics for [query_23.sql]..
2018-08-14 18:28:51: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:28:51: Connection pool instantiated with [1] connections
2018-08-14 18:28:54: ('spark.cores.max', '20')
2018-08-14 18:28:54: ('spark.executor.memory', '2g')
2018-08-14 18:28:54: ('spark.driver.port', '10631')
2018-08-14 18:28:54: ('spark.executor.id', 'driver')
2018-08-14 18:28:54: ('spark.python.worker.reuse', 'True')
2018-08-14 18:28:54: ('spark.app.id', 'app-20180814182853-0013')
2018-08-14 18:28:54: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:28:54: ('spark.default.parallelism', '80')
2018-08-14 18:28:54: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:28:54: ('spark.executor.instances', '20')
2018-08-14 18:28:54: ('spark.logConf', 'False')
2018-08-14 18:28:54: ('spark.rdd.compress', 'True')
2018-08-14 18:28:54: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:28:54: ('spark.driver.memory', '2g')
2018-08-14 18:28:54: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:28:54: ('spark.executor.cores', '1')
2018-08-14 18:28:54: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:28:54: ('spark.submit.deployMode', 'client')
2018-08-14 18:28:54: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:28:54: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:28:54: ('spark.app.name', 'ICS5200')
2018-08-14 18:28:54: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:28:54: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:28:54: Successfully finished migrating DML scripts!
2018-08-14 18:28:54: Starting TPC-DS sql splitting
2018-08-14 18:28:54: Generated query_1.sql
2018-08-14 18:28:54: Generated query_2.sql
2018-08-14 18:28:54: Generated query_3.sql
2018-08-14 18:28:54: Generated query_4.sql
2018-08-14 18:28:54: Generated query_5.sql
2018-08-14 18:28:54: Generated query_6.sql
2018-08-14 18:28:54: Generated query_7.sql
2018-08-14 18:28:54: Generated query_8.sql
2018-08-14 18:28:54: Generated query_9.sql
2018-08-14 18:28:54: Generated query_10.sql
2018-08-14 18:28:54: Generated query_11.sql
2018-08-14 18:28:54: Generated query_12.sql
2018-08-14 18:28:54: Generated query_13.sql
2018-08-14 18:28:54: Generated query_14.sql
2018-08-14 18:28:54: Generated query_15.sql
2018-08-14 18:28:54: Generated query_16.sql
2018-08-14 18:28:54: Generated query_17.sql
2018-08-14 18:28:54: Generated query_18.sql
2018-08-14 18:28:54: Generated query_19.sql
2018-08-14 18:28:54: Generated query_20.sql
2018-08-14 18:28:54: Generated query_21.sql
2018-08-14 18:28:54: Generated query_22.sql
2018-08-14 18:28:54: Generated query_23.sql
2018-08-14 18:28:54: Generated query_24.sql
2018-08-14 18:28:54: Generated query_25.sql
2018-08-14 18:28:54: Generated query_26.sql
2018-08-14 18:28:54: Generated query_27.sql
2018-08-14 18:28:54: Generated query_28.sql
2018-08-14 18:28:54: Generated query_29.sql
2018-08-14 18:28:54: Generated query_30.sql
2018-08-14 18:28:54: Generated query_31.sql
2018-08-14 18:28:54: Generated query_32.sql
2018-08-14 18:28:54: Generated query_33.sql
2018-08-14 18:28:54: Generated query_34.sql
2018-08-14 18:28:54: Generated query_35.sql
2018-08-14 18:28:54: Generated query_36.sql
2018-08-14 18:28:54: Generated query_37.sql
2018-08-14 18:28:54: Generated query_38.sql
2018-08-14 18:28:54: Generated query_39.sql
2018-08-14 18:28:54: Generated query_40.sql
2018-08-14 18:28:54: Generated query_41.sql
2018-08-14 18:28:54: Generated query_42.sql
2018-08-14 18:28:54: Generated query_43.sql
2018-08-14 18:28:54: Generated query_44.sql
2018-08-14 18:28:54: Generated query_45.sql
2018-08-14 18:28:54: Generated query_46.sql
2018-08-14 18:28:54: Generated query_47.sql
2018-08-14 18:28:54: Generated query_48.sql
2018-08-14 18:28:54: Generated query_49.sql
2018-08-14 18:28:54: Generated query_50.sql
2018-08-14 18:28:54: Generated query_51.sql
2018-08-14 18:28:54: Generated query_52.sql
2018-08-14 18:28:54: Generated query_53.sql
2018-08-14 18:28:54: Generated query_54.sql
2018-08-14 18:28:54: Generated query_55.sql
2018-08-14 18:28:54: Generated query_56.sql
2018-08-14 18:28:54: Generated query_57.sql
2018-08-14 18:28:54: Generated query_58.sql
2018-08-14 18:28:54: Generated query_59.sql
2018-08-14 18:28:54: Generated query_60.sql
2018-08-14 18:28:54: Generated query_61.sql
2018-08-14 18:28:54: Generated query_62.sql
2018-08-14 18:28:54: Generated query_63.sql
2018-08-14 18:28:54: Generated query_64.sql
2018-08-14 18:28:54: Generated query_65.sql
2018-08-14 18:28:54: Generated query_66.sql
2018-08-14 18:28:54: Generated query_67.sql
2018-08-14 18:28:54: Generated query_68.sql
2018-08-14 18:28:54: Generated query_69.sql
2018-08-14 18:28:54: Generated query_70.sql
2018-08-14 18:28:54: Generated query_71.sql
2018-08-14 18:28:54: Generated query_72.sql
2018-08-14 18:28:54: Generated query_73.sql
2018-08-14 18:28:54: Generated query_74.sql
2018-08-14 18:28:54: Generated query_75.sql
2018-08-14 18:28:54: Generated query_76.sql
2018-08-14 18:28:54: Generated query_77.sql
2018-08-14 18:28:54: Generated query_78.sql
2018-08-14 18:28:54: Generated query_79.sql
2018-08-14 18:28:54: Generated query_80.sql
2018-08-14 18:28:54: Generated query_81.sql
2018-08-14 18:28:54: Generated query_82.sql
2018-08-14 18:28:54: Generated query_83.sql
2018-08-14 18:28:54: Generated query_84.sql
2018-08-14 18:28:54: Generated query_85.sql
2018-08-14 18:28:54: Generated query_86.sql
2018-08-14 18:28:54: Generated query_87.sql
2018-08-14 18:28:54: Generated query_88.sql
2018-08-14 18:28:54: Generated query_89.sql
2018-08-14 18:28:54: Generated query_90.sql
2018-08-14 18:28:54: Generated query_91.sql
2018-08-14 18:28:54: Generated query_92.sql
2018-08-14 18:28:54: Generated query_93.sql
2018-08-14 18:28:54: Generated query_94.sql
2018-08-14 18:28:54: Generated query_95.sql
2018-08-14 18:28:54: Generated query_96.sql
2018-08-14 18:28:54: Generated query_97.sql
2018-08-14 18:28:54: Generated query_98.sql
2018-08-14 18:28:54: Generated query_99.sql
2018-08-14 18:28:54: Generated query_100.sql
2018-08-14 18:28:54: Generated query_101.sql
2018-08-14 18:28:54: Generated query_102.sql
2018-08-14 18:28:54: Generated query_103.sql
2018-08-14 18:28:54: Generated query_104.sql
2018-08-14 18:28:54: Script Complete!
-------------------------------------
2018-08-14 18:28:59: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:28:59: Connection pool instantiated with [1] connections
2018-08-14 18:29:02: ('spark.cores.max', '20')
2018-08-14 18:29:02: ('spark.executor.memory', '2g')
2018-08-14 18:29:02: ('spark.executor.id', 'driver')
2018-08-14 18:29:02: ('spark.python.worker.reuse', 'True')
2018-08-14 18:29:02: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:29:02: ('spark.default.parallelism', '80')
2018-08-14 18:29:02: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:29:02: ('spark.executor.instances', '20')
2018-08-14 18:29:02: ('spark.driver.port', '31272')
2018-08-14 18:29:02: ('spark.logConf', 'False')
2018-08-14 18:29:02: ('spark.rdd.compress', 'True')
2018-08-14 18:29:02: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:29:02: ('spark.app.id', 'app-20180814182901-0014')
2018-08-14 18:29:02: ('spark.driver.memory', '2g')
2018-08-14 18:29:02: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:29:02: ('spark.executor.cores', '1')
2018-08-14 18:29:02: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:29:02: ('spark.submit.deployMode', 'client')
2018-08-14 18:29:02: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:29:02: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:29:02: ('spark.app.name', 'ICS5200')
2018-08-14 18:29:02: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:29:02: Generating execution metrics for [query_2.sql]..
2018-08-14 18:29:02: Skipped DML instruction due to following exception: [ORA-00903: invalid table name] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 18:29:02: Generating execution metrics for [query_3.sql]..
2018-08-14 18:29:03: Generating execution metrics for [query_4.sql]..
2018-08-14 18:29:09: Generating execution metrics for [query_5.sql]..
2018-08-14 18:29:09: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14 days) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14 days) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14 days) and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 18:29:10: Generating execution metrics for [query_6.sql]..
2018-08-14 18:29:10: Generating execution metrics for [query_7.sql]..
2018-08-14 18:29:10: Generating execution metrics for [query_8.sql]..
2018-08-14 18:29:10: Generating execution metrics for [query_9.sql]..
2018-08-14 18:29:13: Generating execution metrics for [query_10.sql]..
2018-08-14 18:29:13: Generating execution metrics for [query_11.sql]..
2018-08-14 18:29:15: Generating execution metrics for [query_12.sql]..
2018-08-14 18:29:15: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-06-15' as date) and (cast('2001-06-15' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 18:29:15: Generating execution metrics for [query_13.sql]..
2018-08-14 18:29:19: Generating execution metrics for [query_14.sql]..
2018-08-14 18:29:22: Generating execution metrics for [query_15.sql]..
2018-08-14 18:29:22: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 18:29:22: Generating execution metrics for [query_16.sql]..
2018-08-14 18:29:22: Generating execution metrics for [query_17.sql]..
2018-08-14 18:29:22: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 18:29:22: Generating execution metrics for [query_18.sql]..
2018-08-14 18:29:23: Generating execution metrics for [query_19.sql]..
2018-08-14 18:29:23: Generating execution metrics for [query_20.sql]..
2018-08-14 18:29:23: Generating execution metrics for [query_21.sql]..
2018-08-14 18:29:23: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 18:29:24: Generating execution metrics for [query_22.sql]..
2018-08-14 18:29:24: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 18:29:24: Generating execution metrics for [query_23.sql]..
2018-08-14 18:29:29: Generating execution metrics for [query_24.sql]..
2018-08-14 18:29:35: Generating execution metrics for [query_25.sql]..
2018-08-14 18:29:41: Generating execution metrics for [query_26.sql]..
2018-08-14 18:29:41: Generating execution metrics for [query_27.sql]..
2018-08-14 18:29:41: Generating execution metrics for [query_28.sql]..
2018-08-14 18:29:42: Generating execution metrics for [query_29.sql]..
2018-08-14 18:29:42: Generating execution metrics for [query_30.sql]..
2018-08-14 18:29:43: Generating execution metrics for [query_31.sql]..
2018-08-14 18:29:44: Generating execution metrics for [query_32.sql]..
2018-08-14 18:29:45: Generating execution metrics for [query_33.sql]..
2018-08-14 18:29:45: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 18:29:45: Generating execution metrics for [query_34.sql]..
2018-08-14 18:29:46: Generating execution metrics for [query_35.sql]..
2018-08-14 18:29:46: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 18:29:46: Generating execution metrics for [query_36.sql]..
2018-08-14 18:29:46: Generating execution metrics for [query_37.sql]..
2018-08-14 18:29:47: Generating execution metrics for [query_38.sql]..
2018-08-14 18:30:30: Generating execution metrics for [query_39.sql]..
2018-08-14 18:30:31: Generating execution metrics for [query_40.sql]..
2018-08-14 18:30:31: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 18:30:31: Generating execution metrics for [query_41.sql]..
2018-08-14 18:30:32: Generating execution metrics for [query_42.sql]..
2018-08-14 18:30:35: Generating execution metrics for [query_43.sql]..
2018-08-14 18:30:38: Generating execution metrics for [query_44.sql]..
2018-08-14 18:30:38: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 18:30:38: Generating execution metrics for [query_45.sql]..
2018-08-14 18:30:38: Generating execution metrics for [query_46.sql]..
2018-08-14 18:30:38: Generating execution metrics for [query_47.sql]..
2018-08-14 18:30:39: Generating execution metrics for [query_48.sql]..
2018-08-14 18:30:40: Generating execution metrics for [query_49.sql]..
2018-08-14 18:30:40: Generating execution metrics for [query_50.sql]..
2018-08-14 18:30:42: Generating execution metrics for [query_51.sql]..
2018-08-14 18:30:43: Generating execution metrics for [query_52.sql]..
2018-08-14 18:38:45: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:38:45: Connection pool instantiated with [1] connections
2018-08-14 18:38:47: ('spark.cores.max', '20')
2018-08-14 18:38:47: ('spark.executor.memory', '2g')
2018-08-14 18:38:47: ('spark.app.id', 'app-20180814183847-0015')
2018-08-14 18:38:47: ('spark.driver.port', '36251')
2018-08-14 18:38:47: ('spark.executor.id', 'driver')
2018-08-14 18:38:47: ('spark.python.worker.reuse', 'True')
2018-08-14 18:38:47: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:38:47: ('spark.default.parallelism', '80')
2018-08-14 18:38:47: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:38:47: ('spark.executor.instances', '20')
2018-08-14 18:38:47: ('spark.logConf', 'False')
2018-08-14 18:38:47: ('spark.rdd.compress', 'True')
2018-08-14 18:38:47: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:38:47: ('spark.driver.memory', '2g')
2018-08-14 18:38:47: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:38:47: ('spark.executor.cores', '1')
2018-08-14 18:38:47: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:38:47: ('spark.submit.deployMode', 'client')
2018-08-14 18:38:47: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:38:47: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:38:47: ('spark.app.name', 'ICS5200')
2018-08-14 18:38:48: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:38:48: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:38:48: Successfully finished migrating DML scripts!
2018-08-14 18:38:48: Starting TPC-DS sql splitting
2018-08-14 18:38:48: Generated query_1.sql
2018-08-14 18:38:48: Generated query_2.sql
2018-08-14 18:38:48: Generated query_3.sql
2018-08-14 18:38:48: Generated query_4.sql
2018-08-14 18:38:48: Generated query_5.sql
2018-08-14 18:38:48: Generated query_6.sql
2018-08-14 18:38:48: Generated query_7.sql
2018-08-14 18:38:48: Generated query_8.sql
2018-08-14 18:38:48: Generated query_9.sql
2018-08-14 18:38:48: Generated query_10.sql
2018-08-14 18:38:48: Generated query_11.sql
2018-08-14 18:38:48: Generated query_12.sql
2018-08-14 18:38:48: Generated query_13.sql
2018-08-14 18:38:48: Generated query_14.sql
2018-08-14 18:38:48: Generated query_15.sql
2018-08-14 18:38:48: Generated query_16.sql
2018-08-14 18:38:48: Generated query_17.sql
2018-08-14 18:38:48: Generated query_18.sql
2018-08-14 18:38:48: Generated query_19.sql
2018-08-14 18:38:48: Generated query_20.sql
2018-08-14 18:38:48: Generated query_21.sql
2018-08-14 18:38:48: Generated query_22.sql
2018-08-14 18:38:48: Generated query_23.sql
2018-08-14 18:38:48: Generated query_24.sql
2018-08-14 18:38:48: Generated query_25.sql
2018-08-14 18:38:48: Generated query_26.sql
2018-08-14 18:38:48: Generated query_27.sql
2018-08-14 18:38:48: Generated query_28.sql
2018-08-14 18:38:48: Generated query_29.sql
2018-08-14 18:38:48: Generated query_30.sql
2018-08-14 18:38:48: Generated query_31.sql
2018-08-14 18:38:48: Generated query_32.sql
2018-08-14 18:38:48: Generated query_33.sql
2018-08-14 18:38:48: Generated query_34.sql
2018-08-14 18:38:48: Generated query_35.sql
2018-08-14 18:38:48: Generated query_36.sql
2018-08-14 18:38:48: Generated query_37.sql
2018-08-14 18:38:48: Generated query_38.sql
2018-08-14 18:38:48: Generated query_39.sql
2018-08-14 18:38:48: Generated query_40.sql
2018-08-14 18:38:48: Generated query_41.sql
2018-08-14 18:38:48: Generated query_42.sql
2018-08-14 18:38:48: Generated query_43.sql
2018-08-14 18:38:48: Generated query_44.sql
2018-08-14 18:38:48: Generated query_45.sql
2018-08-14 18:38:48: Generated query_46.sql
2018-08-14 18:38:48: Generated query_47.sql
2018-08-14 18:38:48: Generated query_48.sql
2018-08-14 18:38:48: Generated query_49.sql
2018-08-14 18:38:48: Generated query_50.sql
2018-08-14 18:38:48: Generated query_51.sql
2018-08-14 18:38:48: Generated query_52.sql
2018-08-14 18:38:48: Generated query_53.sql
2018-08-14 18:38:48: Generated query_54.sql
2018-08-14 18:38:48: Generated query_55.sql
2018-08-14 18:38:48: Generated query_56.sql
2018-08-14 18:38:48: Generated query_57.sql
2018-08-14 18:38:48: Generated query_58.sql
2018-08-14 18:38:48: Generated query_59.sql
2018-08-14 18:38:48: Generated query_60.sql
2018-08-14 18:38:48: Generated query_61.sql
2018-08-14 18:38:48: Generated query_62.sql
2018-08-14 18:38:48: Generated query_63.sql
2018-08-14 18:38:48: Generated query_64.sql
2018-08-14 18:38:48: Generated query_65.sql
2018-08-14 18:38:48: Generated query_66.sql
2018-08-14 18:38:48: Generated query_67.sql
2018-08-14 18:38:48: Generated query_68.sql
2018-08-14 18:38:48: Generated query_69.sql
2018-08-14 18:38:48: Generated query_70.sql
2018-08-14 18:38:48: Generated query_71.sql
2018-08-14 18:38:48: Generated query_72.sql
2018-08-14 18:38:48: Generated query_73.sql
2018-08-14 18:38:48: Generated query_74.sql
2018-08-14 18:38:48: Generated query_75.sql
2018-08-14 18:38:48: Generated query_76.sql
2018-08-14 18:38:48: Generated query_77.sql
2018-08-14 18:38:48: Generated query_78.sql
2018-08-14 18:38:48: Generated query_79.sql
2018-08-14 18:38:48: Generated query_80.sql
2018-08-14 18:38:48: Generated query_81.sql
2018-08-14 18:38:48: Generated query_82.sql
2018-08-14 18:38:48: Generated query_83.sql
2018-08-14 18:38:48: Generated query_84.sql
2018-08-14 18:38:48: Generated query_85.sql
2018-08-14 18:38:48: Generated query_86.sql
2018-08-14 18:38:48: Generated query_87.sql
2018-08-14 18:38:48: Generated query_88.sql
2018-08-14 18:38:48: Generated query_89.sql
2018-08-14 18:38:48: Generated query_90.sql
2018-08-14 18:38:48: Generated query_91.sql
2018-08-14 18:38:48: Generated query_92.sql
2018-08-14 18:38:48: Generated query_93.sql
2018-08-14 18:38:48: Generated query_94.sql
2018-08-14 18:38:48: Generated query_95.sql
2018-08-14 18:38:48: Generated query_96.sql
2018-08-14 18:38:48: Generated query_97.sql
2018-08-14 18:38:48: Generated query_98.sql
2018-08-14 18:38:48: Generated query_99.sql
2018-08-14 18:38:48: Generated query_100.sql
2018-08-14 18:38:48: Generated query_101.sql
2018-08-14 18:38:48: Generated query_102.sql
2018-08-14 18:38:48: Generated query_103.sql
2018-08-14 18:38:48: Generated query_104.sql
2018-08-14 18:38:48: Script Complete!
-------------------------------------
2018-08-14 18:38:51: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:38:51: Connection pool instantiated with [1] connections
2018-08-14 18:38:54: ('spark.cores.max', '20')
2018-08-14 18:38:54: ('spark.executor.memory', '2g')
2018-08-14 18:38:54: ('spark.app.id', 'app-20180814183853-0016')
2018-08-14 18:38:54: ('spark.driver.port', '25522')
2018-08-14 18:38:54: ('spark.executor.id', 'driver')
2018-08-14 18:38:54: ('spark.python.worker.reuse', 'True')
2018-08-14 18:38:54: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:38:54: ('spark.default.parallelism', '80')
2018-08-14 18:38:54: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:38:54: ('spark.executor.instances', '20')
2018-08-14 18:38:54: ('spark.logConf', 'False')
2018-08-14 18:38:54: ('spark.rdd.compress', 'True')
2018-08-14 18:38:54: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:38:54: ('spark.driver.memory', '2g')
2018-08-14 18:38:54: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:38:54: ('spark.executor.cores', '1')
2018-08-14 18:38:54: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:38:54: ('spark.submit.deployMode', 'client')
2018-08-14 18:38:54: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:38:54: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:38:54: ('spark.app.name', 'ICS5200')
2018-08-14 18:38:54: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:38:54: Generating execution metrics for [query_1.sql]..
2018-08-14 18:38:55: Generating execution metrics for [query_2.sql]..
2018-08-14 18:38:55: Skipped DML instruction due to following exception: [ORA-00936: missing expression] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price (from select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales)), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1 ]
2018-08-14 18:38:55: Generating execution metrics for [query_3.sql]..
2018-08-14 18:38:55: Generating execution metrics for [query_4.sql]..
2018-08-14 18:39:02: Generating execution metrics for [query_5.sql]..
2018-08-14 18:39:02: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14 days) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14 days) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between cast('2000-08-19' as date) and (cast('2000-08-19' as date) + 14 days) and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 18:39:02: Generating execution metrics for [query_6.sql]..
2018-08-14 18:39:02: Generating execution metrics for [query_7.sql]..
2018-08-14 18:39:02: Generating execution metrics for [query_8.sql]..
2018-08-14 18:39:03: Generating execution metrics for [query_9.sql]..
2018-08-14 18:45:41: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:45:41: Connection pool instantiated with [1] connections
2018-08-14 18:45:44: ('spark.cores.max', '20')
2018-08-14 18:45:44: ('spark.executor.memory', '2g')
2018-08-14 18:45:44: ('spark.executor.id', 'driver')
2018-08-14 18:45:44: ('spark.python.worker.reuse', 'True')
2018-08-14 18:45:44: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:45:44: ('spark.default.parallelism', '80')
2018-08-14 18:45:44: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:45:44: ('spark.executor.instances', '20')
2018-08-14 18:45:44: ('spark.logConf', 'False')
2018-08-14 18:45:44: ('spark.rdd.compress', 'True')
2018-08-14 18:45:44: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:45:44: ('spark.driver.memory', '2g')
2018-08-14 18:45:44: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:45:44: ('spark.driver.port', '29766')
2018-08-14 18:45:44: ('spark.executor.cores', '1')
2018-08-14 18:45:44: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:45:44: ('spark.submit.deployMode', 'client')
2018-08-14 18:45:44: ('spark.app.id', 'app-20180814184543-0017')
2018-08-14 18:45:44: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:45:44: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:45:44: ('spark.app.name', 'ICS5200')
2018-08-14 18:45:44: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:45:44: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:45:44: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:45:45: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:45:45: Successfully finished migrating DML scripts!
2018-08-14 18:45:45: Starting TPC-DS sql splitting
2018-08-14 18:45:45: Generated query_1.sql
2018-08-14 18:45:45: Generated query_2.sql
2018-08-14 18:45:45: Generated query_3.sql
2018-08-14 18:45:45: Generated query_4.sql
2018-08-14 18:45:45: Generated query_5.sql
2018-08-14 18:45:45: Generated query_6.sql
2018-08-14 18:45:45: Generated query_7.sql
2018-08-14 18:45:45: Generated query_8.sql
2018-08-14 18:45:45: Generated query_9.sql
2018-08-14 18:45:45: Generated query_10.sql
2018-08-14 18:45:45: Generated query_11.sql
2018-08-14 18:45:45: Generated query_12.sql
2018-08-14 18:45:45: Generated query_13.sql
2018-08-14 18:45:45: Generated query_14.sql
2018-08-14 18:45:45: Generated query_15.sql
2018-08-14 18:45:45: Generated query_16.sql
2018-08-14 18:45:45: Generated query_17.sql
2018-08-14 18:45:45: Generated query_18.sql
2018-08-14 18:45:45: Generated query_19.sql
2018-08-14 18:45:45: Generated query_20.sql
2018-08-14 18:45:45: Generated query_21.sql
2018-08-14 18:45:45: Generated query_22.sql
2018-08-14 18:45:45: Generated query_23.sql
2018-08-14 18:45:45: Generated query_24.sql
2018-08-14 18:45:45: Generated query_25.sql
2018-08-14 18:45:45: Generated query_26.sql
2018-08-14 18:45:45: Generated query_27.sql
2018-08-14 18:45:45: Generated query_28.sql
2018-08-14 18:45:45: Generated query_29.sql
2018-08-14 18:45:45: Generated query_30.sql
2018-08-14 18:45:45: Generated query_31.sql
2018-08-14 18:45:45: Generated query_32.sql
2018-08-14 18:45:45: Generated query_33.sql
2018-08-14 18:45:45: Generated query_34.sql
2018-08-14 18:45:45: Generated query_35.sql
2018-08-14 18:45:45: Generated query_36.sql
2018-08-14 18:45:45: Generated query_37.sql
2018-08-14 18:45:45: Generated query_38.sql
2018-08-14 18:45:45: Generated query_39.sql
2018-08-14 18:45:45: Generated query_40.sql
2018-08-14 18:45:45: Generated query_41.sql
2018-08-14 18:45:45: Generated query_42.sql
2018-08-14 18:45:45: Generated query_43.sql
2018-08-14 18:45:45: Generated query_44.sql
2018-08-14 18:45:45: Generated query_45.sql
2018-08-14 18:45:45: Generated query_46.sql
2018-08-14 18:45:45: Generated query_47.sql
2018-08-14 18:45:45: Generated query_48.sql
2018-08-14 18:45:45: Generated query_49.sql
2018-08-14 18:45:45: Generated query_50.sql
2018-08-14 18:45:45: Generated query_51.sql
2018-08-14 18:45:45: Generated query_52.sql
2018-08-14 18:45:45: Generated query_53.sql
2018-08-14 18:45:45: Generated query_54.sql
2018-08-14 18:45:45: Generated query_55.sql
2018-08-14 18:45:45: Generated query_56.sql
2018-08-14 18:45:45: Generated query_57.sql
2018-08-14 18:45:45: Generated query_58.sql
2018-08-14 18:45:45: Generated query_59.sql
2018-08-14 18:45:45: Generated query_60.sql
2018-08-14 18:45:45: Generated query_61.sql
2018-08-14 18:45:45: Generated query_62.sql
2018-08-14 18:45:45: Generated query_63.sql
2018-08-14 18:45:45: Generated query_64.sql
2018-08-14 18:45:45: Generated query_65.sql
2018-08-14 18:45:45: Generated query_66.sql
2018-08-14 18:45:45: Generated query_67.sql
2018-08-14 18:45:45: Generated query_68.sql
2018-08-14 18:45:45: Generated query_69.sql
2018-08-14 18:45:45: Generated query_70.sql
2018-08-14 18:45:45: Generated query_71.sql
2018-08-14 18:45:45: Generated query_72.sql
2018-08-14 18:45:45: Generated query_73.sql
2018-08-14 18:45:45: Generated query_74.sql
2018-08-14 18:45:45: Generated query_75.sql
2018-08-14 18:45:45: Generated query_76.sql
2018-08-14 18:45:45: Generated query_77.sql
2018-08-14 18:45:45: Generated query_78.sql
2018-08-14 18:45:45: Generated query_79.sql
2018-08-14 18:45:45: Generated query_80.sql
2018-08-14 18:45:45: Generated query_81.sql
2018-08-14 18:45:45: Generated query_82.sql
2018-08-14 18:45:45: Generated query_83.sql
2018-08-14 18:45:45: Generated query_84.sql
2018-08-14 18:45:45: Generated query_85.sql
2018-08-14 18:45:45: Generated query_86.sql
2018-08-14 18:45:45: Generated query_87.sql
2018-08-14 18:45:45: Generated query_88.sql
2018-08-14 18:45:45: Generated query_89.sql
2018-08-14 18:45:45: Generated query_90.sql
2018-08-14 18:45:45: Generated query_91.sql
2018-08-14 18:45:45: Generated query_92.sql
2018-08-14 18:45:45: Generated query_93.sql
2018-08-14 18:45:45: Generated query_94.sql
2018-08-14 18:45:45: Generated query_95.sql
2018-08-14 18:45:45: Generated query_96.sql
2018-08-14 18:45:45: Generated query_97.sql
2018-08-14 18:45:45: Generated query_98.sql
2018-08-14 18:45:45: Generated query_99.sql
2018-08-14 18:45:45: Generated query_100.sql
2018-08-14 18:45:45: Generated query_101.sql
2018-08-14 18:45:45: Generated query_102.sql
2018-08-14 18:45:45: Generated query_103.sql
2018-08-14 18:45:45: Generated query_104.sql
2018-08-14 18:45:45: Script Complete!
-------------------------------------
2018-08-14 18:45:52: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:45:52: Connection pool instantiated with [1] connections
2018-08-14 18:45:55: ('spark.cores.max', '20')
2018-08-14 18:45:55: ('spark.executor.memory', '2g')
2018-08-14 18:45:55: ('spark.driver.port', '24310')
2018-08-14 18:45:55: ('spark.executor.id', 'driver')
2018-08-14 18:45:55: ('spark.python.worker.reuse', 'True')
2018-08-14 18:45:55: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:45:55: ('spark.default.parallelism', '80')
2018-08-14 18:45:55: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:45:55: ('spark.executor.instances', '20')
2018-08-14 18:45:55: ('spark.app.id', 'app-20180814184554-0018')
2018-08-14 18:45:55: ('spark.logConf', 'False')
2018-08-14 18:45:55: ('spark.rdd.compress', 'True')
2018-08-14 18:45:55: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:45:55: ('spark.driver.memory', '2g')
2018-08-14 18:45:55: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:45:55: ('spark.executor.cores', '1')
2018-08-14 18:45:55: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:45:55: ('spark.submit.deployMode', 'client')
2018-08-14 18:45:55: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:45:55: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:45:55: ('spark.app.name', 'ICS5200')
2018-08-14 18:45:55: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:45:55: Generating execution metrics for [query_1.sql]..
2018-08-14 18:45:55: Generating execution metrics for [query_2.sql]..
2018-08-14 18:46:00: Generating execution metrics for [query_3.sql]..
2018-08-14 18:46:00: Generating execution metrics for [query_4.sql]..
2018-08-14 18:46:05: Generating execution metrics for [query_5.sql]..
2018-08-14 18:46:05: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14),'yyyy-mm-dd') and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14),'yyyy-mm-dd') and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14),'yyyy-mm-dd') and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 18:46:05: Generating execution metrics for [query_6.sql]..
2018-08-14 18:46:05: Generating execution metrics for [query_7.sql]..
2018-08-14 18:46:05: Generating execution metrics for [query_8.sql]..
2018-08-14 18:46:05: Generating execution metrics for [query_9.sql]..
2018-08-14 18:46:08: Generating execution metrics for [query_10.sql]..
2018-08-14 18:46:08: Generating execution metrics for [query_11.sql]..
2018-08-14 18:46:10: Generating execution metrics for [query_12.sql]..
2018-08-14 18:46:10: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between cast('2001-06-15' as date) and (cast('2001-06-15' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 18:46:10: Generating execution metrics for [query_13.sql]..
2018-08-14 18:46:13: Generating execution metrics for [query_14.sql]..
2018-08-14 18:46:17: Generating execution metrics for [query_15.sql]..
2018-08-14 18:46:17: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 18:46:17: Generating execution metrics for [query_16.sql]..
2018-08-14 18:46:17: Generating execution metrics for [query_17.sql]..
2018-08-14 18:46:17: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 18:46:17: Generating execution metrics for [query_18.sql]..
2018-08-14 18:46:17: Generating execution metrics for [query_19.sql]..
2018-08-14 18:46:18: Generating execution metrics for [query_20.sql]..
2018-08-14 18:46:18: Generating execution metrics for [query_21.sql]..
2018-08-14 18:46:18: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 18:46:18: Generating execution metrics for [query_22.sql]..
2018-08-14 18:46:18: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 18:46:18: Generating execution metrics for [query_23.sql]..
2018-08-14 18:46:23: Generating execution metrics for [query_24.sql]..
2018-08-14 18:46:29: Generating execution metrics for [query_25.sql]..
2018-08-14 18:46:35: Generating execution metrics for [query_26.sql]..
2018-08-14 18:46:35: Generating execution metrics for [query_27.sql]..
2018-08-14 18:46:35: Generating execution metrics for [query_28.sql]..
2018-08-14 18:46:36: Generating execution metrics for [query_29.sql]..
2018-08-14 18:46:36: Generating execution metrics for [query_30.sql]..
2018-08-14 18:46:36: Generating execution metrics for [query_31.sql]..
2018-08-14 18:46:38: Generating execution metrics for [query_32.sql]..
2018-08-14 18:46:38: Generating execution metrics for [query_33.sql]..
2018-08-14 18:46:38: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 18:46:38: Generating execution metrics for [query_34.sql]..
2018-08-14 18:46:39: Generating execution metrics for [query_35.sql]..
2018-08-14 18:46:39: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 18:46:39: Generating execution metrics for [query_36.sql]..
2018-08-14 18:46:39: Generating execution metrics for [query_37.sql]..
2018-08-14 18:46:40: Generating execution metrics for [query_38.sql]..
2018-08-14 18:47:22: Generating execution metrics for [query_39.sql]..
2018-08-14 18:47:23: Generating execution metrics for [query_40.sql]..
2018-08-14 18:47:23: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 18:47:23: Generating execution metrics for [query_41.sql]..
2018-08-14 18:47:24: Generating execution metrics for [query_42.sql]..
2018-08-14 18:47:27: Generating execution metrics for [query_43.sql]..
2018-08-14 18:47:30: Generating execution metrics for [query_44.sql]..
2018-08-14 18:47:30: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 18:47:30: Generating execution metrics for [query_45.sql]..
2018-08-14 18:47:30: Generating execution metrics for [query_46.sql]..
2018-08-14 18:47:30: Generating execution metrics for [query_47.sql]..
2018-08-14 18:47:31: Generating execution metrics for [query_48.sql]..
2018-08-14 18:47:32: Generating execution metrics for [query_49.sql]..
2018-08-14 18:47:32: Generating execution metrics for [query_50.sql]..
2018-08-14 18:47:33: Generating execution metrics for [query_51.sql]..
2018-08-14 18:47:35: Generating execution metrics for [query_52.sql]..
2018-08-14 18:52:47: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:52:47: Connection pool instantiated with [1] connections
2018-08-14 18:52:50: ('spark.cores.max', '20')
2018-08-14 18:52:50: ('spark.executor.memory', '2g')
2018-08-14 18:52:50: ('spark.app.id', 'app-20180814185249-0019')
2018-08-14 18:52:50: ('spark.driver.port', '25116')
2018-08-14 18:52:50: ('spark.executor.id', 'driver')
2018-08-14 18:52:50: ('spark.python.worker.reuse', 'True')
2018-08-14 18:52:50: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:52:50: ('spark.default.parallelism', '80')
2018-08-14 18:52:50: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:52:50: ('spark.executor.instances', '20')
2018-08-14 18:52:50: ('spark.logConf', 'False')
2018-08-14 18:52:50: ('spark.rdd.compress', 'True')
2018-08-14 18:52:50: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:52:50: ('spark.driver.memory', '2g')
2018-08-14 18:52:50: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:52:50: ('spark.executor.cores', '1')
2018-08-14 18:52:50: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:52:50: ('spark.submit.deployMode', 'client')
2018-08-14 18:52:50: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:52:50: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:52:50: ('spark.app.name', 'ICS5200')
2018-08-14 18:52:50: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:52:50: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:52:50: Successfully finished migrating DML scripts!
2018-08-14 18:52:50: Starting TPC-DS sql splitting
2018-08-14 18:52:50: Generated query_1.sql
2018-08-14 18:52:50: Generated query_2.sql
2018-08-14 18:52:50: Generated query_3.sql
2018-08-14 18:52:50: Generated query_4.sql
2018-08-14 18:52:50: Generated query_5.sql
2018-08-14 18:52:50: Generated query_6.sql
2018-08-14 18:52:50: Generated query_7.sql
2018-08-14 18:52:50: Generated query_8.sql
2018-08-14 18:52:50: Generated query_9.sql
2018-08-14 18:52:50: Generated query_10.sql
2018-08-14 18:52:50: Generated query_11.sql
2018-08-14 18:52:50: Generated query_12.sql
2018-08-14 18:52:50: Generated query_13.sql
2018-08-14 18:52:50: Generated query_14.sql
2018-08-14 18:52:50: Generated query_15.sql
2018-08-14 18:52:50: Generated query_16.sql
2018-08-14 18:52:50: Generated query_17.sql
2018-08-14 18:52:50: Generated query_18.sql
2018-08-14 18:52:50: Generated query_19.sql
2018-08-14 18:52:50: Generated query_20.sql
2018-08-14 18:52:50: Generated query_21.sql
2018-08-14 18:52:50: Generated query_22.sql
2018-08-14 18:52:50: Generated query_23.sql
2018-08-14 18:52:50: Generated query_24.sql
2018-08-14 18:52:50: Generated query_25.sql
2018-08-14 18:52:50: Generated query_26.sql
2018-08-14 18:52:50: Generated query_27.sql
2018-08-14 18:52:50: Generated query_28.sql
2018-08-14 18:52:50: Generated query_29.sql
2018-08-14 18:52:50: Generated query_30.sql
2018-08-14 18:52:50: Generated query_31.sql
2018-08-14 18:52:50: Generated query_32.sql
2018-08-14 18:52:50: Generated query_33.sql
2018-08-14 18:52:50: Generated query_34.sql
2018-08-14 18:52:50: Generated query_35.sql
2018-08-14 18:52:50: Generated query_36.sql
2018-08-14 18:52:50: Generated query_37.sql
2018-08-14 18:52:50: Generated query_38.sql
2018-08-14 18:52:50: Generated query_39.sql
2018-08-14 18:52:50: Generated query_40.sql
2018-08-14 18:52:50: Generated query_41.sql
2018-08-14 18:52:50: Generated query_42.sql
2018-08-14 18:52:50: Generated query_43.sql
2018-08-14 18:52:50: Generated query_44.sql
2018-08-14 18:52:50: Generated query_45.sql
2018-08-14 18:52:50: Generated query_46.sql
2018-08-14 18:52:50: Generated query_47.sql
2018-08-14 18:52:50: Generated query_48.sql
2018-08-14 18:52:50: Generated query_49.sql
2018-08-14 18:52:50: Generated query_50.sql
2018-08-14 18:52:50: Generated query_51.sql
2018-08-14 18:52:50: Generated query_52.sql
2018-08-14 18:52:50: Generated query_53.sql
2018-08-14 18:52:50: Generated query_54.sql
2018-08-14 18:52:50: Generated query_55.sql
2018-08-14 18:52:50: Generated query_56.sql
2018-08-14 18:52:50: Generated query_57.sql
2018-08-14 18:52:50: Generated query_58.sql
2018-08-14 18:52:50: Generated query_59.sql
2018-08-14 18:52:50: Generated query_60.sql
2018-08-14 18:52:50: Generated query_61.sql
2018-08-14 18:52:50: Generated query_62.sql
2018-08-14 18:52:50: Generated query_63.sql
2018-08-14 18:52:50: Generated query_64.sql
2018-08-14 18:52:50: Generated query_65.sql
2018-08-14 18:52:50: Generated query_66.sql
2018-08-14 18:52:50: Generated query_67.sql
2018-08-14 18:52:50: Generated query_68.sql
2018-08-14 18:52:50: Generated query_69.sql
2018-08-14 18:52:50: Generated query_70.sql
2018-08-14 18:52:50: Generated query_71.sql
2018-08-14 18:52:50: Generated query_72.sql
2018-08-14 18:52:50: Generated query_73.sql
2018-08-14 18:52:50: Generated query_74.sql
2018-08-14 18:52:50: Generated query_75.sql
2018-08-14 18:52:50: Generated query_76.sql
2018-08-14 18:52:50: Generated query_77.sql
2018-08-14 18:52:50: Generated query_78.sql
2018-08-14 18:52:50: Generated query_79.sql
2018-08-14 18:52:50: Generated query_80.sql
2018-08-14 18:52:50: Generated query_81.sql
2018-08-14 18:52:50: Generated query_82.sql
2018-08-14 18:52:50: Generated query_83.sql
2018-08-14 18:52:50: Generated query_84.sql
2018-08-14 18:52:50: Generated query_85.sql
2018-08-14 18:52:50: Generated query_86.sql
2018-08-14 18:52:50: Generated query_87.sql
2018-08-14 18:52:50: Generated query_88.sql
2018-08-14 18:52:50: Generated query_89.sql
2018-08-14 18:52:50: Generated query_90.sql
2018-08-14 18:52:50: Generated query_91.sql
2018-08-14 18:52:50: Generated query_92.sql
2018-08-14 18:52:50: Generated query_93.sql
2018-08-14 18:52:50: Generated query_94.sql
2018-08-14 18:52:50: Generated query_95.sql
2018-08-14 18:52:50: Generated query_96.sql
2018-08-14 18:52:50: Generated query_97.sql
2018-08-14 18:52:50: Generated query_98.sql
2018-08-14 18:52:50: Generated query_99.sql
2018-08-14 18:52:50: Generated query_100.sql
2018-08-14 18:52:50: Generated query_101.sql
2018-08-14 18:52:50: Generated query_102.sql
2018-08-14 18:52:50: Generated query_103.sql
2018-08-14 18:52:50: Generated query_104.sql
2018-08-14 18:52:50: Script Complete!
-------------------------------------
2018-08-14 18:52:54: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:52:54: Connection pool instantiated with [1] connections
2018-08-14 18:52:57: ('spark.cores.max', '20')
2018-08-14 18:52:57: ('spark.executor.memory', '2g')
2018-08-14 18:52:57: ('spark.driver.port', '36571')
2018-08-14 18:52:57: ('spark.app.id', 'app-20180814185256-0020')
2018-08-14 18:52:57: ('spark.executor.id', 'driver')
2018-08-14 18:52:57: ('spark.python.worker.reuse', 'True')
2018-08-14 18:52:57: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:52:57: ('spark.default.parallelism', '80')
2018-08-14 18:52:57: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:52:57: ('spark.executor.instances', '20')
2018-08-14 18:52:57: ('spark.logConf', 'False')
2018-08-14 18:52:57: ('spark.rdd.compress', 'True')
2018-08-14 18:52:57: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 18:52:57: ('spark.driver.memory', '2g')
2018-08-14 18:52:57: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:52:57: ('spark.executor.cores', '1')
2018-08-14 18:52:57: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:52:57: ('spark.submit.deployMode', 'client')
2018-08-14 18:52:57: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:52:57: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:52:57: ('spark.app.name', 'ICS5200')
2018-08-14 18:52:57: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:52:57: Generating execution metrics for [query_1.sql]..
2018-08-14 18:52:57: Generating execution metrics for [query_2.sql]..
2018-08-14 18:53:01: Generating execution metrics for [query_3.sql]..
2018-08-14 18:53:01: Generating execution metrics for [query_4.sql]..
2018-08-14 18:53:05: Generating execution metrics for [query_5.sql]..
2018-08-14 18:53:05: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14,'yyyy-mm-dd') and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14,'yyyy-mm-dd') and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14,'yyyy-mm-dd') and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100 ]
2018-08-14 18:53:05: Generating execution metrics for [query_6.sql]..
2018-08-14 18:53:06: Generating execution metrics for [query_7.sql]..
2018-08-14 18:53:06: Generating execution metrics for [query_8.sql]..
2018-08-14 18:53:06: Generating execution metrics for [query_9.sql]..
2018-08-14 18:53:08: Generating execution metrics for [query_10.sql]..
2018-08-14 18:53:09: Generating execution metrics for [query_11.sql]..
2018-08-14 18:53:11: Generating execution metrics for [query_12.sql]..
2018-08-14 18:53:11: Generating execution metrics for [query_13.sql]..
2018-08-14 18:54:22: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:54:22: Connection pool instantiated with [1] connections
2018-08-14 18:54:25: ('spark.cores.max', '20')
2018-08-14 18:54:25: ('spark.executor.memory', '2g')
2018-08-14 18:54:25: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 18:54:25: ('spark.executor.id', 'driver')
2018-08-14 18:54:25: ('spark.python.worker.reuse', 'True')
2018-08-14 18:54:25: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:54:25: ('spark.default.parallelism', '80')
2018-08-14 18:54:25: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:54:25: ('spark.executor.instances', '20')
2018-08-14 18:54:25: ('spark.driver.port', '25219')
2018-08-14 18:54:25: ('spark.app.id', 'app-20180814185425-0021')
2018-08-14 18:54:25: ('spark.logConf', 'False')
2018-08-14 18:54:25: ('spark.rdd.compress', 'True')
2018-08-14 18:54:25: ('spark.driver.memory', '2g')
2018-08-14 18:54:25: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:54:25: ('spark.executor.cores', '1')
2018-08-14 18:54:25: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:54:25: ('spark.submit.deployMode', 'client')
2018-08-14 18:54:25: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:54:25: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:54:25: ('spark.app.name', 'ICS5200')
2018-08-14 18:54:25: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 18:54:25: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 18:54:25: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 18:54:26: Successfully finished migrating DML scripts!
2018-08-14 18:54:26: Starting TPC-DS sql splitting
2018-08-14 18:54:26: Generated query_1.sql
2018-08-14 18:54:26: Generated query_2.sql
2018-08-14 18:54:26: Generated query_3.sql
2018-08-14 18:54:26: Generated query_4.sql
2018-08-14 18:54:26: Generated query_5.sql
2018-08-14 18:54:26: Generated query_6.sql
2018-08-14 18:54:26: Generated query_7.sql
2018-08-14 18:54:26: Generated query_8.sql
2018-08-14 18:54:26: Generated query_9.sql
2018-08-14 18:54:26: Generated query_10.sql
2018-08-14 18:54:26: Generated query_11.sql
2018-08-14 18:54:26: Generated query_12.sql
2018-08-14 18:54:26: Generated query_13.sql
2018-08-14 18:54:26: Generated query_14.sql
2018-08-14 18:54:26: Generated query_15.sql
2018-08-14 18:54:26: Generated query_16.sql
2018-08-14 18:54:26: Generated query_17.sql
2018-08-14 18:54:26: Generated query_18.sql
2018-08-14 18:54:26: Generated query_19.sql
2018-08-14 18:54:26: Generated query_20.sql
2018-08-14 18:54:26: Generated query_21.sql
2018-08-14 18:54:26: Generated query_22.sql
2018-08-14 18:54:26: Generated query_23.sql
2018-08-14 18:54:26: Generated query_24.sql
2018-08-14 18:54:26: Generated query_25.sql
2018-08-14 18:54:26: Generated query_26.sql
2018-08-14 18:54:26: Generated query_27.sql
2018-08-14 18:54:26: Generated query_28.sql
2018-08-14 18:54:26: Generated query_29.sql
2018-08-14 18:54:26: Generated query_30.sql
2018-08-14 18:54:26: Generated query_31.sql
2018-08-14 18:54:26: Generated query_32.sql
2018-08-14 18:54:26: Generated query_33.sql
2018-08-14 18:54:26: Generated query_34.sql
2018-08-14 18:54:26: Generated query_35.sql
2018-08-14 18:54:26: Generated query_36.sql
2018-08-14 18:54:26: Generated query_37.sql
2018-08-14 18:54:26: Generated query_38.sql
2018-08-14 18:54:26: Generated query_39.sql
2018-08-14 18:54:26: Generated query_40.sql
2018-08-14 18:54:26: Generated query_41.sql
2018-08-14 18:54:26: Generated query_42.sql
2018-08-14 18:54:26: Generated query_43.sql
2018-08-14 18:54:26: Generated query_44.sql
2018-08-14 18:54:26: Generated query_45.sql
2018-08-14 18:54:26: Generated query_46.sql
2018-08-14 18:54:26: Generated query_47.sql
2018-08-14 18:54:26: Generated query_48.sql
2018-08-14 18:54:26: Generated query_49.sql
2018-08-14 18:54:26: Generated query_50.sql
2018-08-14 18:54:26: Generated query_51.sql
2018-08-14 18:54:26: Generated query_52.sql
2018-08-14 18:54:26: Generated query_53.sql
2018-08-14 18:54:26: Generated query_54.sql
2018-08-14 18:54:26: Generated query_55.sql
2018-08-14 18:54:26: Generated query_56.sql
2018-08-14 18:54:26: Generated query_57.sql
2018-08-14 18:54:26: Generated query_58.sql
2018-08-14 18:54:26: Generated query_59.sql
2018-08-14 18:54:26: Generated query_60.sql
2018-08-14 18:54:26: Generated query_61.sql
2018-08-14 18:54:26: Generated query_62.sql
2018-08-14 18:54:26: Generated query_63.sql
2018-08-14 18:54:26: Generated query_64.sql
2018-08-14 18:54:26: Generated query_65.sql
2018-08-14 18:54:26: Generated query_66.sql
2018-08-14 18:54:26: Generated query_67.sql
2018-08-14 18:54:26: Generated query_68.sql
2018-08-14 18:54:26: Generated query_69.sql
2018-08-14 18:54:26: Generated query_70.sql
2018-08-14 18:54:26: Generated query_71.sql
2018-08-14 18:54:26: Generated query_72.sql
2018-08-14 18:54:26: Generated query_73.sql
2018-08-14 18:54:26: Generated query_74.sql
2018-08-14 18:54:26: Generated query_75.sql
2018-08-14 18:54:26: Generated query_76.sql
2018-08-14 18:54:26: Generated query_77.sql
2018-08-14 18:54:26: Generated query_78.sql
2018-08-14 18:54:26: Generated query_79.sql
2018-08-14 18:54:26: Generated query_80.sql
2018-08-14 18:54:26: Generated query_81.sql
2018-08-14 18:54:26: Generated query_82.sql
2018-08-14 18:54:26: Generated query_83.sql
2018-08-14 18:54:26: Generated query_84.sql
2018-08-14 18:54:26: Generated query_85.sql
2018-08-14 18:54:26: Generated query_86.sql
2018-08-14 18:54:26: Generated query_87.sql
2018-08-14 18:54:26: Generated query_88.sql
2018-08-14 18:54:26: Generated query_89.sql
2018-08-14 18:54:26: Generated query_90.sql
2018-08-14 18:54:26: Generated query_91.sql
2018-08-14 18:54:26: Generated query_92.sql
2018-08-14 18:54:26: Generated query_93.sql
2018-08-14 18:54:26: Generated query_94.sql
2018-08-14 18:54:26: Generated query_95.sql
2018-08-14 18:54:26: Generated query_96.sql
2018-08-14 18:54:26: Generated query_97.sql
2018-08-14 18:54:26: Generated query_98.sql
2018-08-14 18:54:26: Generated query_99.sql
2018-08-14 18:54:26: Generated query_100.sql
2018-08-14 18:54:26: Generated query_101.sql
2018-08-14 18:54:26: Generated query_102.sql
2018-08-14 18:54:26: Generated query_103.sql
2018-08-14 18:54:26: Generated query_104.sql
2018-08-14 18:54:26: Script Complete!
-------------------------------------
2018-08-14 18:54:27: Connected to database [gabsam] with user [tpcds1]
2018-08-14 18:54:27: Connection pool instantiated with [1] connections
2018-08-14 18:54:30: ('spark.cores.max', '20')
2018-08-14 18:54:30: ('spark.executor.memory', '2g')
2018-08-14 18:54:30: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 18:54:30: ('spark.executor.id', 'driver')
2018-08-14 18:54:30: ('spark.python.worker.reuse', 'True')
2018-08-14 18:54:30: ('spark.driver.maxResultSize', '1g')
2018-08-14 18:54:30: ('spark.default.parallelism', '80')
2018-08-14 18:54:30: ('spark.sql.shuffle.partitions', '80')
2018-08-14 18:54:30: ('spark.driver.port', '35756')
2018-08-14 18:54:30: ('spark.executor.instances', '20')
2018-08-14 18:54:30: ('spark.logConf', 'False')
2018-08-14 18:54:30: ('spark.rdd.compress', 'True')
2018-08-14 18:54:30: ('spark.driver.memory', '2g')
2018-08-14 18:54:30: ('spark.serializer.objectStreamReset', '100')
2018-08-14 18:54:30: ('spark.executor.cores', '1')
2018-08-14 18:54:30: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 18:54:30: ('spark.submit.deployMode', 'client')
2018-08-14 18:54:30: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 18:54:30: ('spark.app.id', 'app-20180814185430-0022')
2018-08-14 18:54:30: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 18:54:30: ('spark.app.name', 'ICS5200')
2018-08-14 18:54:30: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 18:54:30: Generating execution metrics for [query_1.sql]..
2018-08-14 18:54:31: Generating execution metrics for [query_2.sql]..
2018-08-14 18:54:35: Generating execution metrics for [query_3.sql]..
2018-08-14 18:54:35: Generating execution metrics for [query_4.sql]..
2018-08-14 18:54:40: Generating execution metrics for [query_5.sql]..
2018-08-14 18:54:43: Generating execution metrics for [query_6.sql]..
2018-08-14 18:54:43: Generating execution metrics for [query_7.sql]..
2018-08-14 18:54:43: Generating execution metrics for [query_8.sql]..
2018-08-14 18:54:43: Generating execution metrics for [query_9.sql]..
2018-08-14 18:54:46: Generating execution metrics for [query_10.sql]..
2018-08-14 18:54:46: Generating execution metrics for [query_11.sql]..
2018-08-14 18:54:48: Generating execution metrics for [query_12.sql]..
2018-08-14 18:54:48: Generating execution metrics for [query_13.sql]..
2018-08-14 18:54:51: Generating execution metrics for [query_14.sql]..
2018-08-14 18:54:54: Generating execution metrics for [query_15.sql]..
2018-08-14 18:54:54: Skipped DML instruction due to following exception: [ORA-00918: column ambiguously defined] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select * from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 18:54:55: Generating execution metrics for [query_16.sql]..
2018-08-14 18:54:55: Generating execution metrics for [query_17.sql]..
2018-08-14 18:54:55: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 18:54:55: Generating execution metrics for [query_18.sql]..
2018-08-14 18:54:55: Generating execution metrics for [query_19.sql]..
2018-08-14 18:54:56: Generating execution metrics for [query_20.sql]..
2018-08-14 18:54:56: Generating execution metrics for [query_21.sql]..
2018-08-14 18:54:56: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 18:54:56: Generating execution metrics for [query_22.sql]..
2018-08-14 18:54:56: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 18:54:56: Generating execution metrics for [query_23.sql]..
2018-08-14 18:55:01: Generating execution metrics for [query_24.sql]..
2018-08-14 18:55:07: Generating execution metrics for [query_25.sql]..
2018-08-14 18:55:13: Generating execution metrics for [query_26.sql]..
2018-08-14 18:55:13: Generating execution metrics for [query_27.sql]..
2018-08-14 18:55:13: Generating execution metrics for [query_28.sql]..
2018-08-14 18:55:13: Generating execution metrics for [query_29.sql]..
2018-08-14 18:55:13: Generating execution metrics for [query_30.sql]..
2018-08-14 18:55:14: Generating execution metrics for [query_31.sql]..
2018-08-14 18:55:16: Generating execution metrics for [query_32.sql]..
2018-08-14 18:55:16: Generating execution metrics for [query_33.sql]..
2018-08-14 18:55:16: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 18:55:16: Generating execution metrics for [query_34.sql]..
2018-08-14 18:55:17: Generating execution metrics for [query_35.sql]..
2018-08-14 18:55:17: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 18:55:17: Generating execution metrics for [query_36.sql]..
2018-08-14 18:55:17: Generating execution metrics for [query_37.sql]..
2018-08-14 18:55:18: Generating execution metrics for [query_38.sql]..
2018-08-14 18:56:00: Generating execution metrics for [query_39.sql]..
2018-08-14 18:56:01: Generating execution metrics for [query_40.sql]..
2018-08-14 18:56:01: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 18:56:01: Generating execution metrics for [query_41.sql]..
2018-08-14 18:56:01: Generating execution metrics for [query_42.sql]..
2018-08-14 18:56:05: Generating execution metrics for [query_43.sql]..
2018-08-14 18:56:08: Generating execution metrics for [query_44.sql]..
2018-08-14 18:56:08: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 18:56:08: Generating execution metrics for [query_45.sql]..
2018-08-14 18:56:08: Generating execution metrics for [query_46.sql]..
2018-08-14 18:56:08: Generating execution metrics for [query_47.sql]..
2018-08-14 18:56:09: Generating execution metrics for [query_48.sql]..
2018-08-14 18:56:10: Generating execution metrics for [query_49.sql]..
2018-08-14 18:56:10: Generating execution metrics for [query_50.sql]..
2018-08-14 18:56:11: Generating execution metrics for [query_51.sql]..
2018-08-14 18:56:13: Generating execution metrics for [query_52.sql]..
2018-08-14 19:05:22: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:05:22: Connection pool instantiated with [1] connections
2018-08-14 19:05:25: ('spark.cores.max', '20')
2018-08-14 19:05:25: ('spark.executor.memory', '2g')
2018-08-14 19:05:25: ('spark.app.id', 'app-20180814190525-0023')
2018-08-14 19:05:25: ('spark.driver.port', '21556')
2018-08-14 19:05:25: ('spark.executor.id', 'driver')
2018-08-14 19:05:25: ('spark.python.worker.reuse', 'True')
2018-08-14 19:05:25: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:05:25: ('spark.default.parallelism', '80')
2018-08-14 19:05:25: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:05:25: ('spark.executor.instances', '20')
2018-08-14 19:05:25: ('spark.logConf', 'False')
2018-08-14 19:05:25: ('spark.rdd.compress', 'True')
2018-08-14 19:05:25: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 19:05:25: ('spark.driver.memory', '2g')
2018-08-14 19:05:25: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:05:25: ('spark.executor.cores', '1')
2018-08-14 19:05:25: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:05:25: ('spark.submit.deployMode', 'client')
2018-08-14 19:05:25: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:05:25: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:05:25: ('spark.app.name', 'ICS5200')
2018-08-14 19:05:25: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 19:05:25: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 19:05:25: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 19:05:26: Successfully finished migrating DML scripts!
2018-08-14 19:05:26: Starting TPC-DS sql splitting
2018-08-14 19:05:26: Generated query_1.sql
2018-08-14 19:05:26: Generated query_2.sql
2018-08-14 19:05:26: Generated query_3.sql
2018-08-14 19:05:26: Generated query_4.sql
2018-08-14 19:05:26: Generated query_5.sql
2018-08-14 19:05:26: Generated query_6.sql
2018-08-14 19:05:26: Generated query_7.sql
2018-08-14 19:05:26: Generated query_8.sql
2018-08-14 19:05:26: Generated query_9.sql
2018-08-14 19:05:26: Generated query_10.sql
2018-08-14 19:05:26: Generated query_11.sql
2018-08-14 19:05:26: Generated query_12.sql
2018-08-14 19:05:26: Generated query_13.sql
2018-08-14 19:05:26: Generated query_14.sql
2018-08-14 19:05:26: Generated query_15.sql
2018-08-14 19:05:26: Generated query_16.sql
2018-08-14 19:05:26: Generated query_17.sql
2018-08-14 19:05:26: Generated query_18.sql
2018-08-14 19:05:26: Generated query_19.sql
2018-08-14 19:05:26: Generated query_20.sql
2018-08-14 19:05:26: Generated query_21.sql
2018-08-14 19:05:26: Generated query_22.sql
2018-08-14 19:05:26: Generated query_23.sql
2018-08-14 19:05:26: Generated query_24.sql
2018-08-14 19:05:26: Generated query_25.sql
2018-08-14 19:05:26: Generated query_26.sql
2018-08-14 19:05:26: Generated query_27.sql
2018-08-14 19:05:26: Generated query_28.sql
2018-08-14 19:05:26: Generated query_29.sql
2018-08-14 19:05:26: Generated query_30.sql
2018-08-14 19:05:26: Generated query_31.sql
2018-08-14 19:05:26: Generated query_32.sql
2018-08-14 19:05:26: Generated query_33.sql
2018-08-14 19:05:26: Generated query_34.sql
2018-08-14 19:05:26: Generated query_35.sql
2018-08-14 19:05:26: Generated query_36.sql
2018-08-14 19:05:26: Generated query_37.sql
2018-08-14 19:05:26: Generated query_38.sql
2018-08-14 19:05:26: Generated query_39.sql
2018-08-14 19:05:26: Generated query_40.sql
2018-08-14 19:05:26: Generated query_41.sql
2018-08-14 19:05:26: Generated query_42.sql
2018-08-14 19:05:26: Generated query_43.sql
2018-08-14 19:05:26: Generated query_44.sql
2018-08-14 19:05:26: Generated query_45.sql
2018-08-14 19:05:26: Generated query_46.sql
2018-08-14 19:05:26: Generated query_47.sql
2018-08-14 19:05:26: Generated query_48.sql
2018-08-14 19:05:26: Generated query_49.sql
2018-08-14 19:05:26: Generated query_50.sql
2018-08-14 19:05:26: Generated query_51.sql
2018-08-14 19:05:26: Generated query_52.sql
2018-08-14 19:05:26: Generated query_53.sql
2018-08-14 19:05:26: Generated query_54.sql
2018-08-14 19:05:26: Generated query_55.sql
2018-08-14 19:05:26: Generated query_56.sql
2018-08-14 19:05:26: Generated query_57.sql
2018-08-14 19:05:26: Generated query_58.sql
2018-08-14 19:05:26: Generated query_59.sql
2018-08-14 19:05:26: Generated query_60.sql
2018-08-14 19:05:26: Generated query_61.sql
2018-08-14 19:05:26: Generated query_62.sql
2018-08-14 19:05:26: Generated query_63.sql
2018-08-14 19:05:26: Generated query_64.sql
2018-08-14 19:05:26: Generated query_65.sql
2018-08-14 19:05:26: Generated query_66.sql
2018-08-14 19:05:26: Generated query_67.sql
2018-08-14 19:05:26: Generated query_68.sql
2018-08-14 19:05:26: Generated query_69.sql
2018-08-14 19:05:26: Generated query_70.sql
2018-08-14 19:05:26: Generated query_71.sql
2018-08-14 19:05:26: Generated query_72.sql
2018-08-14 19:05:26: Generated query_73.sql
2018-08-14 19:05:26: Generated query_74.sql
2018-08-14 19:05:26: Generated query_75.sql
2018-08-14 19:05:26: Generated query_76.sql
2018-08-14 19:05:26: Generated query_77.sql
2018-08-14 19:05:26: Generated query_78.sql
2018-08-14 19:05:26: Generated query_79.sql
2018-08-14 19:05:26: Generated query_80.sql
2018-08-14 19:05:26: Generated query_81.sql
2018-08-14 19:05:26: Generated query_82.sql
2018-08-14 19:05:26: Generated query_83.sql
2018-08-14 19:05:26: Generated query_84.sql
2018-08-14 19:05:26: Generated query_85.sql
2018-08-14 19:05:26: Generated query_86.sql
2018-08-14 19:05:26: Generated query_87.sql
2018-08-14 19:05:26: Generated query_88.sql
2018-08-14 19:05:26: Generated query_89.sql
2018-08-14 19:05:26: Generated query_90.sql
2018-08-14 19:05:26: Generated query_91.sql
2018-08-14 19:05:26: Generated query_92.sql
2018-08-14 19:05:26: Generated query_93.sql
2018-08-14 19:05:26: Generated query_94.sql
2018-08-14 19:05:26: Generated query_95.sql
2018-08-14 19:05:26: Generated query_96.sql
2018-08-14 19:05:26: Generated query_97.sql
2018-08-14 19:05:26: Generated query_98.sql
2018-08-14 19:05:26: Generated query_99.sql
2018-08-14 19:05:26: Generated query_100.sql
2018-08-14 19:05:26: Generated query_101.sql
2018-08-14 19:05:26: Generated query_102.sql
2018-08-14 19:05:26: Generated query_103.sql
2018-08-14 19:05:26: Generated query_104.sql
2018-08-14 19:05:26: Script Complete!
-------------------------------------
2018-08-14 19:05:29: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:05:29: Connection pool instantiated with [1] connections
2018-08-14 19:05:31: ('spark.cores.max', '20')
2018-08-14 19:05:31: ('spark.executor.memory', '2g')
2018-08-14 19:05:31: ('spark.app.id', 'app-20180814190531-0024')
2018-08-14 19:05:31: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 19:05:31: ('spark.executor.id', 'driver')
2018-08-14 19:05:31: ('spark.python.worker.reuse', 'True')
2018-08-14 19:05:31: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:05:31: ('spark.default.parallelism', '80')
2018-08-14 19:05:31: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:05:31: ('spark.executor.instances', '20')
2018-08-14 19:05:31: ('spark.driver.port', '15240')
2018-08-14 19:05:31: ('spark.logConf', 'False')
2018-08-14 19:05:31: ('spark.rdd.compress', 'True')
2018-08-14 19:05:31: ('spark.driver.memory', '2g')
2018-08-14 19:05:31: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:05:31: ('spark.executor.cores', '1')
2018-08-14 19:05:31: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:05:31: ('spark.submit.deployMode', 'client')
2018-08-14 19:05:31: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:05:31: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:05:31: ('spark.app.name', 'ICS5200')
2018-08-14 19:05:32: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 19:05:32: Generating execution metrics for [query_1.sql]..
2018-08-14 19:05:32: Generating execution metrics for [query_2.sql]..
2018-08-14 19:05:36: Generating execution metrics for [query_3.sql]..
2018-08-14 19:05:36: Generating execution metrics for [query_4.sql]..
2018-08-14 19:05:41: Generating execution metrics for [query_5.sql]..
2018-08-14 19:05:44: Generating execution metrics for [query_6.sql]..
2018-08-14 19:05:44: Generating execution metrics for [query_7.sql]..
2018-08-14 19:05:44: Generating execution metrics for [query_8.sql]..
2018-08-14 19:05:45: Generating execution metrics for [query_9.sql]..
2018-08-14 19:05:47: Generating execution metrics for [query_10.sql]..
2018-08-14 19:05:47: Generating execution metrics for [query_11.sql]..
2018-08-14 19:05:49: Generating execution metrics for [query_12.sql]..
2018-08-14 19:05:49: Generating execution metrics for [query_13.sql]..
2018-08-14 19:05:53: Generating execution metrics for [query_14.sql]..
2018-08-14 19:05:56: Generating execution metrics for [query_15.sql]..
2018-08-14 19:05:59: Generating execution metrics for [query_16.sql]..
2018-08-14 19:06:00: Generating execution metrics for [query_17.sql]..
2018-08-14 19:06:00: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 19:06:00: Generating execution metrics for [query_18.sql]..
2018-08-14 19:06:00: Generating execution metrics for [query_19.sql]..
2018-08-14 19:06:01: Generating execution metrics for [query_20.sql]..
2018-08-14 19:06:01: Generating execution metrics for [query_21.sql]..
2018-08-14 19:06:01: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 19:06:01: Generating execution metrics for [query_22.sql]..
2018-08-14 19:06:01: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 19:06:01: Generating execution metrics for [query_23.sql]..
2018-08-14 19:06:06: Generating execution metrics for [query_24.sql]..
2018-08-14 19:06:12: Generating execution metrics for [query_25.sql]..
2018-08-14 19:06:18: Generating execution metrics for [query_26.sql]..
2018-08-14 19:06:18: Generating execution metrics for [query_27.sql]..
2018-08-14 19:06:19: Generating execution metrics for [query_28.sql]..
2018-08-14 19:06:19: Generating execution metrics for [query_29.sql]..
2018-08-14 19:06:19: Generating execution metrics for [query_30.sql]..
2018-08-14 19:06:20: Generating execution metrics for [query_31.sql]..
2018-08-14 19:06:21: Generating execution metrics for [query_32.sql]..
2018-08-14 19:06:21: Generating execution metrics for [query_33.sql]..
2018-08-14 19:06:21: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 19:06:22: Generating execution metrics for [query_34.sql]..
2018-08-14 19:06:23: Generating execution metrics for [query_35.sql]..
2018-08-14 19:06:23: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 19:06:23: Generating execution metrics for [query_36.sql]..
2018-08-14 19:06:23: Generating execution metrics for [query_37.sql]..
2018-08-14 19:06:24: Generating execution metrics for [query_38.sql]..
2018-08-14 19:07:08: Generating execution metrics for [query_39.sql]..
2018-08-14 19:07:09: Generating execution metrics for [query_40.sql]..
2018-08-14 19:07:09: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 19:07:09: Generating execution metrics for [query_41.sql]..
2018-08-14 19:07:10: Generating execution metrics for [query_42.sql]..
2018-08-14 19:07:13: Generating execution metrics for [query_43.sql]..
2018-08-14 19:07:16: Generating execution metrics for [query_44.sql]..
2018-08-14 19:07:16: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 19:07:16: Generating execution metrics for [query_45.sql]..
2018-08-14 19:07:16: Generating execution metrics for [query_46.sql]..
2018-08-14 19:07:16: Generating execution metrics for [query_47.sql]..
2018-08-14 19:07:17: Generating execution metrics for [query_48.sql]..
2018-08-14 19:07:18: Generating execution metrics for [query_49.sql]..
2018-08-14 19:07:18: Generating execution metrics for [query_50.sql]..
2018-08-14 19:07:19: Generating execution metrics for [query_51.sql]..
2018-08-14 19:07:21: Generating execution metrics for [query_52.sql]..
2018-08-14 19:12:19: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:12:19: Connection pool instantiated with [1] connections
2018-08-14 19:12:21: ('spark.cores.max', '20')
2018-08-14 19:12:21: ('spark.executor.memory', '2g')
2018-08-14 19:12:21: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 19:12:21: ('spark.app.id', 'app-20180814191221-0025')
2018-08-14 19:12:21: ('spark.executor.id', 'driver')
2018-08-14 19:12:21: ('spark.python.worker.reuse', 'True')
2018-08-14 19:12:21: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:12:21: ('spark.default.parallelism', '80')
2018-08-14 19:12:21: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:12:21: ('spark.executor.instances', '20')
2018-08-14 19:12:21: ('spark.logConf', 'False')
2018-08-14 19:12:21: ('spark.rdd.compress', 'True')
2018-08-14 19:12:21: ('spark.driver.memory', '2g')
2018-08-14 19:12:21: ('spark.driver.port', '33909')
2018-08-14 19:12:21: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:12:21: ('spark.executor.cores', '1')
2018-08-14 19:12:21: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:12:21: ('spark.submit.deployMode', 'client')
2018-08-14 19:12:21: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:12:21: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:12:21: ('spark.app.name', 'ICS5200')
2018-08-14 19:12:21: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 19:12:21: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 19:12:21: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 19:12:21: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 19:12:21: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 19:12:22: Successfully finished migrating DML scripts!
2018-08-14 19:12:22: Starting TPC-DS sql splitting
2018-08-14 19:12:22: Generated query_1.sql
2018-08-14 19:12:22: Generated query_2.sql
2018-08-14 19:12:22: Generated query_3.sql
2018-08-14 19:12:22: Generated query_4.sql
2018-08-14 19:12:22: Generated query_5.sql
2018-08-14 19:12:22: Generated query_6.sql
2018-08-14 19:12:22: Generated query_7.sql
2018-08-14 19:12:22: Generated query_8.sql
2018-08-14 19:12:22: Generated query_9.sql
2018-08-14 19:12:22: Generated query_10.sql
2018-08-14 19:12:22: Generated query_11.sql
2018-08-14 19:12:22: Generated query_12.sql
2018-08-14 19:12:22: Generated query_13.sql
2018-08-14 19:12:22: Generated query_14.sql
2018-08-14 19:12:22: Generated query_15.sql
2018-08-14 19:12:22: Generated query_16.sql
2018-08-14 19:12:22: Generated query_17.sql
2018-08-14 19:12:22: Generated query_18.sql
2018-08-14 19:12:22: Generated query_19.sql
2018-08-14 19:12:22: Generated query_20.sql
2018-08-14 19:12:22: Generated query_21.sql
2018-08-14 19:12:22: Generated query_22.sql
2018-08-14 19:12:22: Generated query_23.sql
2018-08-14 19:12:22: Generated query_24.sql
2018-08-14 19:12:22: Generated query_25.sql
2018-08-14 19:12:22: Generated query_26.sql
2018-08-14 19:12:22: Generated query_27.sql
2018-08-14 19:12:22: Generated query_28.sql
2018-08-14 19:12:22: Generated query_29.sql
2018-08-14 19:12:22: Generated query_30.sql
2018-08-14 19:12:22: Generated query_31.sql
2018-08-14 19:12:22: Generated query_32.sql
2018-08-14 19:12:22: Generated query_33.sql
2018-08-14 19:12:22: Generated query_34.sql
2018-08-14 19:12:22: Generated query_35.sql
2018-08-14 19:12:22: Generated query_36.sql
2018-08-14 19:12:22: Generated query_37.sql
2018-08-14 19:12:22: Generated query_38.sql
2018-08-14 19:12:22: Generated query_39.sql
2018-08-14 19:12:22: Generated query_40.sql
2018-08-14 19:12:22: Generated query_41.sql
2018-08-14 19:12:22: Generated query_42.sql
2018-08-14 19:12:22: Generated query_43.sql
2018-08-14 19:12:22: Generated query_44.sql
2018-08-14 19:12:22: Generated query_45.sql
2018-08-14 19:12:22: Generated query_46.sql
2018-08-14 19:12:22: Generated query_47.sql
2018-08-14 19:12:22: Generated query_48.sql
2018-08-14 19:12:22: Generated query_49.sql
2018-08-14 19:12:22: Generated query_50.sql
2018-08-14 19:12:22: Generated query_51.sql
2018-08-14 19:12:22: Generated query_52.sql
2018-08-14 19:12:22: Generated query_53.sql
2018-08-14 19:12:22: Generated query_54.sql
2018-08-14 19:12:22: Generated query_55.sql
2018-08-14 19:12:22: Generated query_56.sql
2018-08-14 19:12:22: Generated query_57.sql
2018-08-14 19:12:22: Generated query_58.sql
2018-08-14 19:12:22: Generated query_59.sql
2018-08-14 19:12:22: Generated query_60.sql
2018-08-14 19:12:22: Generated query_61.sql
2018-08-14 19:12:22: Generated query_62.sql
2018-08-14 19:12:22: Generated query_63.sql
2018-08-14 19:12:22: Generated query_64.sql
2018-08-14 19:12:22: Generated query_65.sql
2018-08-14 19:12:22: Generated query_66.sql
2018-08-14 19:12:22: Generated query_67.sql
2018-08-14 19:12:22: Generated query_68.sql
2018-08-14 19:12:22: Generated query_69.sql
2018-08-14 19:12:22: Generated query_70.sql
2018-08-14 19:12:22: Generated query_71.sql
2018-08-14 19:12:22: Generated query_72.sql
2018-08-14 19:12:22: Generated query_73.sql
2018-08-14 19:12:22: Generated query_74.sql
2018-08-14 19:12:22: Generated query_75.sql
2018-08-14 19:12:22: Generated query_76.sql
2018-08-14 19:12:22: Generated query_77.sql
2018-08-14 19:12:22: Generated query_78.sql
2018-08-14 19:12:22: Generated query_79.sql
2018-08-14 19:12:22: Generated query_80.sql
2018-08-14 19:12:22: Generated query_81.sql
2018-08-14 19:12:22: Generated query_82.sql
2018-08-14 19:12:22: Generated query_83.sql
2018-08-14 19:12:22: Generated query_84.sql
2018-08-14 19:12:22: Generated query_85.sql
2018-08-14 19:12:22: Generated query_86.sql
2018-08-14 19:12:22: Generated query_87.sql
2018-08-14 19:12:22: Generated query_88.sql
2018-08-14 19:12:22: Generated query_89.sql
2018-08-14 19:12:22: Generated query_90.sql
2018-08-14 19:12:22: Generated query_91.sql
2018-08-14 19:12:22: Generated query_92.sql
2018-08-14 19:12:22: Generated query_93.sql
2018-08-14 19:12:22: Generated query_94.sql
2018-08-14 19:12:22: Generated query_95.sql
2018-08-14 19:12:22: Generated query_96.sql
2018-08-14 19:12:22: Generated query_97.sql
2018-08-14 19:12:22: Generated query_98.sql
2018-08-14 19:12:22: Generated query_99.sql
2018-08-14 19:12:22: Generated query_100.sql
2018-08-14 19:12:22: Generated query_101.sql
2018-08-14 19:12:22: Generated query_102.sql
2018-08-14 19:12:22: Generated query_103.sql
2018-08-14 19:12:22: Generated query_104.sql
2018-08-14 19:12:22: Script Complete!
-------------------------------------
2018-08-14 19:12:27: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:12:27: Connection pool instantiated with [1] connections
2018-08-14 19:12:30: ('spark.cores.max', '20')
2018-08-14 19:12:30: ('spark.executor.memory', '2g')
2018-08-14 19:12:30: ('spark.executor.id', 'driver')
2018-08-14 19:12:30: ('spark.python.worker.reuse', 'True')
2018-08-14 19:12:30: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:12:30: ('spark.default.parallelism', '80')
2018-08-14 19:12:30: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:12:30: ('spark.executor.instances', '20')
2018-08-14 19:12:30: ('spark.driver.port', '13078')
2018-08-14 19:12:30: ('spark.app.id', 'app-20180814191229-0026')
2018-08-14 19:12:30: ('spark.logConf', 'False')
2018-08-14 19:12:30: ('spark.rdd.compress', 'True')
2018-08-14 19:12:30: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 19:12:30: ('spark.driver.memory', '2g')
2018-08-14 19:12:30: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:12:30: ('spark.executor.cores', '1')
2018-08-14 19:12:30: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:12:30: ('spark.submit.deployMode', 'client')
2018-08-14 19:12:30: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:12:30: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:12:30: ('spark.app.name', 'ICS5200')
2018-08-14 19:12:30: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 19:12:30: Generating execution metrics for [query_1.sql]..
2018-08-14 19:12:30: 1
2018-08-14 19:12:30: 1
2018-08-14 19:12:30: Generating execution metrics for [query_2.sql]..
2018-08-14 19:12:34: 2
2018-08-14 19:12:34: 2
2018-08-14 19:12:34: Generating execution metrics for [query_3.sql]..
2018-08-14 19:12:34: 3
2018-08-14 19:12:34: 3
2018-08-14 19:12:34: Generating execution metrics for [query_4.sql]..
2018-08-14 19:12:39: 4
2018-08-14 19:12:39: 4
2018-08-14 19:12:39: Generating execution metrics for [query_5.sql]..
2018-08-14 19:12:43: 5
2018-08-14 19:12:43: 5
2018-08-14 19:12:43: Generating execution metrics for [query_6.sql]..
2018-08-14 19:12:43: 6
2018-08-14 19:12:43: 6
2018-08-14 19:12:43: Generating execution metrics for [query_7.sql]..
2018-08-14 19:12:43: 7
2018-08-14 19:12:43: 7
2018-08-14 19:12:43: Generating execution metrics for [query_8.sql]..
2018-08-14 19:12:43: 8
2018-08-14 19:12:43: 8
2018-08-14 19:12:43: Generating execution metrics for [query_9.sql]..
2018-08-14 19:12:46: 9
2018-08-14 19:12:46: 9
2018-08-14 19:12:46: Generating execution metrics for [query_10.sql]..
2018-08-14 19:12:46: 10
2018-08-14 19:12:46: 10
2018-08-14 19:12:46: Generating execution metrics for [query_11.sql]..
2018-08-14 19:12:49: 11
2018-08-14 19:12:49: 11
2018-08-14 19:12:49: Generating execution metrics for [query_12.sql]..
2018-08-14 19:12:49: 12
2018-08-14 19:12:49: 12
2018-08-14 19:12:49: Generating execution metrics for [query_13.sql]..
2018-08-14 19:12:52: 13
2018-08-14 19:12:52: 13
2018-08-14 19:12:52: Generating execution metrics for [query_14.sql]..
2018-08-14 19:12:56: 14
2018-08-14 19:12:56: 14
2018-08-14 19:12:56: Generating execution metrics for [query_15.sql]..
2018-08-14 19:12:59: 15
2018-08-14 19:12:59: 15
2018-08-14 19:12:59: Generating execution metrics for [query_16.sql]..
2018-08-14 19:13:00: 16
2018-08-14 19:13:00: 16
2018-08-14 19:13:00: Generating execution metrics for [query_17.sql]..
2018-08-14 19:13:00: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 19:13:00: 17
2018-08-14 19:13:00: 17
2018-08-14 19:13:00: Generating execution metrics for [query_18.sql]..
2018-08-14 19:13:00: 18
2018-08-14 19:13:00: 18
2018-08-14 19:13:00: Generating execution metrics for [query_19.sql]..
2018-08-14 19:13:01: 19
2018-08-14 19:13:01: 19
2018-08-14 19:13:01: Generating execution metrics for [query_20.sql]..
2018-08-14 19:13:01: 20
2018-08-14 19:13:01: 20
2018-08-14 19:13:01: Generating execution metrics for [query_21.sql]..
2018-08-14 19:13:01: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 19:13:01: 21
2018-08-14 19:13:01: 21
2018-08-14 19:13:01: Generating execution metrics for [query_22.sql]..
2018-08-14 19:13:01: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 19:13:01: 22
2018-08-14 19:13:01: 22
2018-08-14 19:13:01: Generating execution metrics for [query_23.sql]..
2018-08-14 19:13:06: 23
2018-08-14 19:13:06: 23
2018-08-14 19:13:06: Generating execution metrics for [query_24.sql]..
2018-08-14 19:13:13: 24
2018-08-14 19:13:13: 24
2018-08-14 19:13:13: Generating execution metrics for [query_25.sql]..
2018-08-14 19:13:19: 25
2018-08-14 19:13:19: 25
2018-08-14 19:13:19: Generating execution metrics for [query_26.sql]..
2018-08-14 19:13:19: 26
2018-08-14 19:13:19: 26
2018-08-14 19:13:19: Generating execution metrics for [query_27.sql]..
2018-08-14 19:13:20: 27
2018-08-14 19:13:20: 27
2018-08-14 19:13:20: Generating execution metrics for [query_28.sql]..
2018-08-14 19:13:20: 28
2018-08-14 19:13:20: 28
2018-08-14 19:13:20: Generating execution metrics for [query_29.sql]..
2018-08-14 19:13:20: 29
2018-08-14 19:13:20: 29
2018-08-14 19:13:20: Generating execution metrics for [query_30.sql]..
2018-08-14 19:13:21: 30
2018-08-14 19:13:21: 30
2018-08-14 19:13:21: Generating execution metrics for [query_31.sql]..
2018-08-14 19:13:23: 31
2018-08-14 19:13:23: 31
2018-08-14 19:13:23: Generating execution metrics for [query_32.sql]..
2018-08-14 19:13:23: 32
2018-08-14 19:13:23: 32
2018-08-14 19:13:23: Generating execution metrics for [query_33.sql]..
2018-08-14 19:13:23: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 19:13:23: 33
2018-08-14 19:13:23: 33
2018-08-14 19:13:23: Generating execution metrics for [query_34.sql]..
2018-08-14 19:13:24: 34
2018-08-14 19:13:24: 34
2018-08-14 19:13:24: Generating execution metrics for [query_35.sql]..
2018-08-14 19:13:24: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 19:13:24: 35
2018-08-14 19:13:24: 35
2018-08-14 19:13:24: Generating execution metrics for [query_36.sql]..
2018-08-14 19:13:25: 36
2018-08-14 19:13:25: 36
2018-08-14 19:13:25: Generating execution metrics for [query_37.sql]..
2018-08-14 19:13:25: 37
2018-08-14 19:13:25: 37
2018-08-14 19:13:25: Generating execution metrics for [query_38.sql]..
2018-08-14 19:18:00: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:18:00: Connection pool instantiated with [1] connections
2018-08-14 19:18:03: ('spark.driver.port', '18960')
2018-08-14 19:18:03: ('spark.cores.max', '20')
2018-08-14 19:18:03: ('spark.executor.memory', '2g')
2018-08-14 19:18:03: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 19:18:03: ('spark.app.id', 'app-20180814191802-0027')
2018-08-14 19:18:03: ('spark.executor.id', 'driver')
2018-08-14 19:18:03: ('spark.python.worker.reuse', 'True')
2018-08-14 19:18:03: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:18:03: ('spark.default.parallelism', '80')
2018-08-14 19:18:03: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:18:03: ('spark.executor.instances', '20')
2018-08-14 19:18:03: ('spark.logConf', 'False')
2018-08-14 19:18:03: ('spark.rdd.compress', 'True')
2018-08-14 19:18:03: ('spark.driver.memory', '2g')
2018-08-14 19:18:03: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:18:03: ('spark.executor.cores', '1')
2018-08-14 19:18:03: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:18:03: ('spark.submit.deployMode', 'client')
2018-08-14 19:18:03: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:18:03: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:18:03: ('spark.app.name', 'ICS5200')
2018-08-14 19:18:03: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 19:18:03: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 19:18:03: Successfully finished migrating DML scripts!
2018-08-14 19:18:03: Starting TPC-DS sql splitting
2018-08-14 19:18:03: Generated query_1.sql
2018-08-14 19:18:03: Generated query_2.sql
2018-08-14 19:18:03: Generated query_3.sql
2018-08-14 19:18:03: Generated query_4.sql
2018-08-14 19:18:03: Generated query_5.sql
2018-08-14 19:18:03: Generated query_6.sql
2018-08-14 19:18:03: Generated query_7.sql
2018-08-14 19:18:03: Generated query_8.sql
2018-08-14 19:18:03: Generated query_9.sql
2018-08-14 19:18:03: Generated query_10.sql
2018-08-14 19:18:03: Generated query_11.sql
2018-08-14 19:18:03: Generated query_12.sql
2018-08-14 19:18:03: Generated query_13.sql
2018-08-14 19:18:03: Generated query_14.sql
2018-08-14 19:18:03: Generated query_15.sql
2018-08-14 19:18:03: Generated query_16.sql
2018-08-14 19:18:03: Generated query_17.sql
2018-08-14 19:18:03: Generated query_18.sql
2018-08-14 19:18:03: Generated query_19.sql
2018-08-14 19:18:03: Generated query_20.sql
2018-08-14 19:18:03: Generated query_21.sql
2018-08-14 19:18:03: Generated query_22.sql
2018-08-14 19:18:03: Generated query_23.sql
2018-08-14 19:18:03: Generated query_24.sql
2018-08-14 19:18:03: Generated query_25.sql
2018-08-14 19:18:03: Generated query_26.sql
2018-08-14 19:18:03: Generated query_27.sql
2018-08-14 19:18:03: Generated query_28.sql
2018-08-14 19:18:03: Generated query_29.sql
2018-08-14 19:18:03: Generated query_30.sql
2018-08-14 19:18:03: Generated query_31.sql
2018-08-14 19:18:03: Generated query_32.sql
2018-08-14 19:18:03: Generated query_33.sql
2018-08-14 19:18:03: Generated query_34.sql
2018-08-14 19:18:03: Generated query_35.sql
2018-08-14 19:18:03: Generated query_36.sql
2018-08-14 19:18:03: Generated query_37.sql
2018-08-14 19:18:03: Generated query_38.sql
2018-08-14 19:18:03: Generated query_39.sql
2018-08-14 19:18:03: Generated query_40.sql
2018-08-14 19:18:03: Generated query_41.sql
2018-08-14 19:18:03: Generated query_42.sql
2018-08-14 19:18:03: Generated query_43.sql
2018-08-14 19:18:03: Generated query_44.sql
2018-08-14 19:18:03: Generated query_45.sql
2018-08-14 19:18:03: Generated query_46.sql
2018-08-14 19:18:03: Generated query_47.sql
2018-08-14 19:18:03: Generated query_48.sql
2018-08-14 19:18:03: Generated query_49.sql
2018-08-14 19:18:03: Generated query_50.sql
2018-08-14 19:18:03: Generated query_51.sql
2018-08-14 19:18:03: Generated query_52.sql
2018-08-14 19:18:03: Generated query_53.sql
2018-08-14 19:18:03: Generated query_54.sql
2018-08-14 19:18:03: Generated query_55.sql
2018-08-14 19:18:03: Generated query_56.sql
2018-08-14 19:18:03: Generated query_57.sql
2018-08-14 19:18:03: Generated query_58.sql
2018-08-14 19:18:03: Generated query_59.sql
2018-08-14 19:18:03: Generated query_60.sql
2018-08-14 19:18:03: Generated query_61.sql
2018-08-14 19:18:03: Generated query_62.sql
2018-08-14 19:18:03: Generated query_63.sql
2018-08-14 19:18:03: Generated query_64.sql
2018-08-14 19:18:03: Generated query_65.sql
2018-08-14 19:18:03: Generated query_66.sql
2018-08-14 19:18:03: Generated query_67.sql
2018-08-14 19:18:03: Generated query_68.sql
2018-08-14 19:18:03: Generated query_69.sql
2018-08-14 19:18:03: Generated query_70.sql
2018-08-14 19:18:03: Generated query_71.sql
2018-08-14 19:18:03: Generated query_72.sql
2018-08-14 19:18:03: Generated query_73.sql
2018-08-14 19:18:03: Generated query_74.sql
2018-08-14 19:18:03: Generated query_75.sql
2018-08-14 19:18:03: Generated query_76.sql
2018-08-14 19:18:03: Generated query_77.sql
2018-08-14 19:18:03: Generated query_78.sql
2018-08-14 19:18:03: Generated query_79.sql
2018-08-14 19:18:03: Generated query_80.sql
2018-08-14 19:18:03: Generated query_81.sql
2018-08-14 19:18:03: Generated query_82.sql
2018-08-14 19:18:03: Generated query_83.sql
2018-08-14 19:18:03: Generated query_84.sql
2018-08-14 19:18:03: Generated query_85.sql
2018-08-14 19:18:03: Generated query_86.sql
2018-08-14 19:18:03: Generated query_87.sql
2018-08-14 19:18:03: Generated query_88.sql
2018-08-14 19:18:03: Generated query_89.sql
2018-08-14 19:18:03: Generated query_90.sql
2018-08-14 19:18:03: Generated query_91.sql
2018-08-14 19:18:03: Generated query_92.sql
2018-08-14 19:18:03: Generated query_93.sql
2018-08-14 19:18:03: Generated query_94.sql
2018-08-14 19:18:03: Generated query_95.sql
2018-08-14 19:18:03: Generated query_96.sql
2018-08-14 19:18:03: Generated query_97.sql
2018-08-14 19:18:03: Generated query_98.sql
2018-08-14 19:18:03: Generated query_99.sql
2018-08-14 19:18:03: Generated query_100.sql
2018-08-14 19:18:03: Generated query_101.sql
2018-08-14 19:18:03: Generated query_102.sql
2018-08-14 19:18:03: Generated query_103.sql
2018-08-14 19:18:03: Generated query_104.sql
2018-08-14 19:18:03: Script Complete!
-------------------------------------
2018-08-14 19:18:06: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:18:06: Connection pool instantiated with [1] connections
2018-08-14 19:18:09: ('spark.cores.max', '20')
2018-08-14 19:18:09: ('spark.executor.memory', '2g')
2018-08-14 19:18:09: ('spark.app.id', 'app-20180814191808-0028')
2018-08-14 19:18:09: ('spark.executor.id', 'driver')
2018-08-14 19:18:09: ('spark.python.worker.reuse', 'True')
2018-08-14 19:18:09: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:18:09: ('spark.default.parallelism', '80')
2018-08-14 19:18:09: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:18:09: ('spark.driver.port', '35989')
2018-08-14 19:18:09: ('spark.executor.instances', '20')
2018-08-14 19:18:09: ('spark.logConf', 'False')
2018-08-14 19:18:09: ('spark.rdd.compress', 'True')
2018-08-14 19:18:09: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 19:18:09: ('spark.driver.memory', '2g')
2018-08-14 19:18:09: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:18:09: ('spark.executor.cores', '1')
2018-08-14 19:18:09: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:18:09: ('spark.submit.deployMode', 'client')
2018-08-14 19:18:09: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:18:09: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:18:09: ('spark.app.name', 'ICS5200')
2018-08-14 19:18:09: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 19:18:09: Generating execution metrics for [query_1.sql]..
2018-08-14 19:18:09: Generating execution metrics for [query_2.sql]..
2018-08-14 19:18:13: Generating execution metrics for [query_3.sql]..
2018-08-14 19:18:13: Generating execution metrics for [query_4.sql]..
2018-08-14 19:18:18: Generating execution metrics for [query_5.sql]..
2018-08-14 19:18:21: Generating execution metrics for [query_6.sql]..
2018-08-14 19:18:22: Generating execution metrics for [query_7.sql]..
2018-08-14 19:18:22: Generating execution metrics for [query_8.sql]..
2018-08-14 19:18:22: Generating execution metrics for [query_9.sql]..
2018-08-14 19:18:25: Generating execution metrics for [query_10.sql]..
2018-08-14 19:18:25: Generating execution metrics for [query_11.sql]..
2018-08-14 19:18:27: Generating execution metrics for [query_12.sql]..
2018-08-14 19:18:27: Generating execution metrics for [query_13.sql]..
2018-08-14 19:18:31: Generating execution metrics for [query_14.sql]..
2018-08-14 19:18:34: Generating execution metrics for [query_15.sql]..
2018-08-14 19:18:38: Generating execution metrics for [query_16.sql]..
2018-08-14 19:18:38: Generating execution metrics for [query_17.sql]..
2018-08-14 19:18:38: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select count(distinct cs_order_number) as "order count" ,sum(cs_ext_ship_cost) as "total shipping cost" ,sum(cs_net_profit) as "total net profit" from catalog_sales cs1 ,date_dim ,customer_address ,call_center where d_date between '2002-4-01' and (cast('2002-4-01' as date) + 60 days) and cs1.cs_ship_date_sk = d_date_sk and cs1.cs_ship_addr_sk = ca_address_sk and ca_state = 'PA' and cs1.cs_call_center_sk = cc_call_center_sk and cc_county in ('Williamson County','Williamson County','Williamson County','Williamson County', 'Williamson County' ) and exists (select * from catalog_sales cs2 where cs1.cs_order_number = cs2.cs_order_number and cs1.cs_warehouse_sk <> cs2.cs_warehouse_sk) and not exists(select * from catalog_returns cr1 where cs1.cs_order_number = cr1.cr_order_number) order by count(distinct cs_order_number) ) where rownum <= 100 ]
2018-08-14 19:18:38: Generating execution metrics for [query_18.sql]..
2018-08-14 19:18:38: Generating execution metrics for [query_19.sql]..
2018-08-14 19:18:39: Generating execution metrics for [query_20.sql]..
2018-08-14 19:18:39: Generating execution metrics for [query_21.sql]..
2018-08-14 19:18:39: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(cs_ext_sales_price) as itemrevenue ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over (partition by i_class) as revenueratio from catalog_sales ,item ,date_dim where cs_item_sk = i_item_sk and i_category in ('Books', 'Music', 'Sports') and cs_sold_date_sk = d_date_sk and d_date between cast('2002-06-18' as date) and (cast('2002-06-18' as date) + 30 days) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100 ]
2018-08-14 19:18:39: Generating execution metrics for [query_22.sql]..
2018-08-14 19:18:39: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (cast ('1999-06-22' as date) - 30 days) and (cast ('1999-06-22' as date) + 30 days) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 19:18:39: Generating execution metrics for [query_23.sql]..
2018-08-14 19:18:44: Generating execution metrics for [query_24.sql]..
2018-08-14 19:18:51: Generating execution metrics for [query_25.sql]..
2018-08-14 19:18:57: Generating execution metrics for [query_26.sql]..
2018-08-14 19:18:57: Generating execution metrics for [query_27.sql]..
2018-08-14 19:18:57: Generating execution metrics for [query_28.sql]..
2018-08-14 19:18:58: Generating execution metrics for [query_29.sql]..
2018-08-14 19:18:58: Generating execution metrics for [query_30.sql]..
2018-08-14 19:18:58: Generating execution metrics for [query_31.sql]..
2018-08-14 19:19:00: Generating execution metrics for [query_32.sql]..
2018-08-14 19:19:00: Generating execution metrics for [query_33.sql]..
2018-08-14 19:19:00: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 19:19:00: Generating execution metrics for [query_34.sql]..
2018-08-14 19:19:02: Generating execution metrics for [query_35.sql]..
2018-08-14 19:19:02: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select sum(cs_ext_discount_amt) as "excess discount amount" from catalog_sales ,item ,date_dim where i_manufact_id = 722 and i_item_sk = cs_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk and cs_ext_discount_amt > ( select 1.3 * avg(cs_ext_discount_amt) from catalog_sales ,date_dim where cs_item_sk = i_item_sk and d_date between '2001-03-09' and (cast('2001-03-09' as date) + 90 days) and d_date_sk = cs_sold_date_sk ) ) where rownum <= 100 ]
2018-08-14 19:19:02: Generating execution metrics for [query_36.sql]..
2018-08-14 19:19:02: Generating execution metrics for [query_37.sql]..
2018-08-14 19:19:02: Generating execution metrics for [query_38.sql]..
2018-08-14 19:19:47: Generating execution metrics for [query_39.sql]..
2018-08-14 19:19:48: Generating execution metrics for [query_40.sql]..
2018-08-14 19:19:48: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 19:19:48: Generating execution metrics for [query_41.sql]..
2018-08-14 19:19:49: Generating execution metrics for [query_42.sql]..
2018-08-14 19:19:52: Generating execution metrics for [query_43.sql]..
2018-08-14 19:19:55: Generating execution metrics for [query_44.sql]..
2018-08-14 19:19:55: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 19:19:55: Generating execution metrics for [query_45.sql]..
2018-08-14 19:19:55: Generating execution metrics for [query_46.sql]..
2018-08-14 19:19:56: Generating execution metrics for [query_47.sql]..
2018-08-14 19:19:56: Generating execution metrics for [query_48.sql]..
2018-08-14 19:19:57: Generating execution metrics for [query_49.sql]..
2018-08-14 19:19:57: Generating execution metrics for [query_50.sql]..
2018-08-14 19:19:59: Generating execution metrics for [query_51.sql]..
2018-08-14 19:20:01: Generating execution metrics for [query_52.sql]..
2018-08-14 19:35:06: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:35:06: Connection pool instantiated with [1] connections
2018-08-14 19:35:08: ('spark.cores.max', '20')
2018-08-14 19:35:08: ('spark.executor.memory', '2g')
2018-08-14 19:35:08: ('spark.app.id', 'app-20180814193508-0029')
2018-08-14 19:35:08: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 19:35:08: ('spark.executor.id', 'driver')
2018-08-14 19:35:08: ('spark.python.worker.reuse', 'True')
2018-08-14 19:35:08: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:35:08: ('spark.default.parallelism', '80')
2018-08-14 19:35:08: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:35:08: ('spark.executor.instances', '20')
2018-08-14 19:35:08: ('spark.logConf', 'False')
2018-08-14 19:35:08: ('spark.driver.port', '17648')
2018-08-14 19:35:08: ('spark.rdd.compress', 'True')
2018-08-14 19:35:08: ('spark.driver.memory', '2g')
2018-08-14 19:35:08: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:35:08: ('spark.executor.cores', '1')
2018-08-14 19:35:08: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:35:08: ('spark.submit.deployMode', 'client')
2018-08-14 19:35:08: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:35:08: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:35:08: ('spark.app.name', 'ICS5200')
2018-08-14 19:35:09: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 19:35:09: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 19:35:09: Successfully finished migrating DML scripts!
2018-08-14 19:35:09: Starting TPC-DS sql splitting
2018-08-14 19:35:09: Generated query_1.sql
2018-08-14 19:35:09: Generated query_2.sql
2018-08-14 19:35:09: Generated query_3.sql
2018-08-14 19:35:09: Generated query_4.sql
2018-08-14 19:35:09: Generated query_5.sql
2018-08-14 19:35:09: Generated query_6.sql
2018-08-14 19:35:09: Generated query_7.sql
2018-08-14 19:35:09: Generated query_8.sql
2018-08-14 19:35:09: Generated query_9.sql
2018-08-14 19:35:09: Generated query_10.sql
2018-08-14 19:35:09: Generated query_11.sql
2018-08-14 19:35:09: Generated query_12.sql
2018-08-14 19:35:09: Generated query_13.sql
2018-08-14 19:35:09: Generated query_14.sql
2018-08-14 19:35:09: Generated query_15.sql
2018-08-14 19:35:09: Generated query_16.sql
2018-08-14 19:35:09: Generated query_17.sql
2018-08-14 19:35:09: Generated query_18.sql
2018-08-14 19:35:09: Generated query_19.sql
2018-08-14 19:35:09: Generated query_20.sql
2018-08-14 19:35:09: Generated query_21.sql
2018-08-14 19:35:09: Generated query_22.sql
2018-08-14 19:35:09: Generated query_23.sql
2018-08-14 19:35:09: Generated query_24.sql
2018-08-14 19:35:09: Generated query_25.sql
2018-08-14 19:35:09: Generated query_26.sql
2018-08-14 19:35:09: Generated query_27.sql
2018-08-14 19:35:09: Generated query_28.sql
2018-08-14 19:35:09: Generated query_29.sql
2018-08-14 19:35:09: Generated query_30.sql
2018-08-14 19:35:09: Generated query_31.sql
2018-08-14 19:35:09: Generated query_32.sql
2018-08-14 19:35:09: Generated query_33.sql
2018-08-14 19:35:09: Generated query_34.sql
2018-08-14 19:35:09: Generated query_35.sql
2018-08-14 19:35:09: Generated query_36.sql
2018-08-14 19:35:09: Generated query_37.sql
2018-08-14 19:35:09: Generated query_38.sql
2018-08-14 19:35:09: Generated query_39.sql
2018-08-14 19:35:09: Generated query_40.sql
2018-08-14 19:35:09: Generated query_41.sql
2018-08-14 19:35:09: Generated query_42.sql
2018-08-14 19:35:09: Generated query_43.sql
2018-08-14 19:35:09: Generated query_44.sql
2018-08-14 19:35:09: Generated query_45.sql
2018-08-14 19:35:09: Generated query_46.sql
2018-08-14 19:35:09: Generated query_47.sql
2018-08-14 19:35:09: Generated query_48.sql
2018-08-14 19:35:09: Generated query_49.sql
2018-08-14 19:35:09: Generated query_50.sql
2018-08-14 19:35:09: Generated query_51.sql
2018-08-14 19:35:09: Generated query_52.sql
2018-08-14 19:35:09: Generated query_53.sql
2018-08-14 19:35:09: Generated query_54.sql
2018-08-14 19:35:09: Generated query_55.sql
2018-08-14 19:35:09: Generated query_56.sql
2018-08-14 19:35:09: Generated query_57.sql
2018-08-14 19:35:09: Generated query_58.sql
2018-08-14 19:35:09: Generated query_59.sql
2018-08-14 19:35:09: Generated query_60.sql
2018-08-14 19:35:09: Generated query_61.sql
2018-08-14 19:35:09: Generated query_62.sql
2018-08-14 19:35:09: Generated query_63.sql
2018-08-14 19:35:09: Generated query_64.sql
2018-08-14 19:35:09: Generated query_65.sql
2018-08-14 19:35:09: Generated query_66.sql
2018-08-14 19:35:09: Generated query_67.sql
2018-08-14 19:35:09: Generated query_68.sql
2018-08-14 19:35:09: Generated query_69.sql
2018-08-14 19:35:09: Generated query_70.sql
2018-08-14 19:35:09: Generated query_71.sql
2018-08-14 19:35:09: Generated query_72.sql
2018-08-14 19:35:09: Generated query_73.sql
2018-08-14 19:35:09: Generated query_74.sql
2018-08-14 19:35:09: Generated query_75.sql
2018-08-14 19:35:09: Generated query_76.sql
2018-08-14 19:35:09: Generated query_77.sql
2018-08-14 19:35:09: Generated query_78.sql
2018-08-14 19:35:09: Generated query_79.sql
2018-08-14 19:35:09: Generated query_80.sql
2018-08-14 19:35:09: Generated query_81.sql
2018-08-14 19:35:09: Generated query_82.sql
2018-08-14 19:35:09: Generated query_83.sql
2018-08-14 19:35:09: Generated query_84.sql
2018-08-14 19:35:09: Generated query_85.sql
2018-08-14 19:35:09: Generated query_86.sql
2018-08-14 19:35:09: Generated query_87.sql
2018-08-14 19:35:09: Generated query_88.sql
2018-08-14 19:35:09: Generated query_89.sql
2018-08-14 19:35:09: Generated query_90.sql
2018-08-14 19:35:09: Generated query_91.sql
2018-08-14 19:35:09: Generated query_92.sql
2018-08-14 19:35:09: Generated query_93.sql
2018-08-14 19:35:09: Generated query_94.sql
2018-08-14 19:35:09: Generated query_95.sql
2018-08-14 19:35:09: Generated query_96.sql
2018-08-14 19:35:09: Generated query_97.sql
2018-08-14 19:35:09: Generated query_98.sql
2018-08-14 19:35:09: Generated query_99.sql
2018-08-14 19:35:09: Generated query_100.sql
2018-08-14 19:35:09: Generated query_101.sql
2018-08-14 19:35:09: Generated query_102.sql
2018-08-14 19:35:09: Generated query_103.sql
2018-08-14 19:35:09: Generated query_104.sql
2018-08-14 19:35:09: Script Complete!
-------------------------------------
2018-08-14 19:35:12: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:35:12: Connection pool instantiated with [1] connections
2018-08-14 19:35:15: ('spark.cores.max', '20')
2018-08-14 19:35:15: ('spark.executor.memory', '2g')
2018-08-14 19:35:15: ('spark.executor.id', 'driver')
2018-08-14 19:35:15: ('spark.python.worker.reuse', 'True')
2018-08-14 19:35:15: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:35:15: ('spark.default.parallelism', '80')
2018-08-14 19:35:15: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:35:15: ('spark.executor.instances', '20')
2018-08-14 19:35:15: ('spark.logConf', 'False')
2018-08-14 19:35:15: ('spark.rdd.compress', 'True')
2018-08-14 19:35:15: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 19:35:15: ('spark.driver.memory', '2g')
2018-08-14 19:35:15: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:35:15: ('spark.app.id', 'app-20180814193515-0030')
2018-08-14 19:35:15: ('spark.executor.cores', '1')
2018-08-14 19:35:15: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:35:15: ('spark.submit.deployMode', 'client')
2018-08-14 19:35:15: ('spark.driver.port', '18590')
2018-08-14 19:35:15: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:35:15: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:35:15: ('spark.app.name', 'ICS5200')
2018-08-14 19:35:15: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 19:35:15: Generating execution metrics for [query_1.sql]..
2018-08-14 19:35:16: Generating execution metrics for [query_2.sql]..
2018-08-14 19:35:20: Generating execution metrics for [query_3.sql]..
2018-08-14 19:35:20: Generating execution metrics for [query_4.sql]..
2018-08-14 19:35:24: Generating execution metrics for [query_5.sql]..
2018-08-14 19:35:28: Generating execution metrics for [query_6.sql]..
2018-08-14 19:35:28: Generating execution metrics for [query_7.sql]..
2018-08-14 19:35:28: Generating execution metrics for [query_8.sql]..
2018-08-14 19:35:28: Generating execution metrics for [query_9.sql]..
2018-08-14 19:35:31: Generating execution metrics for [query_10.sql]..
2018-08-14 19:35:31: Generating execution metrics for [query_11.sql]..
2018-08-14 19:35:33: Generating execution metrics for [query_12.sql]..
2018-08-14 19:35:34: Generating execution metrics for [query_13.sql]..
2018-08-14 19:35:37: Generating execution metrics for [query_14.sql]..
2018-08-14 19:35:40: Generating execution metrics for [query_15.sql]..
2018-08-14 19:35:44: Generating execution metrics for [query_16.sql]..
2018-08-14 19:35:44: Generating execution metrics for [query_17.sql]..
2018-08-14 19:35:44: Generating execution metrics for [query_18.sql]..
2018-08-14 19:35:45: Generating execution metrics for [query_19.sql]..
2018-08-14 19:35:45: Generating execution metrics for [query_20.sql]..
2018-08-14 19:35:45: Generating execution metrics for [query_21.sql]..
2018-08-14 19:35:45: Generating execution metrics for [query_22.sql]..
2018-08-14 19:35:46: Skipped DML instruction due to following exception: [ORA-01861: literal does not match format string] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (cast(d_date as date) < cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (cast(d_date as date) >= cast ('1999-06-22' as date)) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22','yyyy/mm/dd') - 30,'yyyy-mm-dd')) and (to_char(to_date('1999-06-22','yyyy/mm/dd') + 30,'yyyy-mm-dd')) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 19:35:46: Generating execution metrics for [query_23.sql]..
2018-08-14 19:35:51: Generating execution metrics for [query_24.sql]..
2018-08-14 19:35:57: Generating execution metrics for [query_25.sql]..
2018-08-14 19:36:03: Generating execution metrics for [query_26.sql]..
2018-08-14 19:36:03: Generating execution metrics for [query_27.sql]..
2018-08-14 19:36:03: Generating execution metrics for [query_28.sql]..
2018-08-14 19:36:04: Generating execution metrics for [query_29.sql]..
2018-08-14 19:36:04: Generating execution metrics for [query_30.sql]..
2018-08-14 19:36:05: Generating execution metrics for [query_31.sql]..
2018-08-14 19:36:06: Generating execution metrics for [query_32.sql]..
2018-08-14 19:36:06: Generating execution metrics for [query_33.sql]..
2018-08-14 19:36:06: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 19:36:07: Generating execution metrics for [query_34.sql]..
2018-08-14 19:36:08: Generating execution metrics for [query_35.sql]..
2018-08-14 19:36:08: Generating execution metrics for [query_36.sql]..
2018-08-14 19:36:08: Generating execution metrics for [query_37.sql]..
2018-08-14 19:36:09: Generating execution metrics for [query_38.sql]..
2018-08-14 19:41:32: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:41:32: Connection pool instantiated with [1] connections
2018-08-14 19:41:35: ('spark.cores.max', '20')
2018-08-14 19:41:35: ('spark.executor.memory', '2g')
2018-08-14 19:41:35: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 19:41:35: ('spark.driver.port', '16619')
2018-08-14 19:41:35: ('spark.executor.id', 'driver')
2018-08-14 19:41:35: ('spark.python.worker.reuse', 'True')
2018-08-14 19:41:35: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:41:35: ('spark.default.parallelism', '80')
2018-08-14 19:41:35: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:41:35: ('spark.executor.instances', '20')
2018-08-14 19:41:35: ('spark.logConf', 'False')
2018-08-14 19:41:35: ('spark.rdd.compress', 'True')
2018-08-14 19:41:35: ('spark.driver.memory', '2g')
2018-08-14 19:41:35: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:41:35: ('spark.executor.cores', '1')
2018-08-14 19:41:35: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:41:35: ('spark.submit.deployMode', 'client')
2018-08-14 19:41:35: ('spark.app.id', 'app-20180814194134-0031')
2018-08-14 19:41:35: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:41:35: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:41:35: ('spark.app.name', 'ICS5200')
2018-08-14 19:41:35: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 19:41:35: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 19:41:35: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 19:41:36: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 19:41:36: Successfully finished migrating DML scripts!
2018-08-14 19:41:36: Starting TPC-DS sql splitting
2018-08-14 19:41:36: Generated query_1.sql
2018-08-14 19:41:36: Generated query_2.sql
2018-08-14 19:41:36: Generated query_3.sql
2018-08-14 19:41:36: Generated query_4.sql
2018-08-14 19:41:36: Generated query_5.sql
2018-08-14 19:41:36: Generated query_6.sql
2018-08-14 19:41:36: Generated query_7.sql
2018-08-14 19:41:36: Generated query_8.sql
2018-08-14 19:41:36: Generated query_9.sql
2018-08-14 19:41:36: Generated query_10.sql
2018-08-14 19:41:36: Generated query_11.sql
2018-08-14 19:41:36: Generated query_12.sql
2018-08-14 19:41:36: Generated query_13.sql
2018-08-14 19:41:36: Generated query_14.sql
2018-08-14 19:41:36: Generated query_15.sql
2018-08-14 19:41:36: Generated query_16.sql
2018-08-14 19:41:36: Generated query_17.sql
2018-08-14 19:41:36: Generated query_18.sql
2018-08-14 19:41:36: Generated query_19.sql
2018-08-14 19:41:36: Generated query_20.sql
2018-08-14 19:41:36: Generated query_21.sql
2018-08-14 19:41:36: Generated query_22.sql
2018-08-14 19:41:36: Generated query_23.sql
2018-08-14 19:41:36: Generated query_24.sql
2018-08-14 19:41:36: Generated query_25.sql
2018-08-14 19:41:36: Generated query_26.sql
2018-08-14 19:41:36: Generated query_27.sql
2018-08-14 19:41:36: Generated query_28.sql
2018-08-14 19:41:36: Generated query_29.sql
2018-08-14 19:41:36: Generated query_30.sql
2018-08-14 19:41:36: Generated query_31.sql
2018-08-14 19:41:36: Generated query_32.sql
2018-08-14 19:41:36: Generated query_33.sql
2018-08-14 19:41:36: Generated query_34.sql
2018-08-14 19:41:36: Generated query_35.sql
2018-08-14 19:41:36: Generated query_36.sql
2018-08-14 19:41:36: Generated query_37.sql
2018-08-14 19:41:36: Generated query_38.sql
2018-08-14 19:41:36: Generated query_39.sql
2018-08-14 19:41:36: Generated query_40.sql
2018-08-14 19:41:36: Generated query_41.sql
2018-08-14 19:41:36: Generated query_42.sql
2018-08-14 19:41:36: Generated query_43.sql
2018-08-14 19:41:36: Generated query_44.sql
2018-08-14 19:41:36: Generated query_45.sql
2018-08-14 19:41:36: Generated query_46.sql
2018-08-14 19:41:36: Generated query_47.sql
2018-08-14 19:41:36: Generated query_48.sql
2018-08-14 19:41:36: Generated query_49.sql
2018-08-14 19:41:36: Generated query_50.sql
2018-08-14 19:41:36: Generated query_51.sql
2018-08-14 19:41:36: Generated query_52.sql
2018-08-14 19:41:36: Generated query_53.sql
2018-08-14 19:41:36: Generated query_54.sql
2018-08-14 19:41:36: Generated query_55.sql
2018-08-14 19:41:36: Generated query_56.sql
2018-08-14 19:41:36: Generated query_57.sql
2018-08-14 19:41:36: Generated query_58.sql
2018-08-14 19:41:36: Generated query_59.sql
2018-08-14 19:41:36: Generated query_60.sql
2018-08-14 19:41:36: Generated query_61.sql
2018-08-14 19:41:36: Generated query_62.sql
2018-08-14 19:41:36: Generated query_63.sql
2018-08-14 19:41:36: Generated query_64.sql
2018-08-14 19:41:36: Generated query_65.sql
2018-08-14 19:41:36: Generated query_66.sql
2018-08-14 19:41:36: Generated query_67.sql
2018-08-14 19:41:36: Generated query_68.sql
2018-08-14 19:41:36: Generated query_69.sql
2018-08-14 19:41:36: Generated query_70.sql
2018-08-14 19:41:36: Generated query_71.sql
2018-08-14 19:41:36: Generated query_72.sql
2018-08-14 19:41:36: Generated query_73.sql
2018-08-14 19:41:36: Generated query_74.sql
2018-08-14 19:41:36: Generated query_75.sql
2018-08-14 19:41:36: Generated query_76.sql
2018-08-14 19:41:36: Generated query_77.sql
2018-08-14 19:41:36: Generated query_78.sql
2018-08-14 19:41:36: Generated query_79.sql
2018-08-14 19:41:36: Generated query_80.sql
2018-08-14 19:41:36: Generated query_81.sql
2018-08-14 19:41:36: Generated query_82.sql
2018-08-14 19:41:36: Generated query_83.sql
2018-08-14 19:41:36: Generated query_84.sql
2018-08-14 19:41:36: Generated query_85.sql
2018-08-14 19:41:36: Generated query_86.sql
2018-08-14 19:41:36: Generated query_87.sql
2018-08-14 19:41:36: Generated query_88.sql
2018-08-14 19:41:36: Generated query_89.sql
2018-08-14 19:41:36: Generated query_90.sql
2018-08-14 19:41:36: Generated query_91.sql
2018-08-14 19:41:36: Generated query_92.sql
2018-08-14 19:41:36: Generated query_93.sql
2018-08-14 19:41:36: Generated query_94.sql
2018-08-14 19:41:36: Generated query_95.sql
2018-08-14 19:41:36: Generated query_96.sql
2018-08-14 19:41:36: Generated query_97.sql
2018-08-14 19:41:36: Generated query_98.sql
2018-08-14 19:41:36: Generated query_99.sql
2018-08-14 19:41:36: Generated query_100.sql
2018-08-14 19:41:36: Generated query_101.sql
2018-08-14 19:41:36: Generated query_102.sql
2018-08-14 19:41:36: Generated query_103.sql
2018-08-14 19:41:36: Generated query_104.sql
2018-08-14 19:41:36: Script Complete!
-------------------------------------
2018-08-14 19:41:38: Connected to database [gabsam] with user [tpcds1]
2018-08-14 19:41:38: Connection pool instantiated with [1] connections
2018-08-14 19:41:41: ('spark.cores.max', '20')
2018-08-14 19:41:41: ('spark.executor.memory', '2g')
2018-08-14 19:41:41: ('spark.app.id', 'app-20180814194140-0032')
2018-08-14 19:41:41: ('spark.executor.id', 'driver')
2018-08-14 19:41:41: ('spark.python.worker.reuse', 'True')
2018-08-14 19:41:41: ('spark.driver.port', '15077')
2018-08-14 19:41:41: ('spark.driver.maxResultSize', '1g')
2018-08-14 19:41:41: ('spark.default.parallelism', '80')
2018-08-14 19:41:41: ('spark.sql.shuffle.partitions', '80')
2018-08-14 19:41:41: ('spark.executor.instances', '20')
2018-08-14 19:41:41: ('spark.logConf', 'False')
2018-08-14 19:41:41: ('spark.rdd.compress', 'True')
2018-08-14 19:41:41: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 19:41:41: ('spark.driver.memory', '2g')
2018-08-14 19:41:41: ('spark.serializer.objectStreamReset', '100')
2018-08-14 19:41:41: ('spark.executor.cores', '1')
2018-08-14 19:41:41: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 19:41:41: ('spark.submit.deployMode', 'client')
2018-08-14 19:41:41: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 19:41:41: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 19:41:41: ('spark.app.name', 'ICS5200')
2018-08-14 19:41:41: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 19:41:41: Generating execution metrics for [query_1.sql]..
2018-08-14 19:41:42: Generating execution metrics for [query_2.sql]..
2018-08-14 19:41:45: Generating execution metrics for [query_3.sql]..
2018-08-14 19:41:45: Generating execution metrics for [query_4.sql]..
2018-08-14 19:41:50: Generating execution metrics for [query_5.sql]..
2018-08-14 19:41:53: Generating execution metrics for [query_6.sql]..
2018-08-14 19:41:54: Generating execution metrics for [query_7.sql]..
2018-08-14 19:41:54: Generating execution metrics for [query_8.sql]..
2018-08-14 19:41:54: Generating execution metrics for [query_9.sql]..
2018-08-14 19:41:57: Generating execution metrics for [query_10.sql]..
2018-08-14 19:41:57: Generating execution metrics for [query_11.sql]..
2018-08-14 19:41:59: Generating execution metrics for [query_12.sql]..
2018-08-14 19:41:59: Generating execution metrics for [query_13.sql]..
2018-08-14 19:42:03: Generating execution metrics for [query_14.sql]..
2018-08-14 19:42:06: Generating execution metrics for [query_15.sql]..
2018-08-14 19:42:09: Generating execution metrics for [query_16.sql]..
2018-08-14 19:42:10: Generating execution metrics for [query_17.sql]..
2018-08-14 19:42:10: Generating execution metrics for [query_18.sql]..
2018-08-14 19:42:10: Generating execution metrics for [query_19.sql]..
2018-08-14 19:42:11: Generating execution metrics for [query_20.sql]..
2018-08-14 19:42:11: Generating execution metrics for [query_21.sql]..
2018-08-14 19:42:11: Generating execution metrics for [query_22.sql]..
2018-08-14 19:42:11: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select * from(select w_warehouse_name ,i_item_id ,sum(case when (to_char(to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') < to_char(to_date('1999-06-22','yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_before ,sum(case when (to_char(_to_date(d_date,'yyyy/mm/dd'),'yyyy-mm-dd') >= to_char(to_date('1999-06-22','yyyy/mm/dd'),'yyyy-mm-dd')) then inv_quantity_on_hand else 0 end) as inv_after from inventory ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = inv_item_sk and inv_warehouse_sk = w_warehouse_sk and inv_date_sk = d_date_sk and d_date between (to_char(to_date('1999-06-22','yyyy/mm/dd') - 30,'yyyy-mm-dd')) and (to_char(to_date('1999-06-22','yyyy/mm/dd') + 30,'yyyy-mm-dd')) group by w_warehouse_name, i_item_id) x where (case when inv_before > 0 then inv_after / inv_before else null end) between 2.0/3.0 and 3.0/2.0 order by w_warehouse_name ,i_item_id ) where rownum <= 100 ]
2018-08-14 19:42:11: Generating execution metrics for [query_23.sql]..
2018-08-14 19:42:16: Generating execution metrics for [query_24.sql]..
2018-08-14 19:42:22: Generating execution metrics for [query_25.sql]..
2018-08-14 19:42:28: Generating execution metrics for [query_26.sql]..
2018-08-14 19:42:28: Generating execution metrics for [query_27.sql]..
2018-08-14 19:42:28: Generating execution metrics for [query_28.sql]..
2018-08-14 19:42:29: Generating execution metrics for [query_29.sql]..
2018-08-14 19:42:29: Generating execution metrics for [query_30.sql]..
2018-08-14 19:42:29: Generating execution metrics for [query_31.sql]..
2018-08-14 19:42:31: Generating execution metrics for [query_32.sql]..
2018-08-14 19:42:31: Generating execution metrics for [query_33.sql]..
2018-08-14 19:42:31: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 19:42:31: Generating execution metrics for [query_34.sql]..
2018-08-14 19:42:32: Generating execution metrics for [query_35.sql]..
2018-08-14 19:42:33: Generating execution metrics for [query_36.sql]..
2018-08-14 19:42:33: Generating execution metrics for [query_37.sql]..
2018-08-14 19:42:33: Generating execution metrics for [query_38.sql]..
2018-08-14 19:43:16: Generating execution metrics for [query_39.sql]..
2018-08-14 19:43:16: Generating execution metrics for [query_40.sql]..
2018-08-14 19:43:16: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 19:43:17: Generating execution metrics for [query_41.sql]..
2018-08-14 19:43:17: Generating execution metrics for [query_42.sql]..
2018-08-14 22:02:15: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:02:15: Connection pool instantiated with [1] connections
2018-08-14 22:02:17: ('spark.cores.max', '20')
2018-08-14 22:02:17: ('spark.executor.memory', '2g')
2018-08-14 22:02:17: ('spark.executor.id', 'driver')
2018-08-14 22:02:17: ('spark.python.worker.reuse', 'True')
2018-08-14 22:02:17: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:02:17: ('spark.default.parallelism', '80')
2018-08-14 22:02:17: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:02:17: ('spark.driver.port', '23946')
2018-08-14 22:02:17: ('spark.executor.instances', '20')
2018-08-14 22:02:17: ('spark.logConf', 'False')
2018-08-14 22:02:17: ('spark.rdd.compress', 'True')
2018-08-14 22:02:17: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 22:02:17: ('spark.driver.memory', '2g')
2018-08-14 22:02:17: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:02:17: ('spark.executor.cores', '1')
2018-08-14 22:02:17: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:02:17: ('spark.submit.deployMode', 'client')
2018-08-14 22:02:17: ('spark.app.id', 'app-20180814220217-0033')
2018-08-14 22:02:17: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:02:17: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:02:17: ('spark.app.name', 'ICS5200')
2018-08-14 22:02:18: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 22:02:18: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 22:02:18: Successfully finished migrating DML scripts!
2018-08-14 22:02:18: Starting TPC-DS sql splitting
2018-08-14 22:02:18: Generated query_1.sql
2018-08-14 22:02:18: Generated query_2.sql
2018-08-14 22:02:18: Generated query_3.sql
2018-08-14 22:02:18: Generated query_4.sql
2018-08-14 22:02:18: Generated query_5.sql
2018-08-14 22:02:18: Generated query_6.sql
2018-08-14 22:02:18: Generated query_7.sql
2018-08-14 22:02:18: Generated query_8.sql
2018-08-14 22:02:18: Generated query_9.sql
2018-08-14 22:02:18: Generated query_10.sql
2018-08-14 22:02:18: Generated query_11.sql
2018-08-14 22:02:18: Generated query_12.sql
2018-08-14 22:02:18: Generated query_13.sql
2018-08-14 22:02:18: Generated query_14.sql
2018-08-14 22:02:18: Generated query_15.sql
2018-08-14 22:02:18: Generated query_16.sql
2018-08-14 22:02:18: Generated query_17.sql
2018-08-14 22:02:18: Generated query_18.sql
2018-08-14 22:02:18: Generated query_19.sql
2018-08-14 22:02:18: Generated query_20.sql
2018-08-14 22:02:18: Generated query_21.sql
2018-08-14 22:02:18: Generated query_22.sql
2018-08-14 22:02:18: Generated query_23.sql
2018-08-14 22:02:18: Generated query_24.sql
2018-08-14 22:02:18: Generated query_25.sql
2018-08-14 22:02:18: Generated query_26.sql
2018-08-14 22:02:18: Generated query_27.sql
2018-08-14 22:02:18: Generated query_28.sql
2018-08-14 22:02:18: Generated query_29.sql
2018-08-14 22:02:18: Generated query_30.sql
2018-08-14 22:02:18: Generated query_31.sql
2018-08-14 22:02:18: Generated query_32.sql
2018-08-14 22:02:18: Generated query_33.sql
2018-08-14 22:02:18: Generated query_34.sql
2018-08-14 22:02:18: Generated query_35.sql
2018-08-14 22:02:18: Generated query_36.sql
2018-08-14 22:02:18: Generated query_37.sql
2018-08-14 22:02:18: Generated query_38.sql
2018-08-14 22:02:18: Generated query_39.sql
2018-08-14 22:02:18: Generated query_40.sql
2018-08-14 22:02:18: Generated query_41.sql
2018-08-14 22:02:18: Generated query_42.sql
2018-08-14 22:02:18: Generated query_43.sql
2018-08-14 22:02:18: Generated query_44.sql
2018-08-14 22:02:18: Generated query_45.sql
2018-08-14 22:02:18: Generated query_46.sql
2018-08-14 22:02:18: Generated query_47.sql
2018-08-14 22:02:18: Generated query_48.sql
2018-08-14 22:02:18: Generated query_49.sql
2018-08-14 22:02:18: Generated query_50.sql
2018-08-14 22:02:18: Generated query_51.sql
2018-08-14 22:02:18: Generated query_52.sql
2018-08-14 22:02:18: Generated query_53.sql
2018-08-14 22:02:18: Generated query_54.sql
2018-08-14 22:02:18: Generated query_55.sql
2018-08-14 22:02:18: Generated query_56.sql
2018-08-14 22:02:18: Generated query_57.sql
2018-08-14 22:02:18: Generated query_58.sql
2018-08-14 22:02:18: Generated query_59.sql
2018-08-14 22:02:18: Generated query_60.sql
2018-08-14 22:02:18: Generated query_61.sql
2018-08-14 22:02:18: Generated query_62.sql
2018-08-14 22:02:18: Generated query_63.sql
2018-08-14 22:02:18: Generated query_64.sql
2018-08-14 22:02:18: Generated query_65.sql
2018-08-14 22:02:18: Generated query_66.sql
2018-08-14 22:02:18: Generated query_67.sql
2018-08-14 22:02:18: Generated query_68.sql
2018-08-14 22:02:18: Generated query_69.sql
2018-08-14 22:02:18: Generated query_70.sql
2018-08-14 22:02:18: Generated query_71.sql
2018-08-14 22:02:18: Generated query_72.sql
2018-08-14 22:02:18: Generated query_73.sql
2018-08-14 22:02:18: Generated query_74.sql
2018-08-14 22:02:18: Generated query_75.sql
2018-08-14 22:02:18: Generated query_76.sql
2018-08-14 22:02:18: Generated query_77.sql
2018-08-14 22:02:18: Generated query_78.sql
2018-08-14 22:02:18: Generated query_79.sql
2018-08-14 22:02:18: Generated query_80.sql
2018-08-14 22:02:18: Generated query_81.sql
2018-08-14 22:02:18: Generated query_82.sql
2018-08-14 22:02:18: Generated query_83.sql
2018-08-14 22:02:18: Generated query_84.sql
2018-08-14 22:02:18: Generated query_85.sql
2018-08-14 22:02:18: Generated query_86.sql
2018-08-14 22:02:18: Generated query_87.sql
2018-08-14 22:02:18: Generated query_88.sql
2018-08-14 22:02:18: Generated query_89.sql
2018-08-14 22:02:18: Generated query_90.sql
2018-08-14 22:02:18: Generated query_91.sql
2018-08-14 22:02:18: Generated query_92.sql
2018-08-14 22:02:18: Generated query_93.sql
2018-08-14 22:02:18: Generated query_94.sql
2018-08-14 22:02:18: Generated query_95.sql
2018-08-14 22:02:18: Generated query_96.sql
2018-08-14 22:02:18: Generated query_97.sql
2018-08-14 22:02:18: Generated query_98.sql
2018-08-14 22:02:18: Generated query_99.sql
2018-08-14 22:02:18: Generated query_100.sql
2018-08-14 22:02:18: Generated query_101.sql
2018-08-14 22:02:18: Generated query_102.sql
2018-08-14 22:02:18: Generated query_103.sql
2018-08-14 22:02:18: Generated query_104.sql
2018-08-14 22:02:18: Script Complete!
-------------------------------------
2018-08-14 22:02:29: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:02:29: Connection pool instantiated with [1] connections
2018-08-14 22:02:31: ('spark.cores.max', '20')
2018-08-14 22:02:31: ('spark.executor.memory', '2g')
2018-08-14 22:02:31: ('spark.app.id', 'app-20180814220231-0034')
2018-08-14 22:02:31: ('spark.executor.id', 'driver')
2018-08-14 22:02:31: ('spark.python.worker.reuse', 'True')
2018-08-14 22:02:31: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:02:31: ('spark.default.parallelism', '80')
2018-08-14 22:02:31: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:02:31: ('spark.executor.instances', '20')
2018-08-14 22:02:31: ('spark.driver.port', '16260')
2018-08-14 22:02:31: ('spark.logConf', 'False')
2018-08-14 22:02:31: ('spark.rdd.compress', 'True')
2018-08-14 22:02:31: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 22:02:31: ('spark.driver.memory', '2g')
2018-08-14 22:02:31: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:02:31: ('spark.executor.cores', '1')
2018-08-14 22:02:31: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:02:31: ('spark.submit.deployMode', 'client')
2018-08-14 22:02:31: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:02:31: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:02:31: ('spark.app.name', 'ICS5200')
2018-08-14 22:02:31: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 22:02:31: Generating execution metrics for [query_1.sql]..
2018-08-14 22:02:32: Generating execution metrics for [query_2.sql]..
2018-08-14 22:02:37: Generating execution metrics for [query_3.sql]..
2018-08-14 22:02:37: Generating execution metrics for [query_4.sql]..
2018-08-14 22:02:41: Generating execution metrics for [query_5.sql]..
2018-08-14 22:02:45: Generating execution metrics for [query_6.sql]..
2018-08-14 22:02:45: Generating execution metrics for [query_7.sql]..
2018-08-14 22:02:45: Generating execution metrics for [query_8.sql]..
2018-08-14 22:02:46: Generating execution metrics for [query_9.sql]..
2018-08-14 22:02:48: Generating execution metrics for [query_10.sql]..
2018-08-14 22:02:48: Generating execution metrics for [query_11.sql]..
2018-08-14 22:02:50: Generating execution metrics for [query_12.sql]..
2018-08-14 22:02:50: Generating execution metrics for [query_13.sql]..
2018-08-14 22:02:54: Generating execution metrics for [query_14.sql]..
2018-08-14 22:02:57: Generating execution metrics for [query_15.sql]..
2018-08-14 22:03:00: Generating execution metrics for [query_16.sql]..
2018-08-14 22:03:00: Generating execution metrics for [query_17.sql]..
2018-08-14 22:03:00: Generating execution metrics for [query_18.sql]..
2018-08-14 22:03:01: Generating execution metrics for [query_19.sql]..
2018-08-14 22:03:02: Generating execution metrics for [query_20.sql]..
2018-08-14 22:03:02: Generating execution metrics for [query_21.sql]..
2018-08-14 22:03:02: Generating execution metrics for [query_22.sql]..
2018-08-14 22:03:04: Generating execution metrics for [query_23.sql]..
2018-08-14 22:03:08: Generating execution metrics for [query_24.sql]..
2018-08-14 22:03:15: Generating execution metrics for [query_25.sql]..
2018-08-14 22:03:20: Generating execution metrics for [query_26.sql]..
2018-08-14 22:03:21: Generating execution metrics for [query_27.sql]..
2018-08-14 22:03:21: Generating execution metrics for [query_28.sql]..
2018-08-14 22:03:21: Generating execution metrics for [query_29.sql]..
2018-08-14 22:03:21: Generating execution metrics for [query_30.sql]..
2018-08-14 22:03:22: Generating execution metrics for [query_31.sql]..
2018-08-14 22:03:24: Generating execution metrics for [query_32.sql]..
2018-08-14 22:03:24: Generating execution metrics for [query_33.sql]..
2018-08-14 22:03:24: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 22:03:24: Generating execution metrics for [query_34.sql]..
2018-08-14 22:03:25: Generating execution metrics for [query_35.sql]..
2018-08-14 22:03:25: Generating execution metrics for [query_36.sql]..
2018-08-14 22:03:25: Generating execution metrics for [query_37.sql]..
2018-08-14 22:03:26: Generating execution metrics for [query_38.sql]..
2018-08-14 22:04:10: Generating execution metrics for [query_39.sql]..
2018-08-14 22:04:11: Generating execution metrics for [query_40.sql]..
2018-08-14 22:04:11: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_current_price from item, inventory, date_dim, catalog_sales where i_current_price between 29 and 29 + 30 and inv_item_sk = i_item_sk and d_date_sk=inv_date_sk and d_date between cast('2002-03-29' as date) and (cast('2002-03-29' as date) + 60 days) and i_manufact_id in (705,742,777,944) and inv_quantity_on_hand between 100 and 500 and cs_item_sk = i_item_sk group by i_item_id,i_item_desc,i_current_price order by i_item_id ) where rownum <= 100 ]
2018-08-14 22:04:11: Generating execution metrics for [query_41.sql]..
2018-08-14 22:04:12: Generating execution metrics for [query_42.sql]..
2018-08-14 22:04:15: Generating execution metrics for [query_43.sql]..
2018-08-14 22:04:18: Generating execution metrics for [query_44.sql]..
2018-08-14 22:04:18: Skipped DML instruction due to following exception: [ORA-00907: missing right parenthesis] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select w_state ,i_item_id ,sum(case when (cast(d_date as date) < cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before ,sum(case when (cast(d_date as date) >= cast ('2001-05-02' as date)) then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after from catalog_sales left outer join catalog_returns on (cs_order_number = cr_order_number and cs_item_sk = cr_item_sk) ,warehouse ,item ,date_dim where i_current_price between 0.99 and 1.49 and i_item_sk = cs_item_sk and cs_warehouse_sk = w_warehouse_sk and cs_sold_date_sk = d_date_sk and d_date between (cast ('2001-05-02' as date) - 30 days) and (cast ('2001-05-02' as date) + 30 days) group by w_state,i_item_id order by w_state,i_item_id ) where rownum <= 100 ]
2018-08-14 22:04:19: Generating execution metrics for [query_45.sql]..
2018-08-14 22:04:19: Generating execution metrics for [query_46.sql]..
2018-08-14 22:04:19: Generating execution metrics for [query_47.sql]..
2018-08-14 22:04:20: Generating execution metrics for [query_48.sql]..
2018-08-14 22:04:21: Generating execution metrics for [query_49.sql]..
2018-08-14 22:04:21: Generating execution metrics for [query_50.sql]..
2018-08-14 22:04:22: Generating execution metrics for [query_51.sql]..
2018-08-14 22:04:25: Generating execution metrics for [query_52.sql]..
2018-08-14 22:22:42: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:22:42: Connection pool instantiated with [1] connections
2018-08-14 22:22:45: ('spark.cores.max', '20')
2018-08-14 22:22:45: ('spark.executor.memory', '2g')
2018-08-14 22:22:45: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 22:22:45: ('spark.app.id', 'app-20180814222245-0035')
2018-08-14 22:22:45: ('spark.executor.id', 'driver')
2018-08-14 22:22:45: ('spark.python.worker.reuse', 'True')
2018-08-14 22:22:45: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:22:45: ('spark.default.parallelism', '80')
2018-08-14 22:22:45: ('spark.driver.port', '36326')
2018-08-14 22:22:45: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:22:45: ('spark.executor.instances', '20')
2018-08-14 22:22:45: ('spark.logConf', 'False')
2018-08-14 22:22:45: ('spark.rdd.compress', 'True')
2018-08-14 22:22:45: ('spark.driver.memory', '2g')
2018-08-14 22:22:45: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:22:45: ('spark.executor.cores', '1')
2018-08-14 22:22:45: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:22:45: ('spark.submit.deployMode', 'client')
2018-08-14 22:22:45: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:22:45: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:22:45: ('spark.app.name', 'ICS5200')
2018-08-14 22:22:45: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 22:22:45: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 22:22:45: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 22:22:46: Successfully finished migrating DML scripts!
2018-08-14 22:22:46: Starting TPC-DS sql splitting
2018-08-14 22:22:46: Generated query_1.sql
2018-08-14 22:22:46: Generated query_2.sql
2018-08-14 22:22:46: Generated query_3.sql
2018-08-14 22:22:46: Generated query_4.sql
2018-08-14 22:22:46: Generated query_5.sql
2018-08-14 22:22:46: Generated query_6.sql
2018-08-14 22:22:46: Generated query_7.sql
2018-08-14 22:22:46: Generated query_8.sql
2018-08-14 22:22:46: Generated query_9.sql
2018-08-14 22:22:46: Generated query_10.sql
2018-08-14 22:22:46: Generated query_11.sql
2018-08-14 22:22:46: Generated query_12.sql
2018-08-14 22:22:46: Generated query_13.sql
2018-08-14 22:22:46: Generated query_14.sql
2018-08-14 22:22:46: Generated query_15.sql
2018-08-14 22:22:46: Generated query_16.sql
2018-08-14 22:22:46: Generated query_17.sql
2018-08-14 22:22:46: Generated query_18.sql
2018-08-14 22:22:46: Generated query_19.sql
2018-08-14 22:22:46: Generated query_20.sql
2018-08-14 22:22:46: Generated query_21.sql
2018-08-14 22:22:46: Generated query_22.sql
2018-08-14 22:22:46: Generated query_23.sql
2018-08-14 22:22:46: Generated query_24.sql
2018-08-14 22:22:46: Generated query_25.sql
2018-08-14 22:22:46: Generated query_26.sql
2018-08-14 22:22:46: Generated query_27.sql
2018-08-14 22:22:46: Generated query_28.sql
2018-08-14 22:22:46: Generated query_29.sql
2018-08-14 22:22:46: Generated query_30.sql
2018-08-14 22:22:46: Generated query_31.sql
2018-08-14 22:22:46: Generated query_32.sql
2018-08-14 22:22:46: Generated query_33.sql
2018-08-14 22:22:46: Generated query_34.sql
2018-08-14 22:22:46: Generated query_35.sql
2018-08-14 22:22:46: Generated query_36.sql
2018-08-14 22:22:46: Generated query_37.sql
2018-08-14 22:22:46: Generated query_38.sql
2018-08-14 22:22:46: Generated query_39.sql
2018-08-14 22:22:46: Generated query_40.sql
2018-08-14 22:22:46: Generated query_41.sql
2018-08-14 22:22:46: Generated query_42.sql
2018-08-14 22:22:46: Generated query_43.sql
2018-08-14 22:22:46: Generated query_44.sql
2018-08-14 22:22:46: Generated query_45.sql
2018-08-14 22:22:46: Generated query_46.sql
2018-08-14 22:22:46: Generated query_47.sql
2018-08-14 22:22:46: Generated query_48.sql
2018-08-14 22:22:46: Generated query_49.sql
2018-08-14 22:22:46: Generated query_50.sql
2018-08-14 22:22:46: Generated query_51.sql
2018-08-14 22:22:46: Generated query_52.sql
2018-08-14 22:22:46: Generated query_53.sql
2018-08-14 22:22:46: Generated query_54.sql
2018-08-14 22:22:46: Generated query_55.sql
2018-08-14 22:22:46: Generated query_56.sql
2018-08-14 22:22:46: Generated query_57.sql
2018-08-14 22:22:46: Generated query_58.sql
2018-08-14 22:22:46: Generated query_59.sql
2018-08-14 22:22:46: Generated query_60.sql
2018-08-14 22:22:46: Generated query_61.sql
2018-08-14 22:22:46: Generated query_62.sql
2018-08-14 22:22:46: Generated query_63.sql
2018-08-14 22:22:46: Generated query_64.sql
2018-08-14 22:22:46: Generated query_65.sql
2018-08-14 22:22:46: Generated query_66.sql
2018-08-14 22:22:46: Generated query_67.sql
2018-08-14 22:22:46: Generated query_68.sql
2018-08-14 22:22:46: Generated query_69.sql
2018-08-14 22:22:46: Generated query_70.sql
2018-08-14 22:22:46: Generated query_71.sql
2018-08-14 22:22:46: Generated query_72.sql
2018-08-14 22:22:46: Generated query_73.sql
2018-08-14 22:22:46: Generated query_74.sql
2018-08-14 22:22:46: Generated query_75.sql
2018-08-14 22:22:46: Generated query_76.sql
2018-08-14 22:22:46: Generated query_77.sql
2018-08-14 22:22:46: Generated query_78.sql
2018-08-14 22:22:46: Generated query_79.sql
2018-08-14 22:22:46: Generated query_80.sql
2018-08-14 22:22:46: Generated query_81.sql
2018-08-14 22:22:46: Generated query_82.sql
2018-08-14 22:22:46: Generated query_83.sql
2018-08-14 22:22:46: Generated query_84.sql
2018-08-14 22:22:46: Generated query_85.sql
2018-08-14 22:22:46: Generated query_86.sql
2018-08-14 22:22:46: Generated query_87.sql
2018-08-14 22:22:46: Generated query_88.sql
2018-08-14 22:22:46: Generated query_89.sql
2018-08-14 22:22:46: Generated query_90.sql
2018-08-14 22:22:46: Generated query_91.sql
2018-08-14 22:22:46: Generated query_92.sql
2018-08-14 22:22:46: Generated query_93.sql
2018-08-14 22:22:46: Generated query_94.sql
2018-08-14 22:22:46: Generated query_95.sql
2018-08-14 22:22:46: Generated query_96.sql
2018-08-14 22:22:46: Generated query_97.sql
2018-08-14 22:22:46: Generated query_98.sql
2018-08-14 22:22:46: Generated query_99.sql
2018-08-14 22:22:46: Script Complete!
-------------------------------------
2018-08-14 22:23:31: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:23:31: Connection pool instantiated with [1] connections
2018-08-14 22:23:34: ('spark.cores.max', '20')
2018-08-14 22:23:34: ('spark.executor.memory', '2g')
2018-08-14 22:23:34: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 22:23:34: ('spark.executor.id', 'driver')
2018-08-14 22:23:34: ('spark.python.worker.reuse', 'True')
2018-08-14 22:23:34: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:23:34: ('spark.default.parallelism', '80')
2018-08-14 22:23:34: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:23:34: ('spark.driver.port', '22897')
2018-08-14 22:23:34: ('spark.executor.instances', '20')
2018-08-14 22:23:34: ('spark.logConf', 'False')
2018-08-14 22:23:34: ('spark.rdd.compress', 'True')
2018-08-14 22:23:34: ('spark.driver.memory', '2g')
2018-08-14 22:23:34: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:23:34: ('spark.executor.cores', '1')
2018-08-14 22:23:34: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:23:34: ('spark.submit.deployMode', 'client')
2018-08-14 22:23:34: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:23:34: ('spark.app.id', 'app-20180814222333-0036')
2018-08-14 22:23:34: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:23:34: ('spark.app.name', 'ICS5200')
2018-08-14 22:23:34: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 22:23:34: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 22:23:34: Successfully finished migrating DML scripts!
2018-08-14 22:23:34: Starting TPC-DS sql splitting
2018-08-14 22:23:34: Generated query_1.sql
2018-08-14 22:23:34: Generated query_2.sql
2018-08-14 22:23:34: Generated query_3.sql
2018-08-14 22:23:34: Generated query_4.sql
2018-08-14 22:23:34: Generated query_5.sql
2018-08-14 22:23:34: Generated query_6.sql
2018-08-14 22:23:34: Generated query_7.sql
2018-08-14 22:23:34: Generated query_8.sql
2018-08-14 22:23:34: Generated query_9.sql
2018-08-14 22:23:34: Generated query_10.sql
2018-08-14 22:23:34: Generated query_11.sql
2018-08-14 22:23:34: Generated query_12.sql
2018-08-14 22:23:34: Generated query_13.sql
2018-08-14 22:23:34: Generated query_14.sql
2018-08-14 22:23:34: Generated query_15.sql
2018-08-14 22:23:34: Generated query_16.sql
2018-08-14 22:23:34: Generated query_17.sql
2018-08-14 22:23:34: Generated query_18.sql
2018-08-14 22:23:34: Generated query_19.sql
2018-08-14 22:23:34: Generated query_20.sql
2018-08-14 22:23:34: Generated query_21.sql
2018-08-14 22:23:34: Generated query_22.sql
2018-08-14 22:23:34: Generated query_23.sql
2018-08-14 22:23:34: Generated query_24.sql
2018-08-14 22:23:34: Generated query_25.sql
2018-08-14 22:23:34: Generated query_26.sql
2018-08-14 22:23:34: Generated query_27.sql
2018-08-14 22:23:34: Generated query_28.sql
2018-08-14 22:23:34: Generated query_29.sql
2018-08-14 22:23:34: Generated query_30.sql
2018-08-14 22:23:34: Generated query_31.sql
2018-08-14 22:23:34: Generated query_32.sql
2018-08-14 22:23:34: Generated query_33.sql
2018-08-14 22:23:34: Generated query_34.sql
2018-08-14 22:23:34: Generated query_35.sql
2018-08-14 22:23:34: Generated query_36.sql
2018-08-14 22:23:34: Generated query_37.sql
2018-08-14 22:23:34: Generated query_38.sql
2018-08-14 22:23:34: Generated query_39.sql
2018-08-14 22:23:34: Generated query_40.sql
2018-08-14 22:23:34: Generated query_41.sql
2018-08-14 22:23:34: Generated query_42.sql
2018-08-14 22:23:34: Generated query_43.sql
2018-08-14 22:23:34: Generated query_44.sql
2018-08-14 22:23:34: Generated query_45.sql
2018-08-14 22:23:34: Generated query_46.sql
2018-08-14 22:23:34: Generated query_47.sql
2018-08-14 22:23:34: Generated query_48.sql
2018-08-14 22:23:34: Generated query_49.sql
2018-08-14 22:23:34: Generated query_50.sql
2018-08-14 22:23:34: Generated query_51.sql
2018-08-14 22:23:34: Generated query_52.sql
2018-08-14 22:23:34: Generated query_53.sql
2018-08-14 22:23:34: Generated query_54.sql
2018-08-14 22:23:34: Generated query_55.sql
2018-08-14 22:23:34: Generated query_56.sql
2018-08-14 22:23:34: Generated query_57.sql
2018-08-14 22:23:34: Generated query_58.sql
2018-08-14 22:23:34: Generated query_59.sql
2018-08-14 22:23:34: Generated query_60.sql
2018-08-14 22:23:34: Generated query_61.sql
2018-08-14 22:23:34: Generated query_62.sql
2018-08-14 22:23:34: Generated query_63.sql
2018-08-14 22:23:34: Generated query_64.sql
2018-08-14 22:23:34: Generated query_65.sql
2018-08-14 22:23:34: Generated query_66.sql
2018-08-14 22:23:34: Generated query_67.sql
2018-08-14 22:23:34: Generated query_68.sql
2018-08-14 22:23:34: Generated query_69.sql
2018-08-14 22:23:34: Generated query_70.sql
2018-08-14 22:23:34: Generated query_71.sql
2018-08-14 22:23:34: Generated query_72.sql
2018-08-14 22:23:34: Generated query_73.sql
2018-08-14 22:23:34: Generated query_74.sql
2018-08-14 22:23:34: Generated query_75.sql
2018-08-14 22:23:34: Generated query_76.sql
2018-08-14 22:23:34: Generated query_77.sql
2018-08-14 22:23:34: Generated query_78.sql
2018-08-14 22:23:34: Generated query_79.sql
2018-08-14 22:23:34: Generated query_80.sql
2018-08-14 22:23:34: Generated query_81.sql
2018-08-14 22:23:34: Generated query_82.sql
2018-08-14 22:23:34: Generated query_83.sql
2018-08-14 22:23:34: Generated query_84.sql
2018-08-14 22:23:34: Generated query_85.sql
2018-08-14 22:23:34: Generated query_86.sql
2018-08-14 22:23:34: Generated query_87.sql
2018-08-14 22:23:34: Generated query_88.sql
2018-08-14 22:23:34: Generated query_89.sql
2018-08-14 22:23:34: Generated query_90.sql
2018-08-14 22:23:34: Generated query_91.sql
2018-08-14 22:23:34: Generated query_92.sql
2018-08-14 22:23:34: Generated query_93.sql
2018-08-14 22:23:34: Generated query_94.sql
2018-08-14 22:23:34: Generated query_95.sql
2018-08-14 22:23:34: Generated query_96.sql
2018-08-14 22:23:34: Generated query_97.sql
2018-08-14 22:23:34: Generated query_98.sql
2018-08-14 22:23:34: Generated query_99.sql
2018-08-14 22:23:34: Script Complete!
-------------------------------------
2018-08-14 22:29:51: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:29:51: Connection pool instantiated with [1] connections
2018-08-14 22:29:54: ('spark.cores.max', '20')
2018-08-14 22:29:54: ('spark.executor.memory', '2g')
2018-08-14 22:29:54: ('spark.driver.port', '35585')
2018-08-14 22:29:54: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 22:29:54: ('spark.app.id', 'app-20180814222953-0037')
2018-08-14 22:29:54: ('spark.executor.id', 'driver')
2018-08-14 22:29:54: ('spark.python.worker.reuse', 'True')
2018-08-14 22:29:54: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:29:54: ('spark.default.parallelism', '80')
2018-08-14 22:29:54: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:29:54: ('spark.executor.instances', '20')
2018-08-14 22:29:54: ('spark.logConf', 'False')
2018-08-14 22:29:54: ('spark.rdd.compress', 'True')
2018-08-14 22:29:54: ('spark.driver.memory', '2g')
2018-08-14 22:29:54: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:29:54: ('spark.executor.cores', '1')
2018-08-14 22:29:54: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:29:54: ('spark.submit.deployMode', 'client')
2018-08-14 22:29:54: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:29:54: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:29:54: ('spark.app.name', 'ICS5200')
2018-08-14 22:29:54: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 22:29:54: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 22:29:54: Successfully finished migrating DML scripts!
2018-08-14 22:29:54: Starting TPC-DS sql splitting
2018-08-14 22:29:54: Generated query_1.sql
2018-08-14 22:29:54: Generated query_2.sql
2018-08-14 22:29:54: Generated query_3.sql
2018-08-14 22:29:54: Generated query_4.sql
2018-08-14 22:29:54: Generated query_5.sql
2018-08-14 22:29:54: Generated query_6.sql
2018-08-14 22:29:54: Generated query_7.sql
2018-08-14 22:29:54: Generated query_8.sql
2018-08-14 22:29:54: Generated query_9.sql
2018-08-14 22:29:54: Generated query_10.sql
2018-08-14 22:29:54: Generated query_11.sql
2018-08-14 22:29:54: Generated query_12.sql
2018-08-14 22:29:54: Generated query_13.sql
2018-08-14 22:29:54: Generated query_14.sql
2018-08-14 22:29:54: Generated query_15.sql
2018-08-14 22:29:54: Generated query_16.sql
2018-08-14 22:29:54: Generated query_17.sql
2018-08-14 22:29:54: Generated query_18.sql
2018-08-14 22:29:54: Generated query_19.sql
2018-08-14 22:29:54: Generated query_20.sql
2018-08-14 22:29:54: Generated query_21.sql
2018-08-14 22:29:54: Generated query_22.sql
2018-08-14 22:29:54: Generated query_23.sql
2018-08-14 22:29:54: Generated query_24.sql
2018-08-14 22:29:54: Generated query_25.sql
2018-08-14 22:29:54: Generated query_26.sql
2018-08-14 22:29:54: Generated query_27.sql
2018-08-14 22:29:54: Generated query_28.sql
2018-08-14 22:29:54: Generated query_29.sql
2018-08-14 22:29:54: Generated query_30.sql
2018-08-14 22:29:54: Generated query_31.sql
2018-08-14 22:29:54: Generated query_32.sql
2018-08-14 22:29:54: Generated query_33.sql
2018-08-14 22:29:54: Generated query_34.sql
2018-08-14 22:29:54: Generated query_35.sql
2018-08-14 22:29:54: Generated query_36.sql
2018-08-14 22:29:54: Generated query_37.sql
2018-08-14 22:29:54: Generated query_38.sql
2018-08-14 22:29:54: Generated query_39.sql
2018-08-14 22:29:54: Generated query_40.sql
2018-08-14 22:29:54: Generated query_41.sql
2018-08-14 22:29:54: Generated query_42.sql
2018-08-14 22:29:54: Generated query_43.sql
2018-08-14 22:29:54: Generated query_44.sql
2018-08-14 22:29:54: Generated query_45.sql
2018-08-14 22:29:54: Generated query_46.sql
2018-08-14 22:29:54: Generated query_47.sql
2018-08-14 22:29:54: Generated query_48.sql
2018-08-14 22:29:54: Generated query_49.sql
2018-08-14 22:29:54: Generated query_50.sql
2018-08-14 22:29:54: Generated query_51.sql
2018-08-14 22:29:54: Generated query_52.sql
2018-08-14 22:29:54: Generated query_53.sql
2018-08-14 22:29:54: Generated query_54.sql
2018-08-14 22:29:54: Generated query_55.sql
2018-08-14 22:29:54: Generated query_56.sql
2018-08-14 22:29:54: Generated query_57.sql
2018-08-14 22:29:54: Generated query_58.sql
2018-08-14 22:29:54: Generated query_59.sql
2018-08-14 22:29:54: Generated query_60.sql
2018-08-14 22:29:54: Generated query_61.sql
2018-08-14 22:29:54: Generated query_62.sql
2018-08-14 22:29:54: Generated query_63.sql
2018-08-14 22:29:54: Generated query_64.sql
2018-08-14 22:29:54: Generated query_65.sql
2018-08-14 22:29:54: Generated query_66.sql
2018-08-14 22:29:54: Generated query_67.sql
2018-08-14 22:29:54: Generated query_68.sql
2018-08-14 22:29:54: Generated query_69.sql
2018-08-14 22:29:54: Generated query_70.sql
2018-08-14 22:29:54: Generated query_71.sql
2018-08-14 22:29:54: Generated query_72.sql
2018-08-14 22:29:54: Generated query_73.sql
2018-08-14 22:29:54: Generated query_74.sql
2018-08-14 22:29:54: Generated query_75.sql
2018-08-14 22:29:54: Generated query_76.sql
2018-08-14 22:29:54: Generated query_77.sql
2018-08-14 22:29:54: Generated query_78.sql
2018-08-14 22:29:54: Generated query_79.sql
2018-08-14 22:29:54: Generated query_80.sql
2018-08-14 22:29:54: Generated query_81.sql
2018-08-14 22:29:54: Generated query_82.sql
2018-08-14 22:29:54: Generated query_83.sql
2018-08-14 22:29:54: Generated query_84.sql
2018-08-14 22:29:54: Generated query_85.sql
2018-08-14 22:29:54: Generated query_86.sql
2018-08-14 22:29:54: Generated query_87.sql
2018-08-14 22:29:54: Generated query_88.sql
2018-08-14 22:29:54: Generated query_89.sql
2018-08-14 22:29:54: Generated query_90.sql
2018-08-14 22:29:54: Generated query_91.sql
2018-08-14 22:29:54: Generated query_92.sql
2018-08-14 22:29:54: Generated query_93.sql
2018-08-14 22:29:54: Generated query_94.sql
2018-08-14 22:29:54: Generated query_95.sql
2018-08-14 22:29:54: Generated query_96.sql
2018-08-14 22:29:54: Generated query_97.sql
2018-08-14 22:29:54: Generated query_98.sql
2018-08-14 22:29:54: Generated query_99.sql
2018-08-14 22:29:54: Script Complete!
-------------------------------------
2018-08-14 22:30:06: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:30:06: Connection pool instantiated with [1] connections
2018-08-14 22:30:09: ('spark.cores.max', '20')
2018-08-14 22:30:09: ('spark.executor.memory', '2g')
2018-08-14 22:30:09: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 22:30:09: ('spark.executor.id', 'driver')
2018-08-14 22:30:09: ('spark.python.worker.reuse', 'True')
2018-08-14 22:30:09: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:30:09: ('spark.default.parallelism', '80')
2018-08-14 22:30:09: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:30:09: ('spark.executor.instances', '20')
2018-08-14 22:30:09: ('spark.app.id', 'app-20180814223008-0038')
2018-08-14 22:30:09: ('spark.logConf', 'False')
2018-08-14 22:30:09: ('spark.rdd.compress', 'True')
2018-08-14 22:30:09: ('spark.driver.port', '22986')
2018-08-14 22:30:09: ('spark.driver.memory', '2g')
2018-08-14 22:30:09: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:30:09: ('spark.executor.cores', '1')
2018-08-14 22:30:09: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:30:09: ('spark.submit.deployMode', 'client')
2018-08-14 22:30:09: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:30:09: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:30:09: ('spark.app.name', 'ICS5200')
2018-08-14 22:30:09: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 22:30:09: Generating execution metrics for [query_1.sql]..
2018-08-14 22:30:10: Skipped DML instruction due to following exception: [ORA-24373: invalid length specified for statement] - Instruction: [ ]
2018-08-14 22:30:10: Generating execution metrics for [query_2.sql]..
2018-08-14 22:30:13: Skipped DML instruction due to following exception: [ORA-24373: invalid length specified for statement] - Instruction: [ ]
2018-08-14 22:30:13: Generating execution metrics for [query_3.sql]..
2018-08-14 22:30:14: Skipped DML instruction due to following exception: [ORA-24373: invalid length specified for statement] - Instruction: [ ]
2018-08-14 22:30:14: Generating execution metrics for [query_4.sql]..
2018-08-14 22:32:09: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:32:09: Connection pool instantiated with [1] connections
2018-08-14 22:32:12: ('spark.cores.max', '20')
2018-08-14 22:32:12: ('spark.executor.memory', '2g')
2018-08-14 22:32:12: ('spark.driver.port', '10856')
2018-08-14 22:32:12: ('spark.executor.id', 'driver')
2018-08-14 22:32:12: ('spark.python.worker.reuse', 'True')
2018-08-14 22:32:12: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:32:12: ('spark.default.parallelism', '80')
2018-08-14 22:32:12: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:32:12: ('spark.executor.instances', '20')
2018-08-14 22:32:12: ('spark.logConf', 'False')
2018-08-14 22:32:12: ('spark.rdd.compress', 'True')
2018-08-14 22:32:12: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 22:32:12: ('spark.app.id', 'app-20180814223211-0039')
2018-08-14 22:32:12: ('spark.driver.memory', '2g')
2018-08-14 22:32:12: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:32:12: ('spark.executor.cores', '1')
2018-08-14 22:32:12: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:32:12: ('spark.submit.deployMode', 'client')
2018-08-14 22:32:12: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:32:12: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:32:12: ('spark.app.name', 'ICS5200')
2018-08-14 22:32:12: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 22:32:12: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 22:32:12: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 22:32:13: Successfully finished migrating DML scripts!
2018-08-14 22:32:13: Starting TPC-DS sql splitting
2018-08-14 22:32:13: Generated query_1.sql
2018-08-14 22:32:13: Generated query_2.sql
2018-08-14 22:32:13: Generated query_3.sql
2018-08-14 22:32:13: Generated query_4.sql
2018-08-14 22:32:13: Generated query_5.sql
2018-08-14 22:32:13: Generated query_6.sql
2018-08-14 22:32:13: Generated query_7.sql
2018-08-14 22:32:13: Generated query_8.sql
2018-08-14 22:32:13: Generated query_9.sql
2018-08-14 22:32:13: Generated query_10.sql
2018-08-14 22:32:13: Generated query_11.sql
2018-08-14 22:32:13: Generated query_12.sql
2018-08-14 22:32:13: Generated query_13.sql
2018-08-14 22:32:13: Generated query_14.sql
2018-08-14 22:32:13: Generated query_15.sql
2018-08-14 22:32:13: Generated query_16.sql
2018-08-14 22:32:13: Generated query_17.sql
2018-08-14 22:32:13: Generated query_18.sql
2018-08-14 22:32:13: Generated query_19.sql
2018-08-14 22:32:13: Generated query_20.sql
2018-08-14 22:32:13: Generated query_21.sql
2018-08-14 22:32:13: Generated query_22.sql
2018-08-14 22:32:13: Generated query_23.sql
2018-08-14 22:32:13: Generated query_24.sql
2018-08-14 22:32:13: Generated query_25.sql
2018-08-14 22:32:13: Generated query_26.sql
2018-08-14 22:32:13: Generated query_27.sql
2018-08-14 22:32:13: Generated query_28.sql
2018-08-14 22:32:13: Generated query_29.sql
2018-08-14 22:32:13: Generated query_30.sql
2018-08-14 22:32:13: Generated query_31.sql
2018-08-14 22:32:13: Generated query_32.sql
2018-08-14 22:32:13: Generated query_33.sql
2018-08-14 22:32:13: Generated query_34.sql
2018-08-14 22:32:13: Generated query_35.sql
2018-08-14 22:32:13: Generated query_36.sql
2018-08-14 22:32:13: Generated query_37.sql
2018-08-14 22:32:13: Generated query_38.sql
2018-08-14 22:32:13: Generated query_39.sql
2018-08-14 22:32:13: Generated query_40.sql
2018-08-14 22:32:13: Generated query_41.sql
2018-08-14 22:32:13: Generated query_42.sql
2018-08-14 22:32:13: Generated query_43.sql
2018-08-14 22:32:13: Generated query_44.sql
2018-08-14 22:32:13: Generated query_45.sql
2018-08-14 22:32:13: Generated query_46.sql
2018-08-14 22:32:13: Generated query_47.sql
2018-08-14 22:32:13: Generated query_48.sql
2018-08-14 22:32:13: Generated query_49.sql
2018-08-14 22:32:13: Generated query_50.sql
2018-08-14 22:32:13: Generated query_51.sql
2018-08-14 22:32:13: Generated query_52.sql
2018-08-14 22:32:13: Generated query_53.sql
2018-08-14 22:32:13: Generated query_54.sql
2018-08-14 22:32:13: Generated query_55.sql
2018-08-14 22:32:13: Generated query_56.sql
2018-08-14 22:32:13: Generated query_57.sql
2018-08-14 22:32:13: Generated query_58.sql
2018-08-14 22:32:13: Generated query_59.sql
2018-08-14 22:32:13: Generated query_60.sql
2018-08-14 22:32:13: Generated query_61.sql
2018-08-14 22:32:13: Generated query_62.sql
2018-08-14 22:32:13: Generated query_63.sql
2018-08-14 22:32:13: Generated query_64.sql
2018-08-14 22:32:13: Generated query_65.sql
2018-08-14 22:32:13: Generated query_66.sql
2018-08-14 22:32:13: Generated query_67.sql
2018-08-14 22:32:13: Generated query_68.sql
2018-08-14 22:32:13: Generated query_69.sql
2018-08-14 22:32:13: Generated query_70.sql
2018-08-14 22:32:13: Generated query_71.sql
2018-08-14 22:32:13: Generated query_72.sql
2018-08-14 22:32:13: Generated query_73.sql
2018-08-14 22:32:13: Generated query_74.sql
2018-08-14 22:32:13: Generated query_75.sql
2018-08-14 22:32:13: Generated query_76.sql
2018-08-14 22:32:13: Generated query_77.sql
2018-08-14 22:32:13: Generated query_78.sql
2018-08-14 22:32:13: Generated query_79.sql
2018-08-14 22:32:13: Generated query_80.sql
2018-08-14 22:32:13: Generated query_81.sql
2018-08-14 22:32:13: Generated query_82.sql
2018-08-14 22:32:13: Generated query_83.sql
2018-08-14 22:32:13: Generated query_84.sql
2018-08-14 22:32:13: Generated query_85.sql
2018-08-14 22:32:13: Generated query_86.sql
2018-08-14 22:32:13: Generated query_87.sql
2018-08-14 22:32:13: Generated query_88.sql
2018-08-14 22:32:13: Generated query_89.sql
2018-08-14 22:32:13: Generated query_90.sql
2018-08-14 22:32:13: Generated query_91.sql
2018-08-14 22:32:13: Generated query_92.sql
2018-08-14 22:32:13: Generated query_93.sql
2018-08-14 22:32:13: Generated query_94.sql
2018-08-14 22:32:13: Generated query_95.sql
2018-08-14 22:32:13: Generated query_96.sql
2018-08-14 22:32:13: Generated query_97.sql
2018-08-14 22:32:13: Generated query_98.sql
2018-08-14 22:32:13: Generated query_99.sql
2018-08-14 22:32:13: Script Complete!
-------------------------------------
2018-08-14 22:32:16: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:32:16: Connection pool instantiated with [1] connections
2018-08-14 22:32:18: ('spark.cores.max', '20')
2018-08-14 22:32:18: ('spark.executor.memory', '2g')
2018-08-14 22:32:18: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 22:32:18: ('spark.executor.id', 'driver')
2018-08-14 22:32:18: ('spark.python.worker.reuse', 'True')
2018-08-14 22:32:18: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:32:18: ('spark.default.parallelism', '80')
2018-08-14 22:32:18: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:32:18: ('spark.executor.instances', '20')
2018-08-14 22:32:18: ('spark.app.id', 'app-20180814223218-0040')
2018-08-14 22:32:18: ('spark.driver.port', '10736')
2018-08-14 22:32:18: ('spark.logConf', 'False')
2018-08-14 22:32:18: ('spark.rdd.compress', 'True')
2018-08-14 22:32:18: ('spark.driver.memory', '2g')
2018-08-14 22:32:18: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:32:18: ('spark.executor.cores', '1')
2018-08-14 22:32:18: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:32:18: ('spark.submit.deployMode', 'client')
2018-08-14 22:32:18: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:32:18: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:32:18: ('spark.app.name', 'ICS5200')
2018-08-14 22:32:18: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 22:32:18: Generating execution metrics for [query_1.sql]..
2018-08-14 22:32:18: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select sr_customer_sk as ctr_customer_sk ,sr_store_sk as ctr_store_sk ,sum(SR_FEE) as ctr_total_return from store_returns ,date_dim where sr_returned_date_sk = d_date_sk and d_year =2000 group by sr_customer_sk ,sr_store_sk) select * from ( select c_customer_id from customer_total_return ctr1 ,store ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_store_sk = ctr2.ctr_store_sk) and s_store_sk = ctr1.ctr_store_sk and s_state = 'TN' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id ) where rownum <= 100; ]
2018-08-14 22:32:19: Generating execution metrics for [query_2.sql]..
2018-08-14 22:32:19: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ wscs as (select sold_date_sk ,sales_price from (select ws_sold_date_sk sold_date_sk ,ws_ext_sales_price sales_price from web_sales union all select cs_sold_date_sk sold_date_sk ,cs_ext_sales_price sales_price from catalog_sales)), wswscs as (select d_week_seq, sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales, sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales, sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales, sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales, sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales, sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales, sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales from wscs ,date_dim where d_date_sk = sold_date_sk group by d_week_seq) select d_week_seq1 ,round(sun_sales1/sun_sales2,2) ,round(mon_sales1/mon_sales2,2) ,round(tue_sales1/tue_sales2,2) ,round(wed_sales1/wed_sales2,2) ,round(thu_sales1/thu_sales2,2) ,round(fri_sales1/fri_sales2,2) ,round(sat_sales1/sat_sales2,2) from (select wswscs.d_week_seq d_week_seq1 ,sun_sales sun_sales1 ,mon_sales mon_sales1 ,tue_sales tue_sales1 ,wed_sales wed_sales1 ,thu_sales thu_sales1 ,fri_sales fri_sales1 ,sat_sales sat_sales1 from wswscs,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998) y, (select wswscs.d_week_seq d_week_seq2 ,sun_sales sun_sales2 ,mon_sales mon_sales2 ,tue_sales tue_sales2 ,wed_sales wed_sales2 ,thu_sales thu_sales2 ,fri_sales fri_sales2 ,sat_sales sat_sales2 from wswscs ,date_dim where date_dim.d_week_seq = wswscs.d_week_seq and d_year = 1998+1) z where d_week_seq1=d_week_seq2-53 order by d_week_seq1; ]
2018-08-14 22:32:19: Generating execution metrics for [query_3.sql]..
2018-08-14 22:32:19: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select dt.d_year ,item.i_brand_id brand_id ,item.i_brand brand ,sum(ss_sales_price) sum_agg from date_dim dt ,store_sales ,item where dt.d_date_sk = store_sales.ss_sold_date_sk and store_sales.ss_item_sk = item.i_item_sk and item.i_manufact_id = 816 and dt.d_moy=11 group by dt.d_year ,item.i_brand ,item.i_brand_id order by dt.d_year ,sum_agg desc ,brand_id ) where rownum <= 100; ]
2018-08-14 22:32:19: Generating execution metrics for [query_4.sql]..
2018-08-14 22:32:19: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total ,'c' sale_type from customer ,catalog_sales ,date_dim where c_customer_sk = cs_bill_customer_sk and cs_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select * from ( select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_c_firstyear ,year_total t_c_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_c_secyear.customer_id and t_s_firstyear.customer_id = t_c_firstyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.sale_type = 's' and t_c_firstyear.sale_type = 'c' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_c_secyear.sale_type = 'c' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 1999 and t_s_secyear.dyear = 1999+1 and t_c_firstyear.dyear = 1999 and t_c_secyear.dyear = 1999+1 and t_w_firstyear.dyear = 1999 and t_w_secyear.dyear = 1999+1 and t_s_firstyear.year_total > 0 and t_c_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_birth_country ) where rownum <= 100; ]
2018-08-14 22:32:19: Generating execution metrics for [query_5.sql]..
2018-08-14 22:32:19: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssr as (select s_store_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ss_store_sk as store_sk, ss_sold_date_sk as date_sk, ss_ext_sales_price as sales_price, ss_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from store_sales union all select sr_store_sk as store_sk, sr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, sr_return_amt as return_amt, sr_net_loss as net_loss from store_returns ) salesreturns, date_dim, store where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14,'yyyy-mm-dd')) and store_sk = s_store_sk group by s_store_id) , csr as (select cp_catalog_page_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select cs_catalog_page_sk as page_sk, cs_sold_date_sk as date_sk, cs_ext_sales_price as sales_price, cs_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from catalog_sales union all select cr_catalog_page_sk as page_sk, cr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, cr_return_amount as return_amt, cr_net_loss as net_loss from catalog_returns ) salesreturns, date_dim, catalog_page where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14,'yyyy-mm-dd')) and page_sk = cp_catalog_page_sk group by cp_catalog_page_id) , wsr as (select web_site_id, sum(sales_price) as sales, sum(profit) as profit, sum(return_amt) as returns, sum(net_loss) as profit_loss from ( select ws_web_site_sk as wsr_web_site_sk, ws_sold_date_sk as date_sk, ws_ext_sales_price as sales_price, ws_net_profit as profit, cast(0 as decimal(7,2)) as return_amt, cast(0 as decimal(7,2)) as net_loss from web_sales union all select ws_web_site_sk as wsr_web_site_sk, wr_returned_date_sk as date_sk, cast(0 as decimal(7,2)) as sales_price, cast(0 as decimal(7,2)) as profit, wr_return_amt as return_amt, wr_net_loss as net_loss from web_returns left outer join web_sales on ( wr_item_sk = ws_item_sk and wr_order_number = ws_order_number) ) salesreturns, date_dim, web_site where date_sk = d_date_sk and d_date between to_char(to_date('2000-08-19','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2000-08-19','yyyy/mm/dd') + 14,'yyyy-mm-dd')) and wsr_web_site_sk = web_site_sk group by web_site_id) select * from ( select channel , id , sum(sales) as sales , sum(returns) as returns , sum(profit) as profit from (select 'store channel' as channel , 'store' || s_store_id as id , sales , returns , (profit - profit_loss) as profit from ssr union all select 'catalog channel' as channel , 'catalog_page' || cp_catalog_page_id as id , sales , returns , (profit - profit_loss) as profit from csr union all select 'web channel' as channel , 'web_site' || web_site_id as id , sales , returns , (profit - profit_loss) as profit from wsr ) x group by rollup (channel, id) order by channel ,id ) where rownum <= 100; ]
2018-08-14 22:32:20: Generating execution metrics for [query_6.sql]..
2018-08-14 22:32:20: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select a.ca_state state, count(*) cnt from customer_address a ,customer c ,store_sales s ,date_dim d ,item i where a.ca_address_sk = c.c_current_addr_sk and c.c_customer_sk = s.ss_customer_sk and s.ss_sold_date_sk = d.d_date_sk and s.ss_item_sk = i.i_item_sk and d.d_month_seq = (select distinct (d_month_seq) from date_dim where d_year = 2002 and d_moy = 3 ) and i.i_current_price > 1.2 * (select avg(j.i_current_price) from item j where j.i_category = i.i_category) group by a.ca_state having count(*) >= 10 order by cnt, a.ca_state ) where rownum <= 100; ]
2018-08-14 22:32:20: Generating execution metrics for [query_7.sql]..
2018-08-14 22:32:20: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id, avg(ss_quantity) agg1, avg(ss_list_price) agg2, avg(ss_coupon_amt) agg3, avg(ss_sales_price) agg4 from store_sales, customer_demographics, date_dim, item, promotion where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and ss_cdemo_sk = cd_demo_sk and ss_promo_sk = p_promo_sk and cd_gender = 'F' and cd_marital_status = 'W' and cd_education_status = 'College' and (p_channel_email = 'N' or p_channel_event = 'N') and d_year = 2001 group by i_item_id order by i_item_id ) where rownum <= 100; ]
2018-08-14 22:32:20: Generating execution metrics for [query_8.sql]..
2018-08-14 22:32:20: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select s_store_name ,sum(ss_net_profit) from store_sales ,date_dim ,store, (select ca_zip from ( SELECT substr(ca_zip,1,5) ca_zip FROM customer_address WHERE substr(ca_zip,1,5) IN ( '47602','16704','35863','28577','83910','36201', '58412','48162','28055','41419','80332', '38607','77817','24891','16226','18410', '21231','59345','13918','51089','20317', '17167','54585','67881','78366','47770', '18360','51717','73108','14440','21800', '89338','45859','65501','34948','25973', '73219','25333','17291','10374','18829', '60736','82620','41351','52094','19326', '25214','54207','40936','21814','79077', '25178','75742','77454','30621','89193', '27369','41232','48567','83041','71948', '37119','68341','14073','16891','62878', '49130','19833','24286','27700','40979', '50412','81504','94835','84844','71954', '39503','57649','18434','24987','12350', '86379','27413','44529','98569','16515', '27287','24255','21094','16005','56436', '91110','68293','56455','54558','10298', '83647','32754','27052','51766','19444', '13869','45645','94791','57631','20712', '37788','41807','46507','21727','71836', '81070','50632','88086','63991','20244', '31655','51782','29818','63792','68605', '94898','36430','57025','20601','82080', '33869','22728','35834','29086','92645', '98584','98072','11652','78093','57553', '43830','71144','53565','18700','90209', '71256','38353','54364','28571','96560', '57839','56355','50679','45266','84680', '34306','34972','48530','30106','15371', '92380','84247','92292','68852','13338', '34594','82602','70073','98069','85066', '47289','11686','98862','26217','47529', '63294','51793','35926','24227','14196', '24594','32489','99060','49472','43432', '49211','14312','88137','47369','56877', '20534','81755','15794','12318','21060', '73134','41255','63073','81003','73873', '66057','51184','51195','45676','92696', '70450','90669','98338','25264','38919', '59226','58581','60298','17895','19489', '52301','80846','95464','68770','51634', '19988','18367','18421','11618','67975', '25494','41352','95430','15734','62585', '97173','33773','10425','75675','53535', '17879','41967','12197','67998','79658', '59130','72592','14851','43933','68101', '50636','25717','71286','24660','58058', '72991','95042','15543','33122','69280', '11912','59386','27642','65177','17672', '33467','64592','36335','54010','18767', '63193','42361','49254','33113','33159', '36479','59080','11855','81963','31016', '49140','29392','41836','32958','53163', '13844','73146','23952','65148','93498', '14530','46131','58454','13376','13378', '83986','12320','17193','59852','46081', '98533','52389','13086','68843','31013', '13261','60560','13443','45533','83583', '11489','58218','19753','22911','25115', '86709','27156','32669','13123','51933', '39214','41331','66943','14155','69998', '49101','70070','35076','14242','73021', '59494','15782','29752','37914','74686', '83086','34473','15751','81084','49230', '91894','60624','17819','28810','63180', '56224','39459','55233','75752','43639', '55349','86057','62361','50788','31830', '58062','18218','85761','60083','45484', '21204','90229','70041','41162','35390', '16364','39500','68908','26689','52868', '81335','40146','11340','61527','61794', '71997','30415','59004','29450','58117', '69952','33562','83833','27385','61860', '96435','48333','23065','32961','84919', '61997','99132','22815','56600','68730', '48017','95694','32919','88217','27116', '28239','58032','18884','16791','21343', '97462','18569','75660','15475') intersect select ca_zip from (SELECT substr(ca_zip,1,5) ca_zip,count(*) cnt FROM customer_address, customer WHERE ca_address_sk = c_current_addr_sk and c_preferred_cust_flag='Y' group by ca_zip having count(*) > 10)A1)A2) V1 where ss_store_sk = s_store_sk and ss_sold_date_sk = d_date_sk and d_qoy = 2 and d_year = 1998 and (substr(s_zip,1,2) = substr(V1.ca_zip,1,2)) group by s_store_name order by s_store_name ) where rownum <= 100; ]
2018-08-14 22:32:20: Generating execution metrics for [query_9.sql]..
2018-08-14 22:32:20: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ case when (select count(*) from store_sales where ss_quantity between 1 and 20) > 1071 then (select avg(ss_ext_tax) from store_sales where ss_quantity between 1 and 20) else (select avg(ss_net_paid_inc_tax) from store_sales where ss_quantity between 1 and 20) end bucket1 , case when (select count(*) from store_sales where ss_quantity between 21 and 40) > 39161 then (select avg(ss_ext_tax) from store_sales where ss_quantity between 21 and 40) else (select avg(ss_net_paid_inc_tax) from store_sales where ss_quantity between 21 and 40) end bucket2, case when (select count(*) from store_sales where ss_quantity between 41 and 60) > 29434 then (select avg(ss_ext_tax) from store_sales where ss_quantity between 41 and 60) else (select avg(ss_net_paid_inc_tax) from store_sales where ss_quantity between 41 and 60) end bucket3, case when (select count(*) from store_sales where ss_quantity between 61 and 80) > 6568 then (select avg(ss_ext_tax) from store_sales where ss_quantity between 61 and 80) else (select avg(ss_net_paid_inc_tax) from store_sales where ss_quantity between 61 and 80) end bucket4, case when (select count(*) from store_sales where ss_quantity between 81 and 100) > 21216 then (select avg(ss_ext_tax) from store_sales where ss_quantity between 81 and 100) else (select avg(ss_net_paid_inc_tax) from store_sales where ss_quantity between 81 and 100) end bucket5 from reason where r_reason_sk = 1 ; ]
2018-08-14 22:32:20: Generating execution metrics for [query_10.sql]..
2018-08-14 22:32:20: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select cd_gender, cd_marital_status, cd_education_status, count(*) cnt1, cd_purchase_estimate, count(*) cnt2, cd_credit_rating, count(*) cnt3, cd_dep_count, count(*) cnt4, cd_dep_employed_count, count(*) cnt5, cd_dep_college_count, count(*) cnt6 from customer c,customer_address ca,customer_demographics where c.c_current_addr_sk = ca.ca_address_sk and ca_county in ('Fairfield County','Campbell County','Washtenaw County','Escambia County','Cleburne County') and cd_demo_sk = c.c_current_cdemo_sk and exists (select * from store_sales,date_dim where c.c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and d_moy between 3 and 3+3) and (exists (select * from web_sales,date_dim where c.c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk and d_year = 2001 and d_moy between 3 ANd 3+3) or exists (select * from catalog_sales,date_dim where c.c_customer_sk = cs_ship_customer_sk and cs_sold_date_sk = d_date_sk and d_year = 2001 and d_moy between 3 and 3+3)) group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count order by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count ) where rownum <= 100; ]
2018-08-14 22:32:21: Generating execution metrics for [query_11.sql]..
2018-08-14 22:32:21: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ year_total as ( select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total ,'s' sale_type from customer ,store_sales ,date_dim where c_customer_sk = ss_customer_sk and ss_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year union all select c_customer_id customer_id ,c_first_name customer_first_name ,c_last_name customer_last_name ,c_preferred_cust_flag customer_preferred_cust_flag ,c_birth_country customer_birth_country ,c_login customer_login ,c_email_address customer_email_address ,d_year dyear ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total ,'w' sale_type from customer ,web_sales ,date_dim where c_customer_sk = ws_bill_customer_sk and ws_sold_date_sk = d_date_sk group by c_customer_id ,c_first_name ,c_last_name ,c_preferred_cust_flag ,c_birth_country ,c_login ,c_email_address ,d_year ) select * from ( select t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_email_address from year_total t_s_firstyear ,year_total t_s_secyear ,year_total t_w_firstyear ,year_total t_w_secyear where t_s_secyear.customer_id = t_s_firstyear.customer_id and t_s_firstyear.customer_id = t_w_secyear.customer_id and t_s_firstyear.customer_id = t_w_firstyear.customer_id and t_s_firstyear.sale_type = 's' and t_w_firstyear.sale_type = 'w' and t_s_secyear.sale_type = 's' and t_w_secyear.sale_type = 'w' and t_s_firstyear.dyear = 1998 and t_s_secyear.dyear = 1998+1 and t_w_firstyear.dyear = 1998 and t_w_secyear.dyear = 1998+1 and t_s_firstyear.year_total > 0 and t_w_firstyear.year_total > 0 and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end order by t_s_secyear.customer_id ,t_s_secyear.customer_first_name ,t_s_secyear.customer_last_name ,t_s_secyear.customer_email_address ) where rownum <= 100; ]
2018-08-14 22:32:21: Generating execution metrics for [query_12.sql]..
2018-08-14 22:32:21: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ * from (select i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price ,sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio from web_sales ,item ,date_dim where ws_item_sk = i_item_sk and i_category in ('Men', 'Books', 'Electronics') and ws_sold_date_sk = d_date_sk and d_date between to_char(to_date('2001-06-15','yyyy/mm/dd'),'yyyy-mm-dd') and (to_char(to_date('2001-06-15','yyyy/mm/dd') + 30,'yyyy-mm-dd')) group by i_item_id ,i_item_desc ,i_category ,i_class ,i_current_price order by i_category ,i_class ,i_item_id ,i_item_desc ,revenueratio ) where rownum <= 100; ]
2018-08-14 22:32:21: Generating execution metrics for [query_13.sql]..
2018-08-14 22:32:21: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ select /*ICS5200_MONITOR_HINT*/ avg(ss_quantity) ,avg(ss_ext_sales_price) ,avg(ss_ext_wholesale_cost) ,sum(ss_ext_wholesale_cost) from store_sales ,store ,customer_demographics ,household_demographics ,customer_address ,date_dim where s_store_sk = ss_store_sk and ss_sold_date_sk = d_date_sk and d_year = 2001 and((ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'M' and cd_education_status = 'College' and ss_sales_price between 100.00 and 150.00 and hd_dep_count = 3 )or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'D' and cd_education_status = 'Primary' and ss_sales_price between 50.00 and 100.00 and hd_dep_count = 1 ) or (ss_hdemo_sk=hd_demo_sk and cd_demo_sk = ss_cdemo_sk and cd_marital_status = 'W' and cd_education_status = '2 yr Degree' and ss_sales_price between 150.00 and 200.00 and hd_dep_count = 1 )) and((ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('IL', 'TN', 'TX') and ss_net_profit between 100 and 200 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('WY', 'OH', 'ID') and ss_net_profit between 150 and 300 ) or (ss_addr_sk = ca_address_sk and ca_country = 'United States' and ca_state in ('MS', 'SC', 'IA') and ss_net_profit between 50 and 250 )) ; ]
2018-08-14 22:32:22: Generating execution metrics for [query_14.sql]..
2018-08-14 22:32:22: Skipped DML instruction due to following exception: [ORA-00911: invalid character] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales) from( select 'store' channel, i_brand_id,i_class_id ,i_category_id,sum(ss_quantity*ss_list_price) sales , count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales) union all select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales from catalog_sales ,item ,date_dim where cs_item_sk in (select ss_item_sk from cross_items) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales) union all select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales from web_sales ,item ,date_dim where ws_item_sk in (select ss_item_sk from cross_items) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales) ) y group by rollup (channel, i_brand_id,i_class_id,i_category_id) order by channel,i_brand_id,i_class_id,i_category_id ) where rownum <= 100; with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select this_year.* from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100; ]
2018-08-14 22:46:01: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:46:01: Connection pool instantiated with [1] connections
2018-08-14 22:46:04: ('spark.cores.max', '20')
2018-08-14 22:46:04: ('spark.executor.memory', '2g')
2018-08-14 22:46:04: ('spark.executor.id', 'driver')
2018-08-14 22:46:04: ('spark.python.worker.reuse', 'True')
2018-08-14 22:46:04: ('spark.driver.port', '9961')
2018-08-14 22:46:04: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:46:04: ('spark.default.parallelism', '80')
2018-08-14 22:46:04: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:46:04: ('spark.executor.instances', '20')
2018-08-14 22:46:04: ('spark.app.id', 'app-20180814224603-0041')
2018-08-14 22:46:04: ('spark.logConf', 'False')
2018-08-14 22:46:04: ('spark.rdd.compress', 'True')
2018-08-14 22:46:04: ('spark.driver.host', 'tempvcenter.rs2.com')
2018-08-14 22:46:04: ('spark.driver.memory', '2g')
2018-08-14 22:46:04: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:46:04: ('spark.executor.cores', '1')
2018-08-14 22:46:04: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:46:04: ('spark.submit.deployMode', 'client')
2018-08-14 22:46:04: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:46:04: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:46:04: ('spark.app.name', 'ICS5200')
2018-08-14 22:46:04: TPC-DS SQLs generated for dataset of [1] Gigabytes
2018-08-14 22:46:04: Successfully migrated catv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated ccv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated custv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_c.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_c_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_ca.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_ca_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_ca_v.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_cc.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_cc_s.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_cc_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_cp.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_cp_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_i.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_i_s.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_i_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_p.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_p_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_s.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_s_s.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_s_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_w.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_w_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_wp.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_wp_s.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_wp_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_ws.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_ws_s.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated dm_ws_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated itemv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated iv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_cr.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_cr_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_cs.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_cs_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_sr.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_sr_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_ss.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_ss_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_wr.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_wr_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_ws.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated lf_ws_t.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated promv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated storv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated websv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated webv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully migrated wrhsv_up.sql under src/ tree..
2018-08-14 22:46:04: Successfully finished migrating DML scripts!
2018-08-14 22:46:04: Starting TPC-DS sql splitting
2018-08-14 22:46:04: Generated query_1.sql
2018-08-14 22:46:04: Generated query_2.sql
2018-08-14 22:46:04: Generated query_3.sql
2018-08-14 22:46:04: Generated query_4.sql
2018-08-14 22:46:04: Generated query_5.sql
2018-08-14 22:46:04: Generated query_6.sql
2018-08-14 22:46:04: Generated query_7.sql
2018-08-14 22:46:04: Generated query_8.sql
2018-08-14 22:46:04: Generated query_9.sql
2018-08-14 22:46:04: Generated query_10.sql
2018-08-14 22:46:04: Generated query_11.sql
2018-08-14 22:46:04: Generated query_12.sql
2018-08-14 22:46:04: Generated query_13.sql
2018-08-14 22:46:04: Generated query_14.sql
2018-08-14 22:46:04: Generated query_15.sql
2018-08-14 22:46:04: Generated query_16.sql
2018-08-14 22:46:04: Generated query_17.sql
2018-08-14 22:46:04: Generated query_18.sql
2018-08-14 22:46:04: Generated query_19.sql
2018-08-14 22:46:04: Generated query_20.sql
2018-08-14 22:46:04: Generated query_21.sql
2018-08-14 22:46:04: Generated query_22.sql
2018-08-14 22:46:04: Generated query_23.sql
2018-08-14 22:46:04: Generated query_24.sql
2018-08-14 22:46:04: Generated query_25.sql
2018-08-14 22:46:04: Generated query_26.sql
2018-08-14 22:46:04: Generated query_27.sql
2018-08-14 22:46:04: Generated query_28.sql
2018-08-14 22:46:04: Generated query_29.sql
2018-08-14 22:46:04: Generated query_30.sql
2018-08-14 22:46:04: Generated query_31.sql
2018-08-14 22:46:04: Generated query_32.sql
2018-08-14 22:46:04: Generated query_33.sql
2018-08-14 22:46:04: Generated query_34.sql
2018-08-14 22:46:04: Generated query_35.sql
2018-08-14 22:46:04: Generated query_36.sql
2018-08-14 22:46:04: Generated query_37.sql
2018-08-14 22:46:04: Generated query_38.sql
2018-08-14 22:46:04: Generated query_39.sql
2018-08-14 22:46:04: Generated query_40.sql
2018-08-14 22:46:04: Generated query_41.sql
2018-08-14 22:46:04: Generated query_42.sql
2018-08-14 22:46:04: Generated query_43.sql
2018-08-14 22:46:04: Generated query_44.sql
2018-08-14 22:46:04: Generated query_45.sql
2018-08-14 22:46:04: Generated query_46.sql
2018-08-14 22:46:04: Generated query_47.sql
2018-08-14 22:46:04: Generated query_48.sql
2018-08-14 22:46:04: Generated query_49.sql
2018-08-14 22:46:04: Generated query_50.sql
2018-08-14 22:46:04: Generated query_51.sql
2018-08-14 22:46:04: Generated query_52.sql
2018-08-14 22:46:04: Generated query_53.sql
2018-08-14 22:46:04: Generated query_54.sql
2018-08-14 22:46:04: Generated query_55.sql
2018-08-14 22:46:04: Generated query_56.sql
2018-08-14 22:46:04: Generated query_57.sql
2018-08-14 22:46:04: Generated query_58.sql
2018-08-14 22:46:04: Generated query_59.sql
2018-08-14 22:46:04: Generated query_60.sql
2018-08-14 22:46:04: Generated query_61.sql
2018-08-14 22:46:04: Generated query_62.sql
2018-08-14 22:46:04: Generated query_63.sql
2018-08-14 22:46:04: Generated query_64.sql
2018-08-14 22:46:04: Generated query_65.sql
2018-08-14 22:46:04: Generated query_66.sql
2018-08-14 22:46:04: Generated query_67.sql
2018-08-14 22:46:04: Generated query_68.sql
2018-08-14 22:46:04: Generated query_69.sql
2018-08-14 22:46:04: Generated query_70.sql
2018-08-14 22:46:04: Generated query_71.sql
2018-08-14 22:46:04: Generated query_72.sql
2018-08-14 22:46:04: Generated query_73.sql
2018-08-14 22:46:04: Generated query_74.sql
2018-08-14 22:46:04: Generated query_75.sql
2018-08-14 22:46:04: Generated query_76.sql
2018-08-14 22:46:04: Generated query_77.sql
2018-08-14 22:46:04: Generated query_78.sql
2018-08-14 22:46:04: Generated query_79.sql
2018-08-14 22:46:04: Generated query_80.sql
2018-08-14 22:46:04: Generated query_81.sql
2018-08-14 22:46:04: Generated query_82.sql
2018-08-14 22:46:04: Generated query_83.sql
2018-08-14 22:46:04: Generated query_84.sql
2018-08-14 22:46:04: Generated query_85.sql
2018-08-14 22:46:04: Generated query_86.sql
2018-08-14 22:46:04: Generated query_87.sql
2018-08-14 22:46:04: Generated query_88.sql
2018-08-14 22:46:04: Generated query_89.sql
2018-08-14 22:46:04: Generated query_90.sql
2018-08-14 22:46:04: Generated query_91.sql
2018-08-14 22:46:04: Generated query_92.sql
2018-08-14 22:46:04: Generated query_93.sql
2018-08-14 22:46:04: Generated query_94.sql
2018-08-14 22:46:04: Generated query_95.sql
2018-08-14 22:46:04: Generated query_96.sql
2018-08-14 22:46:04: Generated query_97.sql
2018-08-14 22:46:04: Generated query_98.sql
2018-08-14 22:46:04: Generated query_99.sql
2018-08-14 22:46:04: Script Complete!
-------------------------------------
2018-08-14 22:46:15: Connected to database [gabsam] with user [tpcds1]
2018-08-14 22:46:15: Connection pool instantiated with [1] connections
2018-08-14 22:46:17: ('spark.cores.max', '20')
2018-08-14 22:46:17: ('spark.executor.memory', '2g')
2018-08-14 22:46:17: ('spark.driver.host', 'cisk.rs2.com')
2018-08-14 22:46:17: ('spark.app.id', 'app-20180814224617-0042')
2018-08-14 22:46:17: ('spark.executor.id', 'driver')
2018-08-14 22:46:17: ('spark.python.worker.reuse', 'True')
2018-08-14 22:46:17: ('spark.driver.maxResultSize', '1g')
2018-08-14 22:46:17: ('spark.default.parallelism', '80')
2018-08-14 22:46:17: ('spark.sql.shuffle.partitions', '80')
2018-08-14 22:46:17: ('spark.executor.instances', '20')
2018-08-14 22:46:17: ('spark.driver.port', '13707')
2018-08-14 22:46:17: ('spark.logConf', 'False')
2018-08-14 22:46:17: ('spark.rdd.compress', 'True')
2018-08-14 22:46:17: ('spark.driver.memory', '2g')
2018-08-14 22:46:17: ('spark.serializer.objectStreamReset', '100')
2018-08-14 22:46:17: ('spark.executor.cores', '1')
2018-08-14 22:46:17: ('spark.master', 'spark://cisk.rs2.com:7077')
2018-08-14 22:46:17: ('spark.submit.deployMode', 'client')
2018-08-14 22:46:17: ('spark.executorEnv.PYTHONPATH', '$PYTHONPATH:/home/gabriels/ICS5200')
2018-08-14 22:46:17: ('spark.ui.showConsoleProgress', 'true')
2018-08-14 22:46:17: ('spark.app.name', 'ICS5200')
2018-08-14 22:46:17: Table [REP_EXECUTION_PLANS] already exists..
2018-08-14 22:46:17: Generating execution metrics for [query_1.sql]..
2018-08-14 22:46:18: Generating execution metrics for [query_2.sql]..
2018-08-14 22:46:22: Generating execution metrics for [query_3.sql]..
2018-08-14 22:46:22: Generating execution metrics for [query_4.sql]..
2018-08-14 22:46:27: Generating execution metrics for [query_5.sql]..
2018-08-14 22:46:31: Generating execution metrics for [query_6.sql]..
2018-08-14 22:46:31: Generating execution metrics for [query_7.sql]..
2018-08-14 22:46:31: Generating execution metrics for [query_8.sql]..
2018-08-14 22:46:31: Generating execution metrics for [query_9.sql]..
2018-08-14 22:46:34: Generating execution metrics for [query_10.sql]..
2018-08-14 22:46:34: Generating execution metrics for [query_11.sql]..
2018-08-14 22:46:37: Generating execution metrics for [query_12.sql]..
2018-08-14 22:46:37: Generating execution metrics for [query_13.sql]..
2018-08-14 22:46:40: Generating execution metrics for [query_14.sql]..
2018-08-14 22:46:40: Skipped DML instruction due to following exception: [ORA-00933: SQL command not properly ended] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select channel, i_brand_id,i_class_id,i_category_id,sum(sales), sum(number_sales) from( select 'store' channel, i_brand_id,i_class_id ,i_category_id,sum(ss_quantity*ss_list_price) sales , count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales) union all select 'catalog' channel, i_brand_id,i_class_id,i_category_id, sum(cs_quantity*cs_list_price) sales, count(*) number_sales from catalog_sales ,item ,date_dim where cs_item_sk in (select ss_item_sk from cross_items) and cs_item_sk = i_item_sk and cs_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(cs_quantity*cs_list_price) > (select average_sales from avg_sales) union all select 'web' channel, i_brand_id,i_class_id,i_category_id, sum(ws_quantity*ws_list_price) sales , count(*) number_sales from web_sales ,item ,date_dim where ws_item_sk in (select ss_item_sk from cross_items) and ws_item_sk = i_item_sk and ws_sold_date_sk = d_date_sk and d_year = 1999+2 and d_moy = 11 group by i_brand_id,i_class_id,i_category_id having sum(ws_quantity*ws_list_price) > (select average_sales from avg_sales) ) y group by rollup (channel, i_brand_id,i_class_id,i_category_id) order by channel,i_brand_id,i_class_id,i_category_id ) where rownum <= 100 with cross_items as (select i_item_sk ss_item_sk from item, (select iss.i_brand_id brand_id ,iss.i_class_id class_id ,iss.i_category_id category_id from store_sales ,item iss ,date_dim d1 where ss_item_sk = iss.i_item_sk and ss_sold_date_sk = d1.d_date_sk and d1.d_year between 1999 AND 1999 + 2 intersect select ics.i_brand_id ,ics.i_class_id ,ics.i_category_id from catalog_sales ,item ics ,date_dim d2 where cs_item_sk = ics.i_item_sk and cs_sold_date_sk = d2.d_date_sk and d2.d_year between 1999 AND 1999 + 2 intersect select iws.i_brand_id ,iws.i_class_id ,iws.i_category_id from web_sales ,item iws ,date_dim d3 where ws_item_sk = iws.i_item_sk and ws_sold_date_sk = d3.d_date_sk and d3.d_year between 1999 AND 1999 + 2) x where i_brand_id = brand_id and i_class_id = class_id and i_category_id = category_id ), avg_sales as (select avg(quantity*list_price) average_sales from (select ss_quantity quantity ,ss_list_price list_price from store_sales ,date_dim where ss_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select cs_quantity quantity ,cs_list_price list_price from catalog_sales ,date_dim where cs_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2 union all select ws_quantity quantity ,ws_list_price list_price from web_sales ,date_dim where ws_sold_date_sk = d_date_sk and d_year between 1999 and 1999 + 2) x) select * from ( select this_year.* from (select 'store' channel, i_brand_id,i_class_id,i_category_id ,sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 + 1 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) this_year, (select 'store' channel, i_brand_id,i_class_id ,i_category_id, sum(ss_quantity*ss_list_price) sales, count(*) number_sales from store_sales ,item ,date_dim where ss_item_sk in (select ss_item_sk from cross_items) and ss_item_sk = i_item_sk and ss_sold_date_sk = d_date_sk and d_week_seq = (select d_week_seq from date_dim where d_year = 1999 and d_moy = 12 and d_dom = 3) group by i_brand_id,i_class_id,i_category_id having sum(ss_quantity*ss_list_price) > (select average_sales from avg_sales)) last_year where this_year.i_brand_id= last_year.i_brand_id and this_year.i_class_id = last_year.i_class_id and this_year.i_category_id = last_year.i_category_id order by this_year.channel, this_year.i_brand_id, this_year.i_class_id, this_year.i_category_id ) where rownum <= 100 ]
2018-08-14 22:46:40: Generating execution metrics for [query_15.sql]..
2018-08-14 22:46:40: Generating execution metrics for [query_16.sql]..
2018-08-14 22:46:41: Generating execution metrics for [query_17.sql]..
2018-08-14 22:46:41: Generating execution metrics for [query_18.sql]..
2018-08-14 22:46:42: Generating execution metrics for [query_19.sql]..
2018-08-14 22:46:42: Generating execution metrics for [query_20.sql]..
2018-08-14 22:46:42: Generating execution metrics for [query_21.sql]..
2018-08-14 22:46:42: Generating execution metrics for [query_22.sql]..
2018-08-14 22:46:47: Generating execution metrics for [query_23.sql]..
2018-08-14 22:46:47: Skipped DML instruction due to following exception: [ORA-00933: SQL command not properly ended] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (2000,2000+1,2000+2,2000+3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2000,2000+1,2000+2,2000+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select * from ( select sum(sales) from (select cs_quantity*cs_list_price sales from catalog_sales ,date_dim where d_year = 2000 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) union all select ws_quantity*ws_list_price sales from web_sales ,date_dim where d_year = 2000 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer)) ) where rownum <= 100 with frequent_ss_items as (select substr(i_item_desc,1,30) itemdesc,i_item_sk item_sk,d_date solddate,count(*) cnt from store_sales ,date_dim ,item where ss_sold_date_sk = d_date_sk and ss_item_sk = i_item_sk and d_year in (2000,2000 + 1,2000 + 2,2000 + 3) group by substr(i_item_desc,1,30),i_item_sk,d_date having count(*) >4), max_store_sales as (select max(csales) tpcds_cmax from (select c_customer_sk,sum(ss_quantity*ss_sales_price) csales from store_sales ,customer ,date_dim where ss_customer_sk = c_customer_sk and ss_sold_date_sk = d_date_sk and d_year in (2000,2000+1,2000+2,2000+3) group by c_customer_sk)), best_ss_customer as (select c_customer_sk,sum(ss_quantity*ss_sales_price) ssales from store_sales ,customer where ss_customer_sk = c_customer_sk group by c_customer_sk having sum(ss_quantity*ss_sales_price) > (95/100.0) * (select * from max_store_sales)) select * from ( select c_last_name,c_first_name,sales from (select c_last_name,c_first_name,sum(cs_quantity*cs_list_price) sales from catalog_sales ,customer ,date_dim where d_year = 2000 and d_moy = 7 and cs_sold_date_sk = d_date_sk and cs_item_sk in (select item_sk from frequent_ss_items) and cs_bill_customer_sk in (select c_customer_sk from best_ss_customer) and cs_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name union all select c_last_name,c_first_name,sum(ws_quantity*ws_list_price) sales from web_sales ,customer ,date_dim where d_year = 2000 and d_moy = 7 and ws_sold_date_sk = d_date_sk and ws_item_sk in (select item_sk from frequent_ss_items) and ws_bill_customer_sk in (select c_customer_sk from best_ss_customer) and ws_bill_customer_sk = c_customer_sk group by c_last_name,c_first_name) order by c_last_name,c_first_name,sales ) where rownum <= 100 ]
2018-08-14 22:46:48: Generating execution metrics for [query_24.sql]..
2018-08-14 22:46:48: Skipped DML instruction due to following exception: [ORA-00933: SQL command not properly ended] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_net_paid) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id=5 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'aquamarine' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name with ssales as (select c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size ,sum(ss_net_paid) netpaid from store_sales ,store_returns ,store ,item ,customer ,customer_address where ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk and ss_customer_sk = c_customer_sk and ss_item_sk = i_item_sk and ss_store_sk = s_store_sk and c_current_addr_sk = ca_address_sk and c_birth_country <> upper(ca_country) and s_zip = ca_zip and s_market_id = 5 group by c_last_name ,c_first_name ,s_store_name ,ca_state ,s_state ,i_color ,i_current_price ,i_manager_id ,i_units ,i_size) select c_last_name ,c_first_name ,s_store_name ,sum(netpaid) paid from ssales where i_color = 'seashell' group by c_last_name ,c_first_name ,s_store_name having sum(netpaid) > (select 0.05*avg(netpaid) from ssales) order by c_last_name ,c_first_name ,s_store_name ]
2018-08-14 22:46:48: Generating execution metrics for [query_25.sql]..
2018-08-14 22:46:48: Generating execution metrics for [query_26.sql]..
2018-08-14 22:46:48: Generating execution metrics for [query_27.sql]..
2018-08-14 22:46:49: Generating execution metrics for [query_28.sql]..
2018-08-14 22:46:51: Generating execution metrics for [query_29.sql]..
2018-08-14 22:46:51: Generating execution metrics for [query_30.sql]..
2018-08-14 22:46:51: Skipped DML instruction due to following exception: [ORA-00904: "C_LAST_REVIEW_DATE_SK": invalid identifier] - Instruction: [ with /*ICS5200_MONITOR_HINT*/ customer_total_return as (select wr_returning_customer_sk as ctr_customer_sk ,ca_state as ctr_state, sum(wr_return_amt) as ctr_total_return from web_returns ,date_dim ,customer_address where wr_returned_date_sk = d_date_sk and d_year =2000 and wr_returning_addr_sk = ca_address_sk group by wr_returning_customer_sk ,ca_state) select * from ( select c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return from customer_total_return ctr1 ,customer_address ,customer where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return ctr2 where ctr1.ctr_state = ctr2.ctr_state) and ca_address_sk = c_current_addr_sk and ca_state = 'AR' and ctr1.ctr_customer_sk = c_customer_sk order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address ,c_last_review_date_sk,ctr_total_return ) where rownum <= 100 ]
2018-08-14 22:46:51: Generating execution metrics for [query_31.sql]..
2018-08-14 22:46:52: Generating execution metrics for [query_32.sql]..
2018-08-14 22:46:52: Generating execution metrics for [query_33.sql]..
2018-08-14 22:46:53: Generating execution metrics for [query_34.sql]..
2018-08-14 22:46:53: Generating execution metrics for [query_35.sql]..
